<!DOCTYPE html>
<!-- saved from url=(0067)https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">
	<meta name="author" content="">
	<meta name="keywords" content="Bitcoin,P2SH LOCKTIME,P2SH CheckLockTimeVerify,P2SH CheckSequenceVerify,PHP">
	<title>Bitcoin P2SH.LOCKTIME</title>

	<!-- Bootstrap core CSS -->
	<link href="./Bitcoin P2SH.LOCKTIME_files/bootstrap.min.css" rel="stylesheet">
	<link href="./Bitcoin P2SH.LOCKTIME_files/enlighterjs.min.css" rel="stylesheet">
	<!-- Custom styles for this template -->
	<link href="./Bitcoin P2SH.LOCKTIME_files/simple-sidebar.css" rel="stylesheet">
	<!-- Bootstrap core JavaScript -->
	<script src="./Bitcoin P2SH.LOCKTIME_files/f(7).txt"></script><script src="./Bitcoin P2SH.LOCKTIME_files/jquery.min.js.下载"></script>
	<script src="./Bitcoin P2SH.LOCKTIME_files/iframeResizer.min.js.下载"></script>
	<script async="" src="./Bitcoin P2SH.LOCKTIME_files/f(8).txt" crossorigin="anonymous" data-checked-head="true"></script>
<meta http-equiv="origin-trial" content="AlK2UR5SkAlj8jjdEc9p3F3xuFYlF6LYjAML3EOqw1g26eCwWPjdmecULvBH5MVPoqKYrOfPhYVL71xAXI1IBQoAAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="Amm8/NmvvQfhwCib6I7ZsmUxiSCfOxWxHayJwyU1r3gRIItzr7bNQid6O8ZYaE1GSQTa69WwhPC9flq/oYkRBwsAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A9wSqI5i0iwGdf6L1CERNdmsTPgVu44ewj8QxTBYgsv1LCPUVF7YmWOvTappqB1139jAymxUW/RO8zmMqo4zlAAAAACNeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MzY4MTI4MDAsImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A+d7vJfYtay4OUbdtRPZA3y7bKQLsxaMEPmxgfhBGqKXNrdkCQeJlUwqa6EBbSfjwFtJWTrWIioXeMW+y8bWAgQAAACTeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MzY4MTI4MDAsImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"></head>
<body>

  <div class="d-flex" id="wrapper" style="height: auto !important;">

    <!-- Sidebar -->
    <div class="bg-light " id="sidebar-wrapper" style="height: auto !important; min-height: 0px !important;">
		<div class="sidebar-heading"><a style="color:white;text-decoration:none;" href="https://www.btcschools.net/">btcschools.net</a></div>
	  
		<div class="list-group-header">Bitcoin Intro</div>
		<div class="list-group list-group-flush">
			<a href="https://www.btcschools.net/bitcoin/bitcoin_start_install.php" class="list-group-item list-group-item-action bg-light">Bitwasp Install</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_start_blockchain.php" class="list-group-item list-group-item-action bg-light">Bitcoin Blockchain</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_start_key.php" class="list-group-item list-group-item-action bg-light">Private/Public Key</a>
		</div>
		
		<div class="list-group-header">Bitcoin Client</div>
		<div class="list-group list-group-flush">
			<a href="https://www.btcschools.net/bitcoin/bitcoin_client_electrum.php" class="list-group-item list-group-item-action bg-light">Electrum</a>
		</div>
		
		<div class="list-group-header">Bitcoin Script Types</div>
		<div class="list-group list-group-flush">
			<a href="https://www.btcschools.net/bitcoin/bitcoin_script_p2pkh.php" class="list-group-item list-group-item-action bg-light">Bitcoin P2PKH</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh.php" class="list-group-item list-group-item-action bg-light">Bitcoin P2SH</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_script_multisig.php" class="list-group-item list-group-item-action bg-light">Bitcoin MULTISIG</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_script_nulldata.php" class="list-group-item list-group-item-action bg-light">Bitcoin NULL DATA</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_script_p2wpkh.php" class="list-group-item list-group-item-action bg-light">Bitcoin P2WPKH</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_script_p2wsh.php" class="list-group-item list-group-item-action bg-light">Bitcoin P2WSH</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_p2wpkh.php" class="list-group-item list-group-item-action bg-light">Bitcoin P2SH.P2WPKH</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_p2wsh.php" class="list-group-item list-group-item-action bg-light">Bitcoin P2SH.P2WSH</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php" class="list-group-item list-group-item-action bg-light">Bitcoin P2SH.LOCKTIME</a>
		</div>
		
		<div class="list-group-header">Bitcoin HD Wallet</div>
		<div class="list-group list-group-flush">
			<a href="https://www.btcschools.net/bitcoin/bitcoin_hd_mnemonic_code.php" class="list-group-item list-group-item-action bg-light">Bitcoin Mnemonic Code</a>
		</div>
		<div class="list-group list-group-flush">
			<a href="https://www.btcschools.net/bitcoin/bitcoin_hd_derivation_path.php" class="list-group-item list-group-item-action bg-light">Bitcoin Derivation Paths</a>
		</div>
		
		<div class="list-group-header">Bitcoin Tools</div>
		<div class="list-group list-group-flush">
			<a href="https://www.btcschools.net/bitcoin/bitcoin_tool_hash160.php" class="list-group-item list-group-item-action bg-light">Bitcoin HASH160</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_tool_sha256d.php" class="list-group-item list-group-item-action bg-light">Bitcoin SHA256D</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_tool_sha256.php" class="list-group-item list-group-item-action bg-light">Bitcoin SHA256</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_tool_ripemd160.php" class="list-group-item list-group-item-action bg-light">Bitcoin RIPEMD160</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_tool_base58.php" class="list-group-item list-group-item-action bg-light">Bitcoin BASE58</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_tool_wif.php" class="list-group-item list-group-item-action bg-light">Bitcoin WIF</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_tool_verify_script.php" class="list-group-item list-group-item-action bg-light">Bitcoin Verify Script</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_tool_little_endian.php" class="list-group-item list-group-item-action bg-light">Bitcoin Little-Endian</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_tool_ecdsa.php" class="list-group-item list-group-item-action bg-light">Bitcoin ECDSA Signature</a>
			
			<a href="https://www.btcschools.net/bitcoin/bitcoin_tool_ecrecover.php" class="list-group-item list-group-item-action bg-light">Bitcoin EC Recover</a>
			
		</div><div class="google-auto-placed" style="width: 100%; height: auto; clear: both; text-align: center;"><ins data-ad-format="auto" class="adsbygoogle adsbygoogle-noablate" data-ad-client="ca-pub-3154209077906660" data-adsbygoogle-status="done" style="display: block; margin: 10px auto; background-color: transparent; height: 240px;" data-ad-status="filled"><div id="aswift_2_host" style="border: none; height: 240px; width: 240px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block; overflow: visible;"><iframe id="aswift_2" name="aswift_2" browsingtopics="true" style="left:0;position:absolute;top:0;border:0;width:240px;height:240px;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="240" height="240" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allow="attribution-reporting; run-ad-auction" src="./Bitcoin P2SH.LOCKTIME_files/ads.html" data-google-container-id="a!3" tabindex="0" title="Advertisement" aria-label="Advertisement" data-google-query-id="CLrWsN-pzIsDFfSfrAIdTlsyTg" data-load-complete="true"></iframe></div></ins></div>
	  
		<div class="list-group-header">Bitcoin Others</div>
		<div class="list-group list-group-flush">
			<a href="https://www.btcschools.net/bitcoin/bitcoin_cancel_tx.php" class="list-group-item list-group-item-action bg-light">Bitcoin Cancel Tx (RBF)</a>
		</div>
		
		
		<div class="list-group-header">Bitcoin Advance</div>
		<div class="list-group list-group-flush">
			<a href="https://www.btcschools.net/bitcoin/bitcoin_merkle_root.php" class="list-group-item list-group-item-action bg-light">Merkle Root</a>
		</div>
		
		<div class="list-group-header">Bitcoin Tools</div>
		<div class="list-group list-group-flush">
			<a href="https://www.btcschools.net/bitcoin/bitcoin_tool_utxo.php" class="list-group-item list-group-item-action bg-light">Bitcoin Get UTXO</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_tool_txhex.php" class="list-group-item list-group-item-action bg-light">Bitcoin Get Tx Hex</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_tool_mtp.php" class="list-group-item list-group-item-action bg-light">Bitcoin Median Time Past</a>
			<a href="https://www.btcschools.net/bitcoin/bitcoin_tool_unit_converter.php" class="list-group-item list-group-item-action bg-light">Bitcoin Unit Converter</a>
		</div>
    </div>
    <!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper" style="height: auto !important;">
		
      <nav class="navbar navbar-expand-lg navbar-light border-bottom" style="background-color:#5F5F5F;">
        <button class="btn btn-success" id="menu-toggle">Bitcoin Menu</button>

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ml-auto mt-2 mt-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="https://www.btcschools.net/bitcoin">Bitcoin</a>
            </li>
          </ul>
        </div>
      </nav>

      <div class="container-fluid" style="height: auto !important;">
			<h2 class="mt-3">Bitcoin P2SH.LOCKTIME</h2>
<hr>
	<p>
	A script level locktime mechanism aims to restrict spending of bitcoin until condition reach future time or block height. Today, it is commonly applied in Hash Time-Locked Contracts (HTLC).
	</p>
	
	<p>
	CLTV and CSV are script level timelocks, unlike nLocktime and nSequence which are transaction and input level timelocks. CLTV or CSV are specified in the output locking script, and when spending those outputs, the user must set the nLocktime or the nSequence value to satisfy the locking condition.
	</p>
<hr>

P2SH.CheckLockTimeVerify (CLTV)
<ul>
	<li>Absolute Locktime.</li>
	<li>Described in <a href="https://github.com/bitcoin/bips/blob/master/bip-0065.mediawiki" target="_blank">BIP 65</a>.</li>	
</ul>

<div class="vertical-line-green">
	<h6 class="mt-3">Script Pair of CLTV</h6>
	<table>
		
		<tbody><tr>
			<td>ScriptPubKey</td><td>: &lt;expiry time&gt; OP_CHECKLOCKTIMEVERIFY OP_DROP OP_DUP OP_HASH160 &lt;pubKeyHash&gt; OP_EQUALVERIFY OP_CHECKSIG</td>
		</tr>
		<tr>
			<td>ScriptSig</td><td>: &lt;Signature&gt; &lt;PublicKey&gt;</td>
		</tr>
		
	</tbody></table>
</div><div class="google-auto-placed" style="width: 100%; height: auto; clear: both; text-align: center;"><ins data-ad-format="auto" class="adsbygoogle adsbygoogle-noablate" data-ad-client="ca-pub-3154209077906660" data-adsbygoogle-status="done" style="display: block; margin: 16px auto 10px; background-color: transparent; height: 280px;" data-ad-status="filled"><div id="aswift_1_host" style="border: none; height: 280px; width: 1200px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block; overflow: visible;"><iframe id="aswift_1" name="aswift_1" browsingtopics="true" style="left: 0px; position: absolute; top: 0px; border: 0px; width: 1200px; height: 280px; overflow: hidden;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="1200" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allow="attribution-reporting; run-ad-auction" src="./Bitcoin P2SH.LOCKTIME_files/ads(1).html" data-google-container-id="a!2" tabindex="0" title="Advertisement" aria-label="Advertisement" data-google-query-id="CIPA8N6pzIsDFTWqrAIdqdUtpA" data-load-complete="true"></iframe></div></ins></div>
P2SH.CheckSequenceVerify (CSV)
<ul>
	<li>Relative Locktime.</li>
</ul>

<div class="vertical-line-green">
	<h6 class="mt-3">Script Pair of CSV</h6>
	<table>
		
		<tbody><tr>
			<td>ScriptPubKey</td><td>: &lt;expiry time&gt; OP_CHECKSEQUENCEVERIFY OP_DROP OP_DUP OP_HASH160 &lt;pubKeyHash&gt; OP_EQUALVERIFY OP_CHECKSIG</td>
		</tr>
		<tr>
			<td>ScriptSig</td><td>: &lt;Signature&gt; &lt;PublicKey&gt;</td>
		</tr>
		
	</tbody></table>
</div>


<hr>
<h3 class="mt-3" id="hashtag3">P2SH.LOCKTIME Address</h3>
<ul class="nav nav-tabs">
	
	<li class="nav-item dropdown">
		<a class="nav-link dropdown-toggle active" data-toggle="dropdown" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#" role="button" aria-haspopup="true" aria-expanded="false">CLTV</a>
		<div class="dropdown-menu">
			<a data-toggle="tab" class="dropdown-item" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#form1_tabitem1">Visual</a>
			<a data-toggle="tab" class="dropdown-item" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#form1_tabitem2">Coding</a>
		</div>
	</li>
	
	<li class="nav-item dropdown">
		<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#" role="button" aria-haspopup="true" aria-expanded="false">CSV</a>
		<div class="dropdown-menu">
			<a data-toggle="tab" class="dropdown-item" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#form1_tabitem3">Visual</a>
			<a data-toggle="tab" class="dropdown-item" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#form1_tabitem4">Coding</a>
		</div>
	</li>
	
</ul>
<div class="google-auto-placed" style="width: 100%; height: auto; clear: both; text-align: center;"><ins data-ad-format="auto" class="adsbygoogle adsbygoogle-noablate" data-ad-client="ca-pub-3154209077906660" data-adsbygoogle-status="done" style="display: block; margin: 10px auto; background-color: transparent; height: 90px;" data-ad-status="filled"><div id="aswift_3_host" style="border: none; height: 90px; width: 1200px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block; overflow: visible;"><iframe id="aswift_3" name="aswift_3" browsingtopics="true" style="left:0;position:absolute;top:0;border:0;width:1200px;height:90px;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="1200" height="90" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allow="attribution-reporting; run-ad-auction" src="./Bitcoin P2SH.LOCKTIME_files/ads(2).html" data-google-container-id="a!4" tabindex="0" title="Advertisement" aria-label="Advertisement" data-google-query-id="CNTqsN-pzIsDFVSwrAIdAyQfhg" data-load-complete="true"></iframe></div></ins></div><div class="tab-content">
	<div id="form1_tabitem1" class="tab-pane fade show active">
		<iframe src="./Bitcoin P2SH.LOCKTIME_files/bitcoin_script_p2sh_cltv_address.html" width="100%" scrolling="no" frameborder="no" id="iFrameResizer0" style="overflow: hidden; height: 652px;"></iframe>
	</div>
	<div id="form1_tabitem2" class="tab-pane fade">
		<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"></div><div class="enlighter-btn enlighter-btn-copy"></div><div class="enlighter-btn enlighter-btn-window"></div><div class="enlighter-btn enlighter-btn-website"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Bitcoin;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Address\ScriptHashAddress;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\ScriptFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\Opcodes;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Key\Factory\PublicKeyFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Network\NetworkFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Buffertools\Buffer;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Locktime;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-text"> </span><span class="enlighter-s0">"../libraries/vendor/autoload.php"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$placeholder</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'locktypevalue'</span><span class="enlighter-g1">][</span><span class="enlighter-s0">'default'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> = </span><span class="enlighter-s0">'Please choose either Datetime or block height.'</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$placeholder</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'locktypevalue'</span><span class="enlighter-g1">][</span><span class="enlighter-s0">'timestamp'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> = </span><span class="enlighter-s0">'Accept only format YYYY-MM-DD HH:MM:SS.'</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$placeholder</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'locktypevalue'</span><span class="enlighter-g1">][</span><span class="enlighter-s0">'blockheight'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> = </span><span class="enlighter-s0">'Block height must be integer.'</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"html_iframe_header.php"</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_SERVER</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'REQUEST_METHOD'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> == </span><span class="enlighter-s0">'POST'</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k1">try</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$lockTimeObject</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Locktime</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$networkClass</span><span class="enlighter-text">   = </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'network'</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        Bitcoin::</span><span class="enlighter-m0">setNetwork</span><span class="enlighter-g1">(</span><span class="enlighter-text">NetworkFactory::</span><span class="enlighter-k7">$networkClass</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$publicKeyFactory</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">PublicKeyFactory</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'lock_type'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> == </span><span class="enlighter-s0">'timestamp'</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$lockTypeValue</span><span class="enlighter-text"> = </span><span class="enlighter-m0">strtotime</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'lock_type_value'</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-k1">if</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'lock_type'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> == </span><span class="enlighter-s0">'blockheight'</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$lockTypeValue</span><span class="enlighter-text"> = </span><span class="enlighter-g1">(</span><span class="enlighter-k5">int</span><span class="enlighter-g1">)</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'lock_type_value'</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">'Please choose either Datetime or block height.'</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$lockTimeInt</span><span class="enlighter-text"> = </span><span class="enlighter-g1">(</span><span class="enlighter-text">Buffer::</span><span class="enlighter-k5">int</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$lockTypeValue</span><span class="enlighter-g1">))</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$locktimev</span><span class="enlighter-text">   = </span><span class="enlighter-k7">$lockTimeInt</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">flip</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$publicKey</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$publicKeyFactory</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">fromHex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'public_key'</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text"> = ScriptFactory::</span><span class="enlighter-m0">sequence</span><span class="enlighter-g1">([</span><span class="enlighter-text">Buffer::</span><span class="enlighter-m0">hex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$locktimev</span><span class="enlighter-g1">)</span><span class="enlighter-text">, Opcodes::</span><span class="enlighter-m2">OP_CHECKLOCKTIMEVERIFY</span><span class="enlighter-text">,Opcodes::</span><span class="enlighter-m2">OP_DROP</span><span class="enlighter-text">, Opcodes::</span><span class="enlighter-m2">OP_DUP</span><span class="enlighter-text">, Opcodes::</span><span class="enlighter-m2">OP_HASH160</span><span class="enlighter-text">, </span><span class="enlighter-k7">$publicKey</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getPubKeyHash</span><span class="enlighter-g1">()</span><span class="enlighter-text">, Opcodes::</span><span class="enlighter-m2">OP_EQUALVERIFY</span><span class="enlighter-text">, Opcodes::</span><span class="enlighter-m2">OP_CHECKSIG</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$p2sh</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">ScriptHashAddress</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScriptHash</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"table-responsive"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">table border=0 </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">'table'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">tr style=</span><span class="enlighter-s0">'background-color:#f0f0f0'</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Base58 address</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$p2sh</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getAddress</span><span class="enlighter-g1">()</span><span class="enlighter-text">;?</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/tr</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">tr</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Redeem Script Hex </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text">;?</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/tr</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">tr</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Redeem Script Asm</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-k7">$opcodes</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getOpcodes</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-text"> </span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScriptParser</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">decode</span><span class="enlighter-g1">()</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k7">$operation</span><span class="enlighter-text"> </span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k1">try</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$op</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$opcodes</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getOp</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$operation</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getOp</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">catch</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">\RuntimeException </span><span class="enlighter-k7">$e</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$op</span><span class="enlighter-text"> = </span><span class="enlighter-s0">""</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$op</span><span class="enlighter-text"> ? </span><span class="enlighter-k7">$op</span><span class="enlighter-text"> . </span><span class="enlighter-s0">" "</span><span class="enlighter-text"> : </span><span class="enlighter-s0">""</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                            </span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$op</span><span class="enlighter-text"> != </span><span class="enlighter-s0">'OP_0'</span><span class="enlighter-text"> AND </span><span class="enlighter-k7">$operation</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">isPush</span><span class="enlighter-g1">())</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$bytes</span><span class="enlighter-text"> = </span><span class="enlighter-g1">(</span><span class="enlighter-k5">int</span><span class="enlighter-g1">)</span><span class="enlighter-m0">ltrim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$op</span><span class="enlighter-text">, </span><span class="enlighter-s0">'OP_PUSHDATA'</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$bytes</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$bytes</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> 0 ? </span><span class="enlighter-k7">$bytes</span><span class="enlighter-text"> : 1;</span></div></div><div class=""><div><span class="enlighter-text">                                </span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$hexsize</span><span class="enlighter-text"> = Buffer::</span><span class="enlighter-k5">int</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$operation</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getDataSize</span><span class="enlighter-g1">()</span><span class="enlighter-text">, </span><span class="enlighter-k7">$bytes</span><span class="enlighter-g1">)</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-m0">htmlentities</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"{$hexsize}&lt;{$operation-&gt;getData()-&gt;getHex()}&gt; "</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/tr</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">tr style=</span><span class="enlighter-s0">'background-color:#f0f0f0'</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Lock Type</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Absolute </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$lockTimeObject</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">isLockedToBlock</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$lockTypeValue</span><span class="enlighter-g1">)</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">"Block Height"</span><span class="enlighter-text"> : </span><span class="enlighter-s0">"Datetime"</span><span class="enlighter-text">  ?</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/tr</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span></div></div><div class=""><div><span class="enlighter-text">                </span></div></div><div class=""><div><span class="enlighter-text">                </span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">tr</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">ScriptPubKey Hex </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$p2sh</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScriptPubKey</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/tr</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">tr</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">ScriptPubKey Asm</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span></div></div><div class=""><div><span class="enlighter-text">                        </span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-k7">$opcodes</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getOpcodes</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                        </span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-text"> </span><span class="enlighter-k7">$p2sh</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScriptPubKey</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScriptParser</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">decode</span><span class="enlighter-g1">()</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k7">$operation</span><span class="enlighter-text"> </span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k1">try</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$op</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$opcodes</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getOp</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$operation</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getOp</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">catch</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">\RuntimeException </span><span class="enlighter-k7">$e</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$op</span><span class="enlighter-text"> = </span><span class="enlighter-s0">""</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$op</span><span class="enlighter-text"> ? </span><span class="enlighter-k7">$op</span><span class="enlighter-text"> . </span><span class="enlighter-s0">" "</span><span class="enlighter-text"> : </span><span class="enlighter-s0">""</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                            </span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$op</span><span class="enlighter-text"> != </span><span class="enlighter-s0">'OP_0'</span><span class="enlighter-text"> AND </span><span class="enlighter-k7">$operation</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">isPush</span><span class="enlighter-g1">())</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$bytes</span><span class="enlighter-text"> = </span><span class="enlighter-g1">(</span><span class="enlighter-k5">int</span><span class="enlighter-g1">)</span><span class="enlighter-m0">ltrim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$op</span><span class="enlighter-text">, </span><span class="enlighter-s0">'OP_PUSHDATA'</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$bytes</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$bytes</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> 0 ? </span><span class="enlighter-k7">$bytes</span><span class="enlighter-text"> : 1;</span></div></div><div class=""><div><span class="enlighter-text">                                </span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$hexsize</span><span class="enlighter-text"> = Buffer::</span><span class="enlighter-k5">int</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$operation</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getDataSize</span><span class="enlighter-g1">()</span><span class="enlighter-text">, </span><span class="enlighter-k7">$bytes</span><span class="enlighter-g1">)</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-m0">htmlentities</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"{$hexsize}&lt;{$operation-&gt;getData()-&gt;getHex()}&gt; "</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/tr</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/table</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">catch</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">Exception </span><span class="enlighter-k7">$e</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$errmsg</span><span class="enlighter-text"> .= </span><span class="enlighter-s0">"Problem found. "</span><span class="enlighter-text"> . </span><span class="enlighter-k7">$e</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getMessage</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$errmsg</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"alert alert-danger"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">strong</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Error!</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/strong</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$errmsg</span><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">form action=</span><span class="enlighter-s0">''</span><span class="enlighter-text"> method=</span><span class="enlighter-s0">'post'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"network"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Network:</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">a href=</span><span class="enlighter-s0">"../bitcoin/bitcoin_tool_mtp.php"</span><span class="enlighter-text"> target=</span><span class="enlighter-s0">"_blank"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Check Height &amp; Median Time </span><span class="enlighter-m0">Past</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">MTP</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/a</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">select id=</span><span class="enlighter-s0">"network"</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">"network"</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$networks</span><span class="enlighter-text"> = </span><span class="enlighter-m0">get_class_methods</span><span class="enlighter-g1">(</span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">NetworkFactory</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$networks</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k7">$network</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;option value='{$network}'"</span><span class="enlighter-text">.</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$network</span><span class="enlighter-text"> == </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'network'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">" selected"</span><span class="enlighter-text">: </span><span class="enlighter-s0">""</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span><span class="enlighter-s0">"&gt;{$network}&lt;/option&gt;"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/select</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"public_key"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Public Key Hex:</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'public_key'</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">'public_key'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST['</span><span class="enlighter-text">public_key</span><span class="enlighter-s0">']?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Lock Type:</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check form-check-inline"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check-label"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input type=</span><span class="enlighter-s0">"radio"</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check-input"</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">"lock_type"</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">"timestamp"</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'lock_type'</span><span class="enlighter-g1">]</span><span class="enlighter-text">==</span><span class="enlighter-s0">'timestamp'</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">' checked'</span><span class="enlighter-text">: </span><span class="enlighter-s0">''</span><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> onclick=</span><span class="enlighter-s0">"</span></div></div><div class=""><div><span class="enlighter-s0">                var self = $(this);</span></div></div><div class=""><div><span class="enlighter-s0">                var lockTypeValueE = $('#lock_type_value');</span></div></div><div class=""><div><span class="enlighter-s0">                lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['timestamp']?&gt;');                </span></div></div><div class=""><div><span class="enlighter-s0">                "</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">span </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">'explaination'</span><span class="enlighter-text"> data-toggle=</span><span class="enlighter-s0">'tooltip'</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">'Tx is spendable when datetime reach Median Time Past (MTP). MTP is just the median of the last 11 blocks.'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Datetime</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/span</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check form-check-inline"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check-label"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input type=</span><span class="enlighter-s0">"radio"</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check-input"</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">"lock_type"</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">"blockheight"</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'lock_type'</span><span class="enlighter-g1">]</span><span class="enlighter-text">==</span><span class="enlighter-s0">'blockheight'</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">' checked'</span><span class="enlighter-text">: </span><span class="enlighter-s0">''</span><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> onclick=</span><span class="enlighter-s0">"</span></div></div><div class=""><div><span class="enlighter-s0">                var self = $(this);</span></div></div><div class=""><div><span class="enlighter-s0">                var lockTypeValueE = $('#lock_type_value');</span></div></div><div class=""><div><span class="enlighter-s0">                lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['blockheight']?&gt;');                </span></div></div><div class=""><div><span class="enlighter-s0">                "</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Block Height</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'lock_type_value'</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">'lock_type_value'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST['</span><span class="enlighter-text">lock_type_value</span><span class="enlighter-s0">']?&gt;'</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">"&lt;?php echo $placeholder['locktypevalue'][ $_POST['lock_type']?$_POST['lock_type']:'default' ]?&gt;"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input type=</span><span class="enlighter-s0">'submit'</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"btn btn-success btn-block"</span><span class="enlighter-text">/</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/form</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"html_iframe_footer.php"</span><span class="enlighter-g1">)</span><span class="enlighter-text">;        </span></div></div></div><pre class="enlighter-raw">&lt;?php 
use BitWasp\Bitcoin\Bitcoin;
use BitWasp\Bitcoin\Address\ScriptHashAddress;
use BitWasp\Bitcoin\Script\ScriptFactory;
use BitWasp\Bitcoin\Script\Opcodes;
use BitWasp\Bitcoin\Key\Factory\PublicKeyFactory;
use BitWasp\Bitcoin\Network\NetworkFactory;
use BitWasp\Buffertools\Buffer;
use BitWasp\Bitcoin\Locktime;

include_once "../libraries/vendor/autoload.php";

$placeholder['locktypevalue']['default'] = 'Please choose either Datetime or block height.';
$placeholder['locktypevalue']['timestamp'] = 'Accept only format YYYY-MM-DD HH:MM:SS.';
$placeholder['locktypevalue']['blockheight'] = 'Block height must be integer.';

include_once("html_iframe_header.php");
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    try {
        
        $lockTimeObject = new Locktime();
        $networkClass   = $_POST['network'];
        Bitcoin::setNetwork(NetworkFactory::$networkClass());
        $publicKeyFactory = new PublicKeyFactory();
        
        if ($_POST['lock_type'] == 'timestamp') {
            $lockTypeValue = strtotime($_POST['lock_type_value']);
        } else if($_POST['lock_type'] == 'blockheight') {
            $lockTypeValue = (int)$_POST['lock_type_value'];
        } else {
            throw new Exception('Please choose either Datetime or block height.');
        }
        
        $lockTimeInt = (Buffer::int($lockTypeValue));
        $locktimev   = $lockTimeInt-&gt;flip()-&gt;getHex();
        
        $publicKey = $publicKeyFactory-&gt;fromHex($_POST['public_key']);
        
        $redeemScript = ScriptFactory::sequence([Buffer::hex($locktimev), Opcodes::OP_CHECKLOCKTIMEVERIFY,Opcodes::OP_DROP, Opcodes::OP_DUP, Opcodes::OP_HASH160, $publicKey-&gt;getPubKeyHash(), Opcodes::OP_EQUALVERIFY, Opcodes::OP_CHECKSIG]);
        
        
        $p2sh = new ScriptHashAddress($redeemScript-&gt;getScriptHash());
    
    ?&gt;
        &lt;div class="table-responsive"&gt;
            &lt;table border=0 class='table'&gt;
                &lt;tr style='background-color:#f0f0f0'&gt;&lt;td&gt;Base58 address&lt;/td&gt;&lt;td&gt;&lt;?php echo $p2sh-&gt;getAddress();?&gt;&lt;/td&gt;&lt;/tr&gt;
                &lt;tr&gt;&lt;td&gt;Redeem Script Hex &lt;/td&gt;&lt;td&gt;&lt;?php echo $redeemScript-&gt;getHex();?&gt;&lt;/td&gt;&lt;/tr&gt;
                &lt;tr&gt;&lt;td&gt;Redeem Script Asm&lt;/td&gt;
                    &lt;td&gt;
                        &lt;?php 
                        $opcodes = $redeemScript-&gt;getOpcodes();
                        foreach( $redeemScript-&gt;getScriptParser()-&gt;decode() as $operation ) {
                            try {
                                $op = $opcodes-&gt;getOp($operation-&gt;getOp());
                            } catch (\RuntimeException $e) {
                                $op = "";
                            }
                            
                            echo $op ? $op . " " : "";
                            
                            if ($op != 'OP_0' AND $operation-&gt;isPush()) {
                                $bytes = (int)ltrim($op, 'OP_PUSHDATA');
                                $bytes = $bytes &gt; 0 ? $bytes : 1;
                                
                                $hexsize = Buffer::int($operation-&gt;getDataSize(), $bytes)-&gt;getHex();
                                echo htmlentities("{$hexsize}&lt;{$operation-&gt;getData()-&gt;getHex()}&gt; ");
                            } 
                        }
                        ?&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
                
                &lt;tr style='background-color:#f0f0f0'&gt;&lt;td&gt;Lock Type&lt;/td&gt;&lt;td&gt;Absolute &lt;?php echo $lockTimeObject-&gt;isLockedToBlock($lockTypeValue) ? "Block Height" : "Datetime"  ?&gt;&lt;/td&gt;&lt;/tr&gt;
                
                
                
                &lt;tr&gt;&lt;td&gt;ScriptPubKey Hex &lt;/td&gt;&lt;td&gt;&lt;?php echo $p2sh-&gt;getScriptPubKey()-&gt;getHex()?&gt;&lt;/td&gt;&lt;/tr&gt;
                &lt;tr&gt;&lt;td&gt;ScriptPubKey Asm&lt;/td&gt;
                    &lt;td&gt;
                        &lt;?php 
                        
                        $opcodes = $redeemScript-&gt;getOpcodes();
                        
                        foreach( $p2sh-&gt;getScriptPubKey()-&gt;getScriptParser()-&gt;decode() as $operation ) {
                            try {
                                $op = $opcodes-&gt;getOp($operation-&gt;getOp());
                            } catch (\RuntimeException $e) {
                                $op = "";
                            }
                            
                            echo $op ? $op . " " : "";
                            
                            if ($op != 'OP_0' AND $operation-&gt;isPush()) {
                                $bytes = (int)ltrim($op, 'OP_PUSHDATA');
                                $bytes = $bytes &gt; 0 ? $bytes : 1;
                                
                                $hexsize = Buffer::int($operation-&gt;getDataSize(), $bytes)-&gt;getHex();
                                echo htmlentities("{$hexsize}&lt;{$operation-&gt;getData()-&gt;getHex()}&gt; ");
                            } 
                        }
                        ?&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
            &lt;/table&gt;
        &lt;/div&gt;
&lt;?php 
    } catch (Exception $e) {
        $errmsg .= "Problem found. " . $e-&gt;getMessage();

    }
} 

if ($errmsg) {
?&gt;
    &lt;div class="alert alert-danger"&gt;
        &lt;strong&gt;Error!&lt;/strong&gt; &lt;?php echo $errmsg?&gt;
    &lt;/div&gt;
&lt;?php
}
?&gt;
&lt;form action='' method='post'&gt;
    &lt;div class="form-group"&gt;
        &lt;label for="network"&gt;Network:&lt;/label&gt; &lt;a href="../bitcoin/bitcoin_tool_mtp.php" target="_blank"&gt;Check Height &amp; Median Time Past (MTP).&lt;/a&gt;
        &lt;select id="network" name="network" class="form-control" &gt;
            &lt;?php
            $networks = get_class_methods(new NetworkFactory());
            foreach($networks as $network) {
                echo "&lt;option value='{$network}'".($network == $_POST['network'] ? " selected": "")."&gt;{$network}&lt;/option&gt;";
            }
            ?&gt;
        &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class="form-group"&gt;
        &lt;label for="public_key"&gt;Public Key Hex:&lt;/label&gt;
        &lt;input class="form-control" type='text' name='public_key' id='public_key' value='&lt;?php echo $_POST['public_key']?&gt;'&gt;
    &lt;/div&gt;
    
    &lt;div class="form-group"&gt;
        &lt;label&gt;Lock Type:&lt;/label&gt;
        
        &lt;div class="form-check form-check-inline"&gt;
            &lt;label class="form-check-label"&gt;
                &lt;input type="radio" class="form-check-input" name="lock_type" value="timestamp"&lt;?php echo $_POST['lock_type']=='timestamp' ? ' checked': ''?&gt; onclick="
                var self = $(this);
                var lockTypeValueE = $('#lock_type_value');
                lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['timestamp']?&gt;');                
                "&gt;&lt;span class='explaination' data-toggle='tooltip' title='Tx is spendable when datetime reach Median Time Past (MTP). MTP is just the median of the last 11 blocks.'&gt;Datetime&lt;/span&gt;
            &lt;/label&gt;
        &lt;/div&gt;
        &lt;div class="form-check form-check-inline"&gt;
            &lt;label class="form-check-label"&gt;
                &lt;input type="radio" class="form-check-input" name="lock_type" value="blockheight"&lt;?php echo $_POST['lock_type']=='blockheight' ? ' checked': ''?&gt; onclick="
                var self = $(this);
                var lockTypeValueE = $('#lock_type_value');
                lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['blockheight']?&gt;');                
                "&gt;Block Height
            &lt;/label&gt;
        &lt;/div&gt;
        
        &lt;input class="form-control" type='text' name='lock_type_value' id='lock_type_value' value='&lt;?php echo $_POST['lock_type_value']?&gt;' placeholder="&lt;?php echo $placeholder['locktypevalue'][ $_POST['lock_type']?$_POST['lock_type']:'default' ]?&gt;"&gt;
    &lt;/div&gt;
    &lt;input type='submit' class="btn btn-success btn-block"/&gt;
&lt;/form&gt;
&lt;?php
include_once("html_iframe_footer.php");        </pre></div><pre style="border-radius:none;" class="enlighter-origin">&lt;?php 
use BitWasp\Bitcoin\Bitcoin;
use BitWasp\Bitcoin\Address\ScriptHashAddress;
use BitWasp\Bitcoin\Script\ScriptFactory;
use BitWasp\Bitcoin\Script\Opcodes;
use BitWasp\Bitcoin\Key\Factory\PublicKeyFactory;
use BitWasp\Bitcoin\Network\NetworkFactory;
use BitWasp\Buffertools\Buffer;
use BitWasp\Bitcoin\Locktime;

include_once "../libraries/vendor/autoload.php";

$placeholder['locktypevalue']['default'] = 'Please choose either Datetime or block height.';
$placeholder['locktypevalue']['timestamp'] = 'Accept only format YYYY-MM-DD HH:MM:SS.';
$placeholder['locktypevalue']['blockheight'] = 'Block height must be integer.';

include_once("html_iframe_header.php");
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
	try {
		
		$lockTimeObject = new Locktime();
		$networkClass   = $_POST['network'];
		Bitcoin::setNetwork(NetworkFactory::$networkClass());
		$publicKeyFactory = new PublicKeyFactory();
		
		if ($_POST['lock_type'] == 'timestamp') {
			$lockTypeValue = strtotime($_POST['lock_type_value']);
		} else if($_POST['lock_type'] == 'blockheight') {
			$lockTypeValue = (int)$_POST['lock_type_value'];
		} else {
			throw new Exception('Please choose either Datetime or block height.');
		}
		
		$lockTimeInt = (Buffer::int($lockTypeValue));
		$locktimev   = $lockTimeInt-&gt;flip()-&gt;getHex();
		
		$publicKey = $publicKeyFactory-&gt;fromHex($_POST['public_key']);
		
		$redeemScript = ScriptFactory::sequence([Buffer::hex($locktimev), Opcodes::OP_CHECKLOCKTIMEVERIFY,Opcodes::OP_DROP, Opcodes::OP_DUP, Opcodes::OP_HASH160, $publicKey-&gt;getPubKeyHash(), Opcodes::OP_EQUALVERIFY, Opcodes::OP_CHECKSIG]);
		
		
		$p2sh = new ScriptHashAddress($redeemScript-&gt;getScriptHash());
	
	?&gt;
		&lt;div class="table-responsive"&gt;
			&lt;table border=0 class='table'&gt;
				&lt;tr style='background-color:#f0f0f0'&gt;&lt;td&gt;Base58 address&lt;/td&gt;&lt;td&gt;&lt;?php echo $p2sh-&gt;getAddress();?&gt;&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;Redeem Script Hex &lt;/td&gt;&lt;td&gt;&lt;?php echo $redeemScript-&gt;getHex();?&gt;&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;Redeem Script Asm&lt;/td&gt;
					&lt;td&gt;
						&lt;?php 
						$opcodes = $redeemScript-&gt;getOpcodes();
						foreach( $redeemScript-&gt;getScriptParser()-&gt;decode() as $operation ) {
							try {
								$op = $opcodes-&gt;getOp($operation-&gt;getOp());
							} catch (\RuntimeException $e) {
								$op = "";
							}
							
							echo $op ? $op . " " : "";
							
							if ($op != 'OP_0' AND $operation-&gt;isPush()) {
								$bytes = (int)ltrim($op, 'OP_PUSHDATA');
								$bytes = $bytes &gt; 0 ? $bytes : 1;
								
								$hexsize = Buffer::int($operation-&gt;getDataSize(), $bytes)-&gt;getHex();
								echo htmlentities("{$hexsize}&lt;{$operation-&gt;getData()-&gt;getHex()}&gt; ");
							} 
						}
						?&gt;
					&lt;/td&gt;
				&lt;/tr&gt;
				
				&lt;tr style='background-color:#f0f0f0'&gt;&lt;td&gt;Lock Type&lt;/td&gt;&lt;td&gt;Absolute &lt;?php echo $lockTimeObject-&gt;isLockedToBlock($lockTypeValue) ? "Block Height" : "Datetime"  ?&gt;&lt;/td&gt;&lt;/tr&gt;
				
				
				
				&lt;tr&gt;&lt;td&gt;ScriptPubKey Hex &lt;/td&gt;&lt;td&gt;&lt;?php echo $p2sh-&gt;getScriptPubKey()-&gt;getHex()?&gt;&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;ScriptPubKey Asm&lt;/td&gt;
					&lt;td&gt;
						&lt;?php 
						
						$opcodes = $redeemScript-&gt;getOpcodes();
						
						foreach( $p2sh-&gt;getScriptPubKey()-&gt;getScriptParser()-&gt;decode() as $operation ) {
							try {
								$op = $opcodes-&gt;getOp($operation-&gt;getOp());
							} catch (\RuntimeException $e) {
								$op = "";
							}
							
							echo $op ? $op . " " : "";
							
							if ($op != 'OP_0' AND $operation-&gt;isPush()) {
								$bytes = (int)ltrim($op, 'OP_PUSHDATA');
								$bytes = $bytes &gt; 0 ? $bytes : 1;
								
								$hexsize = Buffer::int($operation-&gt;getDataSize(), $bytes)-&gt;getHex();
								echo htmlentities("{$hexsize}&lt;{$operation-&gt;getData()-&gt;getHex()}&gt; ");
							} 
						}
						?&gt;
					&lt;/td&gt;
				&lt;/tr&gt;
			&lt;/table&gt;
		&lt;/div&gt;
&lt;?php 
	} catch (Exception $e) {
		$errmsg .= "Problem found. " . $e-&gt;getMessage();

	}
} 

if ($errmsg) {
?&gt;
	&lt;div class="alert alert-danger"&gt;
		&lt;strong&gt;Error!&lt;/strong&gt; &lt;?php echo $errmsg?&gt;
	&lt;/div&gt;
&lt;?php
}
?&gt;
&lt;form action='' method='post'&gt;
	&lt;div class="form-group"&gt;
		&lt;label for="network"&gt;Network:&lt;/label&gt; &lt;a href="../bitcoin/bitcoin_tool_mtp.php" target="_blank"&gt;Check Height &amp; Median Time Past (MTP).&lt;/a&gt;
		&lt;select id="network" name="network" class="form-control" &gt;
			&lt;?php
			$networks = get_class_methods(new NetworkFactory());
			foreach($networks as $network) {
				echo "&lt;option value='{$network}'".($network == $_POST['network'] ? " selected": "")."&gt;{$network}&lt;/option&gt;";
			}
			?&gt;
		&lt;/select&gt;
	&lt;/div&gt;
	&lt;div class="form-group"&gt;
		&lt;label for="public_key"&gt;Public Key Hex:&lt;/label&gt;
		&lt;input class="form-control" type='text' name='public_key' id='public_key' value='&lt;?php echo $_POST['public_key']?&gt;'&gt;
	&lt;/div&gt;
	
	&lt;div class="form-group"&gt;
		&lt;label&gt;Lock Type:&lt;/label&gt;
		
		&lt;div class="form-check form-check-inline"&gt;
			&lt;label class="form-check-label"&gt;
				&lt;input type="radio" class="form-check-input" name="lock_type" value="timestamp"&lt;?php echo $_POST['lock_type']=='timestamp' ? ' checked': ''?&gt; onclick="
				var self = $(this);
				var lockTypeValueE = $('#lock_type_value');
				lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['timestamp']?&gt;');				
				"&gt;&lt;span class='explaination' data-toggle='tooltip' title='Tx is spendable when datetime reach Median Time Past (MTP). MTP is just the median of the last 11 blocks.'&gt;Datetime&lt;/span&gt;
			&lt;/label&gt;
		&lt;/div&gt;
		&lt;div class="form-check form-check-inline"&gt;
			&lt;label class="form-check-label"&gt;
				&lt;input type="radio" class="form-check-input" name="lock_type" value="blockheight"&lt;?php echo $_POST['lock_type']=='blockheight' ? ' checked': ''?&gt; onclick="
				var self = $(this);
				var lockTypeValueE = $('#lock_type_value');
				lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['blockheight']?&gt;');				
				"&gt;Block Height
			&lt;/label&gt;
		&lt;/div&gt;
		
		&lt;input class="form-control" type='text' name='lock_type_value' id='lock_type_value' value='&lt;?php echo $_POST['lock_type_value']?&gt;' placeholder="&lt;?php echo $placeholder['locktypevalue'][ $_POST['lock_type']?$_POST['lock_type']:'default' ]?&gt;"&gt;
	&lt;/div&gt;
	&lt;input type='submit' class="btn btn-success btn-block"/&gt;
&lt;/form&gt;
&lt;?php
include_once("html_iframe_footer.php");		</pre> 		
	</div>
	
	<div id="form1_tabitem3" class="tab-pane fade">
		<iframe src="./Bitcoin P2SH.LOCKTIME_files/bitcoin_script_p2sh_csv_address.html" width="100%" scrolling="no" frameborder="no" id="iFrameResizer1" style="overflow: hidden; height: 0px;"></iframe>
	</div>
	<div id="form1_tabitem4" class="tab-pane fade">
		<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"></div><div class="enlighter-btn enlighter-btn-copy"></div><div class="enlighter-btn enlighter-btn-window"></div><div class="enlighter-btn enlighter-btn-website"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Bitcoin;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Address\ScriptHashAddress;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\ScriptFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\Opcodes;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Key\Factory\PublicKeyFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Network\NetworkFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Buffertools\Buffer;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Locktime;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Transaction\TransactionInputInterface;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-text"> </span><span class="enlighter-s0">"../libraries/vendor/autoload.php"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$placeholder</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'locktypevalue'</span><span class="enlighter-g1">][</span><span class="enlighter-s0">'default'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> = </span><span class="enlighter-s0">'Please choose either relative time or relative height.'</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$placeholder</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'locktypevalue'</span><span class="enlighter-g1">][</span><span class="enlighter-s0">'timestamp'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> = </span><span class="enlighter-s0">'Accept only seconds (integer).'</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$placeholder</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'locktypevalue'</span><span class="enlighter-g1">][</span><span class="enlighter-s0">'timestamp_extra'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> = </span><span class="enlighter-s0">"Granularity of 512 seconds. Spend is allow once chain\'s MTP &gt;= UTXO\'s block MTP + Relative Time."</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$placeholder</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'locktypevalue'</span><span class="enlighter-g1">][</span><span class="enlighter-s0">'blockheight'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> = </span><span class="enlighter-s0">'Relative height must be integer.'</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$placeholder</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'locktypevalue'</span><span class="enlighter-g1">][</span><span class="enlighter-s0">'blockheight_extra'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> = </span><span class="enlighter-s0">""</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"html_iframe_header.php"</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_SERVER</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'REQUEST_METHOD'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> == </span><span class="enlighter-s0">'POST'</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k1">try</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$lockTimeObject</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Locktime</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$networkClass</span><span class="enlighter-text">   = </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'network'</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        Bitcoin::</span><span class="enlighter-m0">setNetwork</span><span class="enlighter-g1">(</span><span class="enlighter-text">NetworkFactory::</span><span class="enlighter-k7">$networkClass</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$publicKeyFactory</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">PublicKeyFactory</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'lock_type'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> == </span><span class="enlighter-s0">'timestamp'</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$lockTypeValue</span><span class="enlighter-text"> = </span><span class="enlighter-g1">(</span><span class="enlighter-k5">int</span><span class="enlighter-g1">)</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'lock_type_value'</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">           </span><span class="enlighter-c0"> //enable granularity of 512 seconds</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$lockTypeValue</span><span class="enlighter-text"> = TransactionInputInterface::</span><span class="enlighter-m2">SEQUENCE_LOCKTIME_TYPE_FLAG</span><span class="enlighter-text"> | </span><span class="enlighter-k7">$lockTypeValue</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-k1">if</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'lock_type'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> == </span><span class="enlighter-s0">'blockheight'</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$lockTypeValue</span><span class="enlighter-text"> = </span><span class="enlighter-g1">(</span><span class="enlighter-k5">int</span><span class="enlighter-g1">)</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'lock_type_value'</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">'Please choose either Relative Time or Relative Height.'</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$opcodes</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Opcodes</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$lockTypeValue</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">= 1 AND </span><span class="enlighter-k7">$lockTypeValue</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">= 16</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$opCodeName</span><span class="enlighter-text"> = </span><span class="enlighter-s0">"OP_{$lockTypeValue}"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$locktimev</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$opcodes</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getOpByName</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$opCodeName</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$isRelativeTime</span><span class="enlighter-text"> = </span><span class="enlighter-e0">false</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$lockTimeInt</span><span class="enlighter-text"> = </span><span class="enlighter-g1">(</span><span class="enlighter-text">Buffer::</span><span class="enlighter-k5">int</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$lockTypeValue</span><span class="enlighter-g1">))</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$locktimev</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$lockTimeInt</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">flip</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$isRelativeTime</span><span class="enlighter-text"> = </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$lockTimeInt</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getInt</span><span class="enlighter-g1">()</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;&gt;</span><span class="enlighter-text"> 22 &amp; </span><span class="enlighter-n2">0x1</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$publicKey</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$publicKeyFactory</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">fromHex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'public_key'</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text"> = ScriptFactory::</span><span class="enlighter-m0">sequence</span><span class="enlighter-g1">([</span><span class="enlighter-k7">$locktimev</span><span class="enlighter-text">, Opcodes::</span><span class="enlighter-m2">OP_CHECKSEQUENCEVERIFY</span><span class="enlighter-text">,Opcodes::</span><span class="enlighter-m2">OP_DROP</span><span class="enlighter-text">, Opcodes::</span><span class="enlighter-m2">OP_DUP</span><span class="enlighter-text">, Opcodes::</span><span class="enlighter-m2">OP_HASH160</span><span class="enlighter-text">, </span><span class="enlighter-k7">$publicKey</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getPubKeyHash</span><span class="enlighter-g1">()</span><span class="enlighter-text">, Opcodes::</span><span class="enlighter-m2">OP_EQUALVERIFY</span><span class="enlighter-text">, Opcodes::</span><span class="enlighter-m2">OP_CHECKSIG</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$p2sh</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">ScriptHashAddress</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScriptHash</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"table-responsive"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">table border=0 </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">'table'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">tr style=</span><span class="enlighter-s0">'background-color:#f0f0f0'</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Base58 address</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$p2sh</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getAddress</span><span class="enlighter-g1">()</span><span class="enlighter-text">;?</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/tr</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">tr</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Redeem Script Hex </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text">;?</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/tr</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">tr</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Redeem Script Asm</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-k7">$opcodes</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getOpcodes</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-text"> </span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScriptParser</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">decode</span><span class="enlighter-g1">()</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k7">$operation</span><span class="enlighter-text"> </span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k1">try</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$op</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$opcodes</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getOp</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$operation</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getOp</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">catch</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">\RuntimeException </span><span class="enlighter-k7">$e</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$op</span><span class="enlighter-text"> = </span><span class="enlighter-s0">""</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$op</span><span class="enlighter-text"> ? </span><span class="enlighter-k7">$op</span><span class="enlighter-text"> . </span><span class="enlighter-s0">" "</span><span class="enlighter-text"> : </span><span class="enlighter-s0">""</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                            </span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$op</span><span class="enlighter-text"> != </span><span class="enlighter-s0">'OP_0'</span><span class="enlighter-text"> AND </span><span class="enlighter-k7">$operation</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">isPush</span><span class="enlighter-g1">())</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$bytes</span><span class="enlighter-text"> = </span><span class="enlighter-g1">(</span><span class="enlighter-k5">int</span><span class="enlighter-g1">)</span><span class="enlighter-m0">ltrim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$op</span><span class="enlighter-text">, </span><span class="enlighter-s0">'OP_PUSHDATA'</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$bytes</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$bytes</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> 0 ? </span><span class="enlighter-k7">$bytes</span><span class="enlighter-text"> : 1;</span></div></div><div class=""><div><span class="enlighter-text">                                </span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$hexsize</span><span class="enlighter-text"> = Buffer::</span><span class="enlighter-k5">int</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$operation</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getDataSize</span><span class="enlighter-g1">()</span><span class="enlighter-text">, </span><span class="enlighter-k7">$bytes</span><span class="enlighter-g1">)</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-m0">htmlentities</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"{$hexsize}&lt;{$operation-&gt;getData()-&gt;getHex()}&gt; "</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/tr</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">tr style=</span><span class="enlighter-s0">'background-color:#f0f0f0'</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Lock Type</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Relative </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> !</span><span class="enlighter-k7">$isRelativeTime</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">"Height"</span><span class="enlighter-text"> : </span><span class="enlighter-s0">"Time"</span><span class="enlighter-text">  ?</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/tr</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span></div></div><div class=""><div><span class="enlighter-text">                </span></div></div><div class=""><div><span class="enlighter-text">                </span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">tr</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">ScriptPubKey Hex </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$p2sh</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScriptPubKey</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/tr</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">tr</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">ScriptPubKey Asm</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span></div></div><div class=""><div><span class="enlighter-text">                        </span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-k7">$opcodes</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getOpcodes</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                        </span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-text"> </span><span class="enlighter-k7">$p2sh</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScriptPubKey</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScriptParser</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">decode</span><span class="enlighter-g1">()</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k7">$operation</span><span class="enlighter-text"> </span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k1">try</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$op</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$opcodes</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getOp</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$operation</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getOp</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">catch</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">\RuntimeException </span><span class="enlighter-k7">$e</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$op</span><span class="enlighter-text"> = </span><span class="enlighter-s0">""</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$op</span><span class="enlighter-text"> ? </span><span class="enlighter-k7">$op</span><span class="enlighter-text"> . </span><span class="enlighter-s0">" "</span><span class="enlighter-text"> : </span><span class="enlighter-s0">""</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                            </span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$op</span><span class="enlighter-text"> != </span><span class="enlighter-s0">'OP_0'</span><span class="enlighter-text"> AND </span><span class="enlighter-k7">$operation</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">isPush</span><span class="enlighter-g1">())</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$bytes</span><span class="enlighter-text"> = </span><span class="enlighter-g1">(</span><span class="enlighter-k5">int</span><span class="enlighter-g1">)</span><span class="enlighter-m0">ltrim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$op</span><span class="enlighter-text">, </span><span class="enlighter-s0">'OP_PUSHDATA'</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$bytes</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$bytes</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> 0 ? </span><span class="enlighter-k7">$bytes</span><span class="enlighter-text"> : 1;</span></div></div><div class=""><div><span class="enlighter-text">                                </span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$hexsize</span><span class="enlighter-text"> = Buffer::</span><span class="enlighter-k5">int</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$operation</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getDataSize</span><span class="enlighter-g1">()</span><span class="enlighter-text">, </span><span class="enlighter-k7">$bytes</span><span class="enlighter-g1">)</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-m0">htmlentities</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"{$hexsize}&lt;{$operation-&gt;getData()-&gt;getHex()}&gt; "</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/td</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/tr</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/table</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">catch</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">Exception </span><span class="enlighter-k7">$e</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$errmsg</span><span class="enlighter-text"> .= </span><span class="enlighter-s0">"Problem found. "</span><span class="enlighter-text"> . </span><span class="enlighter-k7">$e</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getMessage</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$errmsg</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"alert alert-danger"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">strong</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Error!</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/strong</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$errmsg</span><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">form action=</span><span class="enlighter-s0">''</span><span class="enlighter-text"> method=</span><span class="enlighter-s0">'post'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"network"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Network:</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">a href=</span><span class="enlighter-s0">"../bitcoin/bitcoin_tool_mtp.php"</span><span class="enlighter-text"> target=</span><span class="enlighter-s0">"_blank"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Check Height &amp; Median Time </span><span class="enlighter-m0">Past</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">MTP</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/a</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">select id=</span><span class="enlighter-s0">"network"</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">"network"</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$networks</span><span class="enlighter-text"> = </span><span class="enlighter-m0">get_class_methods</span><span class="enlighter-g1">(</span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">NetworkFactory</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$networks</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k7">$network</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;option value='{$network}'"</span><span class="enlighter-text">.</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$network</span><span class="enlighter-text"> == </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'network'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">" selected"</span><span class="enlighter-text">: </span><span class="enlighter-s0">""</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span><span class="enlighter-s0">"&gt;{$network}&lt;/option&gt;"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/select</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"public_key"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Public Key Hex:</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'public_key'</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">'public_key'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST['</span><span class="enlighter-text">public_key</span><span class="enlighter-s0">']?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Lock Type:</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check form-check-inline"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check-label"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input type=</span><span class="enlighter-s0">"radio"</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check-input"</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">"lock_type"</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">"timestamp"</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'lock_type'</span><span class="enlighter-g1">]</span><span class="enlighter-text">==</span><span class="enlighter-s0">'timestamp'</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">' checked'</span><span class="enlighter-text">: </span><span class="enlighter-s0">''</span><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> onclick=</span><span class="enlighter-s0">"</span></div></div><div class=""><div><span class="enlighter-s0">                var self = $(this);</span></div></div><div class=""><div><span class="enlighter-s0">                var lockTypeValueE = $('#lock_type_value');</span></div></div><div class=""><div><span class="enlighter-s0">                var lockTypeExtraE = $('#lock_type_extra');</span></div></div><div class=""><div><span class="enlighter-s0">                lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['timestamp']?&gt;');                </span></div></div><div class=""><div><span class="enlighter-s0">                lockTypeExtraE.html('&lt;?php echo htmlentities($placeholder['locktypevalue']['timestamp_extra'],ENT_QUOTES)?&gt;');    </span></div></div><div class=""><div><span class="enlighter-s0">                "</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Relative Time</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check form-check-inline"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check-label"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input type=</span><span class="enlighter-s0">"radio"</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check-input"</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">"lock_type"</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">"blockheight"</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'lock_type'</span><span class="enlighter-g1">]</span><span class="enlighter-text">==</span><span class="enlighter-s0">'blockheight'</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">' checked'</span><span class="enlighter-text">: </span><span class="enlighter-s0">''</span><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> onclick=</span><span class="enlighter-s0">"</span></div></div><div class=""><div><span class="enlighter-s0">                var self = $(this);</span></div></div><div class=""><div><span class="enlighter-s0">                var lockTypeValueE = $('#lock_type_value');</span></div></div><div class=""><div><span class="enlighter-s0">                var lockTypeExtraE = $('#lock_type_extra');</span></div></div><div class=""><div><span class="enlighter-s0">                lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['blockheight']?&gt;');                </span></div></div><div class=""><div><span class="enlighter-s0">                lockTypeExtraE.html('&lt;?php echo $placeholder['locktypevalue']['blockheight_extra']?&gt;');    </span></div></div><div class=""><div><span class="enlighter-s0">                "</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Relative Height</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'lock_type_value'</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">'lock_type_value'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST['</span><span class="enlighter-text">lock_type_value</span><span class="enlighter-s0">']?&gt;'</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">"&lt;?php echo $placeholder['locktypevalue'][ $_POST['lock_type']?$_POST['lock_type']:'default' ]?&gt;"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">span id=</span><span class="enlighter-s0">'lock_type_extra'</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/span</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input type=</span><span class="enlighter-s0">'submit'</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"btn btn-success btn-block"</span><span class="enlighter-text">/</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/form</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"html_iframe_footer.php"</span><span class="enlighter-g1">)</span><span class="enlighter-text">;        </span></div></div></div><pre class="enlighter-raw">&lt;?php 
use BitWasp\Bitcoin\Bitcoin;
use BitWasp\Bitcoin\Address\ScriptHashAddress;
use BitWasp\Bitcoin\Script\ScriptFactory;
use BitWasp\Bitcoin\Script\Opcodes;
use BitWasp\Bitcoin\Key\Factory\PublicKeyFactory;
use BitWasp\Bitcoin\Network\NetworkFactory;
use BitWasp\Buffertools\Buffer;
use BitWasp\Bitcoin\Locktime;
use BitWasp\Bitcoin\Transaction\TransactionInputInterface;

include_once "../libraries/vendor/autoload.php";

$placeholder['locktypevalue']['default'] = 'Please choose either relative time or relative height.';
$placeholder['locktypevalue']['timestamp'] = 'Accept only seconds (integer).';
$placeholder['locktypevalue']['timestamp_extra'] = "Granularity of 512 seconds. Spend is allow once chain\'s MTP &gt;= UTXO\'s block MTP + Relative Time.";
$placeholder['locktypevalue']['blockheight'] = 'Relative height must be integer.';
$placeholder['locktypevalue']['blockheight_extra'] = "";

include_once("html_iframe_header.php");
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    try {
        
        $lockTimeObject = new Locktime();
        $networkClass   = $_POST['network'];
        Bitcoin::setNetwork(NetworkFactory::$networkClass());
        $publicKeyFactory = new PublicKeyFactory();
        
        if ($_POST['lock_type'] == 'timestamp') {
            $lockTypeValue = (int)$_POST['lock_type_value'];
            
            //enable granularity of 512 seconds
            $lockTypeValue = TransactionInputInterface::SEQUENCE_LOCKTIME_TYPE_FLAG | $lockTypeValue;
        } else if($_POST['lock_type'] == 'blockheight') {
            $lockTypeValue = (int)$_POST['lock_type_value'];
        } else {
            throw new Exception('Please choose either Relative Time or Relative Height.');
        }
        
        $opcodes = new Opcodes();
        
        if ($lockTypeValue &gt;= 1 AND $lockTypeValue &lt;= 16) {
            $opCodeName = "OP_{$lockTypeValue}";
            $locktimev = $opcodes-&gt;getOpByName($opCodeName);
            $isRelativeTime = false;
        } else {
            $lockTimeInt = (Buffer::int($lockTypeValue));
            $locktimev = $lockTimeInt-&gt;flip();
            $isRelativeTime = ($lockTimeInt-&gt;getInt() &gt;&gt; 22 &amp; 0x1);
        }
        
        
        $publicKey = $publicKeyFactory-&gt;fromHex($_POST['public_key']);
        
        $redeemScript = ScriptFactory::sequence([$locktimev, Opcodes::OP_CHECKSEQUENCEVERIFY,Opcodes::OP_DROP, Opcodes::OP_DUP, Opcodes::OP_HASH160, $publicKey-&gt;getPubKeyHash(), Opcodes::OP_EQUALVERIFY, Opcodes::OP_CHECKSIG]);
        
        
        $p2sh = new ScriptHashAddress($redeemScript-&gt;getScriptHash());
    
    ?&gt;
        &lt;div class="table-responsive"&gt;
            &lt;table border=0 class='table'&gt;
                &lt;tr style='background-color:#f0f0f0'&gt;&lt;td&gt;Base58 address&lt;/td&gt;&lt;td&gt;&lt;?php echo $p2sh-&gt;getAddress();?&gt;&lt;/td&gt;&lt;/tr&gt;
                &lt;tr&gt;&lt;td&gt;Redeem Script Hex &lt;/td&gt;&lt;td&gt;&lt;?php echo $redeemScript-&gt;getHex();?&gt;&lt;/td&gt;&lt;/tr&gt;
                &lt;tr&gt;&lt;td&gt;Redeem Script Asm&lt;/td&gt;
                    &lt;td&gt;
                        &lt;?php 
                        $opcodes = $redeemScript-&gt;getOpcodes();
                        foreach( $redeemScript-&gt;getScriptParser()-&gt;decode() as $operation ) {
                            try {
                                $op = $opcodes-&gt;getOp($operation-&gt;getOp());
                            } catch (\RuntimeException $e) {
                                $op = "";
                            }
                            
                            echo $op ? $op . " " : "";
                            
                            if ($op != 'OP_0' AND $operation-&gt;isPush()) {
                                $bytes = (int)ltrim($op, 'OP_PUSHDATA');
                                $bytes = $bytes &gt; 0 ? $bytes : 1;
                                
                                $hexsize = Buffer::int($operation-&gt;getDataSize(), $bytes)-&gt;getHex();
                                echo htmlentities("{$hexsize}&lt;{$operation-&gt;getData()-&gt;getHex()}&gt; ");
                            } 
                        }
                        ?&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
                
                &lt;tr style='background-color:#f0f0f0'&gt;&lt;td&gt;Lock Type&lt;/td&gt;&lt;td&gt;Relative &lt;?php echo !$isRelativeTime ? "Height" : "Time"  ?&gt;&lt;/td&gt;&lt;/tr&gt;
                
                
                
                &lt;tr&gt;&lt;td&gt;ScriptPubKey Hex &lt;/td&gt;&lt;td&gt;&lt;?php echo $p2sh-&gt;getScriptPubKey()-&gt;getHex()?&gt;&lt;/td&gt;&lt;/tr&gt;
                &lt;tr&gt;&lt;td&gt;ScriptPubKey Asm&lt;/td&gt;
                    &lt;td&gt;
                        &lt;?php 
                        
                        $opcodes = $redeemScript-&gt;getOpcodes();
                        
                        foreach( $p2sh-&gt;getScriptPubKey()-&gt;getScriptParser()-&gt;decode() as $operation ) {
                            try {
                                $op = $opcodes-&gt;getOp($operation-&gt;getOp());
                            } catch (\RuntimeException $e) {
                                $op = "";
                            }
                            
                            echo $op ? $op . " " : "";
                            
                            if ($op != 'OP_0' AND $operation-&gt;isPush()) {
                                $bytes = (int)ltrim($op, 'OP_PUSHDATA');
                                $bytes = $bytes &gt; 0 ? $bytes : 1;
                                
                                $hexsize = Buffer::int($operation-&gt;getDataSize(), $bytes)-&gt;getHex();
                                echo htmlentities("{$hexsize}&lt;{$operation-&gt;getData()-&gt;getHex()}&gt; ");
                            } 
                        }
                        ?&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
            &lt;/table&gt;
        &lt;/div&gt;
&lt;?php 
    } catch (Exception $e) {
        $errmsg .= "Problem found. " . $e-&gt;getMessage();

    }
} 

if ($errmsg) {
?&gt;
    &lt;div class="alert alert-danger"&gt;
        &lt;strong&gt;Error!&lt;/strong&gt; &lt;?php echo $errmsg?&gt;
    &lt;/div&gt;
&lt;?php
}
?&gt;
&lt;form action='' method='post'&gt;
    &lt;div class="form-group"&gt;
        &lt;label for="network"&gt;Network:&lt;/label&gt; &lt;a href="../bitcoin/bitcoin_tool_mtp.php" target="_blank"&gt;Check Height &amp; Median Time Past (MTP).&lt;/a&gt;
        &lt;select id="network" name="network" class="form-control" &gt;
            &lt;?php
            $networks = get_class_methods(new NetworkFactory());
            foreach($networks as $network) {
                echo "&lt;option value='{$network}'".($network == $_POST['network'] ? " selected": "")."&gt;{$network}&lt;/option&gt;";
            }
            ?&gt;
        &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class="form-group"&gt;
        &lt;label for="public_key"&gt;Public Key Hex:&lt;/label&gt;
        &lt;input class="form-control" type='text' name='public_key' id='public_key' value='&lt;?php echo $_POST['public_key']?&gt;'&gt;
    &lt;/div&gt;
    
    &lt;div class="form-group"&gt;
        &lt;label&gt;Lock Type:&lt;/label&gt;
        
        &lt;div class="form-check form-check-inline"&gt;
            &lt;label class="form-check-label"&gt;
                &lt;input type="radio" class="form-check-input" name="lock_type" value="timestamp"&lt;?php echo $_POST['lock_type']=='timestamp' ? ' checked': ''?&gt; onclick="
                var self = $(this);
                var lockTypeValueE = $('#lock_type_value');
                var lockTypeExtraE = $('#lock_type_extra');
                lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['timestamp']?&gt;');                
                lockTypeExtraE.html('&lt;?php echo htmlentities($placeholder['locktypevalue']['timestamp_extra'],ENT_QUOTES)?&gt;');    
                "&gt;Relative Time
            &lt;/label&gt;
        &lt;/div&gt;
        &lt;div class="form-check form-check-inline"&gt;
            &lt;label class="form-check-label"&gt;
                &lt;input type="radio" class="form-check-input" name="lock_type" value="blockheight"&lt;?php echo $_POST['lock_type']=='blockheight' ? ' checked': ''?&gt; onclick="
                var self = $(this);
                var lockTypeValueE = $('#lock_type_value');
                var lockTypeExtraE = $('#lock_type_extra');
                lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['blockheight']?&gt;');                
                lockTypeExtraE.html('&lt;?php echo $placeholder['locktypevalue']['blockheight_extra']?&gt;');    
                "&gt;Relative Height
            &lt;/label&gt;
        &lt;/div&gt;
        
        &lt;input class="form-control" type='text' name='lock_type_value' id='lock_type_value' value='&lt;?php echo $_POST['lock_type_value']?&gt;' placeholder="&lt;?php echo $placeholder['locktypevalue'][ $_POST['lock_type']?$_POST['lock_type']:'default' ]?&gt;"&gt;
        
        &lt;span id='lock_type_extra'&gt;&lt;/span&gt;
    &lt;/div&gt;
    &lt;input type='submit' class="btn btn-success btn-block"/&gt;
&lt;/form&gt;
&lt;?php
include_once("html_iframe_footer.php");        </pre></div><pre style="border-radius:none;" class="enlighter-origin">&lt;?php 
use BitWasp\Bitcoin\Bitcoin;
use BitWasp\Bitcoin\Address\ScriptHashAddress;
use BitWasp\Bitcoin\Script\ScriptFactory;
use BitWasp\Bitcoin\Script\Opcodes;
use BitWasp\Bitcoin\Key\Factory\PublicKeyFactory;
use BitWasp\Bitcoin\Network\NetworkFactory;
use BitWasp\Buffertools\Buffer;
use BitWasp\Bitcoin\Locktime;
use BitWasp\Bitcoin\Transaction\TransactionInputInterface;

include_once "../libraries/vendor/autoload.php";

$placeholder['locktypevalue']['default'] = 'Please choose either relative time or relative height.';
$placeholder['locktypevalue']['timestamp'] = 'Accept only seconds (integer).';
$placeholder['locktypevalue']['timestamp_extra'] = "Granularity of 512 seconds. Spend is allow once chain\'s MTP &gt;= UTXO\'s block MTP + Relative Time.";
$placeholder['locktypevalue']['blockheight'] = 'Relative height must be integer.';
$placeholder['locktypevalue']['blockheight_extra'] = "";

include_once("html_iframe_header.php");
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
	try {
		
		$lockTimeObject = new Locktime();
		$networkClass   = $_POST['network'];
		Bitcoin::setNetwork(NetworkFactory::$networkClass());
		$publicKeyFactory = new PublicKeyFactory();
		
		if ($_POST['lock_type'] == 'timestamp') {
			$lockTypeValue = (int)$_POST['lock_type_value'];
			
			//enable granularity of 512 seconds
			$lockTypeValue = TransactionInputInterface::SEQUENCE_LOCKTIME_TYPE_FLAG | $lockTypeValue;
		} else if($_POST['lock_type'] == 'blockheight') {
			$lockTypeValue = (int)$_POST['lock_type_value'];
		} else {
			throw new Exception('Please choose either Relative Time or Relative Height.');
		}
		
		$opcodes = new Opcodes();
		
		if ($lockTypeValue &gt;= 1 AND $lockTypeValue &lt;= 16) {
			$opCodeName = "OP_{$lockTypeValue}";
			$locktimev = $opcodes-&gt;getOpByName($opCodeName);
			$isRelativeTime = false;
		} else {
			$lockTimeInt = (Buffer::int($lockTypeValue));
			$locktimev = $lockTimeInt-&gt;flip();
			$isRelativeTime = ($lockTimeInt-&gt;getInt() &gt;&gt; 22 &amp; 0x1);
		}
		
		
		$publicKey = $publicKeyFactory-&gt;fromHex($_POST['public_key']);
		
		$redeemScript = ScriptFactory::sequence([$locktimev, Opcodes::OP_CHECKSEQUENCEVERIFY,Opcodes::OP_DROP, Opcodes::OP_DUP, Opcodes::OP_HASH160, $publicKey-&gt;getPubKeyHash(), Opcodes::OP_EQUALVERIFY, Opcodes::OP_CHECKSIG]);
		
		
		$p2sh = new ScriptHashAddress($redeemScript-&gt;getScriptHash());
	
	?&gt;
		&lt;div class="table-responsive"&gt;
			&lt;table border=0 class='table'&gt;
				&lt;tr style='background-color:#f0f0f0'&gt;&lt;td&gt;Base58 address&lt;/td&gt;&lt;td&gt;&lt;?php echo $p2sh-&gt;getAddress();?&gt;&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;Redeem Script Hex &lt;/td&gt;&lt;td&gt;&lt;?php echo $redeemScript-&gt;getHex();?&gt;&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;Redeem Script Asm&lt;/td&gt;
					&lt;td&gt;
						&lt;?php 
						$opcodes = $redeemScript-&gt;getOpcodes();
						foreach( $redeemScript-&gt;getScriptParser()-&gt;decode() as $operation ) {
							try {
								$op = $opcodes-&gt;getOp($operation-&gt;getOp());
							} catch (\RuntimeException $e) {
								$op = "";
							}
							
							echo $op ? $op . " " : "";
							
							if ($op != 'OP_0' AND $operation-&gt;isPush()) {
								$bytes = (int)ltrim($op, 'OP_PUSHDATA');
								$bytes = $bytes &gt; 0 ? $bytes : 1;
								
								$hexsize = Buffer::int($operation-&gt;getDataSize(), $bytes)-&gt;getHex();
								echo htmlentities("{$hexsize}&lt;{$operation-&gt;getData()-&gt;getHex()}&gt; ");
							} 
						}
						?&gt;
					&lt;/td&gt;
				&lt;/tr&gt;
				
				&lt;tr style='background-color:#f0f0f0'&gt;&lt;td&gt;Lock Type&lt;/td&gt;&lt;td&gt;Relative &lt;?php echo !$isRelativeTime ? "Height" : "Time"  ?&gt;&lt;/td&gt;&lt;/tr&gt;
				
				
				
				&lt;tr&gt;&lt;td&gt;ScriptPubKey Hex &lt;/td&gt;&lt;td&gt;&lt;?php echo $p2sh-&gt;getScriptPubKey()-&gt;getHex()?&gt;&lt;/td&gt;&lt;/tr&gt;
				&lt;tr&gt;&lt;td&gt;ScriptPubKey Asm&lt;/td&gt;
					&lt;td&gt;
						&lt;?php 
						
						$opcodes = $redeemScript-&gt;getOpcodes();
						
						foreach( $p2sh-&gt;getScriptPubKey()-&gt;getScriptParser()-&gt;decode() as $operation ) {
							try {
								$op = $opcodes-&gt;getOp($operation-&gt;getOp());
							} catch (\RuntimeException $e) {
								$op = "";
							}
							
							echo $op ? $op . " " : "";
							
							if ($op != 'OP_0' AND $operation-&gt;isPush()) {
								$bytes = (int)ltrim($op, 'OP_PUSHDATA');
								$bytes = $bytes &gt; 0 ? $bytes : 1;
								
								$hexsize = Buffer::int($operation-&gt;getDataSize(), $bytes)-&gt;getHex();
								echo htmlentities("{$hexsize}&lt;{$operation-&gt;getData()-&gt;getHex()}&gt; ");
							} 
						}
						?&gt;
					&lt;/td&gt;
				&lt;/tr&gt;
			&lt;/table&gt;
		&lt;/div&gt;
&lt;?php 
	} catch (Exception $e) {
		$errmsg .= "Problem found. " . $e-&gt;getMessage();

	}
} 

if ($errmsg) {
?&gt;
	&lt;div class="alert alert-danger"&gt;
		&lt;strong&gt;Error!&lt;/strong&gt; &lt;?php echo $errmsg?&gt;
	&lt;/div&gt;
&lt;?php
}
?&gt;
&lt;form action='' method='post'&gt;
	&lt;div class="form-group"&gt;
		&lt;label for="network"&gt;Network:&lt;/label&gt; &lt;a href="../bitcoin/bitcoin_tool_mtp.php" target="_blank"&gt;Check Height &amp; Median Time Past (MTP).&lt;/a&gt;
		&lt;select id="network" name="network" class="form-control" &gt;
			&lt;?php
			$networks = get_class_methods(new NetworkFactory());
			foreach($networks as $network) {
				echo "&lt;option value='{$network}'".($network == $_POST['network'] ? " selected": "")."&gt;{$network}&lt;/option&gt;";
			}
			?&gt;
		&lt;/select&gt;
	&lt;/div&gt;
	&lt;div class="form-group"&gt;
		&lt;label for="public_key"&gt;Public Key Hex:&lt;/label&gt;
		&lt;input class="form-control" type='text' name='public_key' id='public_key' value='&lt;?php echo $_POST['public_key']?&gt;'&gt;
	&lt;/div&gt;
	
	&lt;div class="form-group"&gt;
		&lt;label&gt;Lock Type:&lt;/label&gt;
		
		&lt;div class="form-check form-check-inline"&gt;
			&lt;label class="form-check-label"&gt;
				&lt;input type="radio" class="form-check-input" name="lock_type" value="timestamp"&lt;?php echo $_POST['lock_type']=='timestamp' ? ' checked': ''?&gt; onclick="
				var self = $(this);
				var lockTypeValueE = $('#lock_type_value');
				var lockTypeExtraE = $('#lock_type_extra');
				lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['timestamp']?&gt;');				
				lockTypeExtraE.html('&lt;?php echo htmlentities($placeholder['locktypevalue']['timestamp_extra'],ENT_QUOTES)?&gt;');	
				"&gt;Relative Time
			&lt;/label&gt;
		&lt;/div&gt;
		&lt;div class="form-check form-check-inline"&gt;
			&lt;label class="form-check-label"&gt;
				&lt;input type="radio" class="form-check-input" name="lock_type" value="blockheight"&lt;?php echo $_POST['lock_type']=='blockheight' ? ' checked': ''?&gt; onclick="
				var self = $(this);
				var lockTypeValueE = $('#lock_type_value');
				var lockTypeExtraE = $('#lock_type_extra');
				lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['blockheight']?&gt;');				
				lockTypeExtraE.html('&lt;?php echo $placeholder['locktypevalue']['blockheight_extra']?&gt;');	
				"&gt;Relative Height
			&lt;/label&gt;
		&lt;/div&gt;
		
		&lt;input class="form-control" type='text' name='lock_type_value' id='lock_type_value' value='&lt;?php echo $_POST['lock_type_value']?&gt;' placeholder="&lt;?php echo $placeholder['locktypevalue'][ $_POST['lock_type']?$_POST['lock_type']:'default' ]?&gt;"&gt;
		
		&lt;span id='lock_type_extra'&gt;&lt;/span&gt;
	&lt;/div&gt;
	&lt;input type='submit' class="btn btn-success btn-block"/&gt;
&lt;/form&gt;
&lt;?php
include_once("html_iframe_footer.php");		</pre> 		
	</div>
</div>
<hr>


<h3 class="mt-3" id="hashtag2">Fund &amp; Spend P2SH.LOCKTIME</h3>

<ul class="nav nav-tabs">
	<li class="nav-item dropdown">
		<a class="nav-link dropdown-toggle active" data-toggle="dropdown" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#" role="button" aria-haspopup="true" aria-expanded="false">OP_CLTV Fund</a>
		<div class="dropdown-menu">
			<a data-toggle="tab" class="dropdown-item" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#form2_tabitem1">Visual</a>
			<a data-toggle="tab" class="dropdown-item" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#form2_tabitem2">Coding</a>
		</div>
	</li>
	
	<li class="nav-item dropdown">
		<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#" role="button" aria-haspopup="true" aria-expanded="false">OP_CLTV Spend</a>
		<div class="dropdown-menu">
			<a data-toggle="tab" class="dropdown-item" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#form2_tabitem3">Visual</a>
			<a data-toggle="tab" class="dropdown-item" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#form2_tabitem4">Coding</a>
		</div>
	</li>
	<li class="nav-item dropdown">
		<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#" role="button" aria-haspopup="true" aria-expanded="false">OP_CSV Fund</a>
		<div class="dropdown-menu">
			<a data-toggle="tab" class="dropdown-item" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#form2_tabitem5">Visual</a>
			<a data-toggle="tab" class="dropdown-item" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#form2_tabitem6">Coding</a>
		</div>
	</li>
	
	<li class="nav-item dropdown">
		<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#" role="button" aria-haspopup="true" aria-expanded="false">OP_CSV Spend</a>
		<div class="dropdown-menu">
			<a data-toggle="tab" class="dropdown-item" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#form2_tabitem7">Visual</a>
			<a data-toggle="tab" class="dropdown-item" href="https://www.btcschools.net/bitcoin/bitcoin_script_p2sh_locktime.php#form2_tabitem8">Coding</a>
		</div>
	</li>
</ul>
<div class="tab-content">
	<div id="form2_tabitem1" class="tab-pane fade show active">
		<iframe src="./Bitcoin P2SH.LOCKTIME_files/bitcoin_script_p2sh_cltv_fund.html" width="100%" scrolling="no" frameborder="no" id="iFrameResizer2" style="overflow: hidden; height: 264px;"></iframe>
	</div>
	<div id="form2_tabitem2" class="tab-pane fade">
		<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"></div><div class="enlighter-btn enlighter-btn-copy"></div><div class="enlighter-btn enlighter-btn-window"></div><div class="enlighter-btn enlighter-btn-website"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Network\NetworkFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Bitcoin;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Buffertools\Buffer;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Key\Factory\PrivateKeyFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Address\AddressCreator;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Address\Base58AddressInterface;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Transaction\Factory\TxBuilder;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Transaction\TransactionFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Transaction\TransactionOutput;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Transaction\Factory\Signer;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\ScriptFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\Classifier\OutputClassifier;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\ScriptType;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-text"> </span><span class="enlighter-s0">"../libraries/vendor/autoload.php"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"html_iframe_header.php"</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$noOfInputs</span><span class="enlighter-text"> = 10;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$noOfOutputs</span><span class="enlighter-text"> = 10;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$errmsg</span><span class="enlighter-text"> = </span><span class="enlighter-s0">''</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_SERVER</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'REQUEST_METHOD'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> == </span><span class="enlighter-s0">'POST'</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k1">try</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$networkClass</span><span class="enlighter-text">   = </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'network'</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        Bitcoin::</span><span class="enlighter-m0">setNetwork</span><span class="enlighter-g1">(</span><span class="enlighter-text">NetworkFactory::</span><span class="enlighter-k7">$networkClass</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$network</span><span class="enlighter-text">        = Bitcoin::</span><span class="enlighter-m0">getNetwork</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$ecAdapter</span><span class="enlighter-text">      = Bitcoin::</span><span class="enlighter-m0">getEcAdapter</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$privKeyFactory</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">PrivateKeyFactory</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$addrCreator</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">AddressCreator</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text"> = TransactionFactory::</span><span class="enlighter-m0">build</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$signItems</span><span class="enlighter-text"> = </span><span class="enlighter-g1">[]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">!</span><span class="enlighter-m0">is_numeric</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> OR !</span><span class="enlighter-m0">is_numeric</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">]))</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Error in 'no_of_inputs' or 'no_of_outputs'."</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Input</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$utxoHash</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"utxo_hash_{$thisInput}"</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$utxoNOutput</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"utxo_n_{$thisInput}"</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$privkeyhex</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"privkey_{$thisInput}"</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$utxoScript</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"utxo_script_{$thisInput}"</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-m0">strlen</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$utxoHash</span><span class="enlighter-g1">)&gt;</span><span class="enlighter-text">0 AND </span><span class="enlighter-m0">strlen</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$utxoNOutput</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> 0 AND </span><span class="enlighter-m0">strlen</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$privkeyhex</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> 0</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">input</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$utxoHash</span><span class="enlighter-text">, </span><span class="enlighter-k7">$utxoNOutput</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k7">$signItems</span><span class="enlighter-g1">[]</span><span class="enlighter-text"> = </span><span class="enlighter-g1">[</span><span class="enlighter-k7">$privkeyhex</span><span class="enlighter-text">, </span><span class="enlighter-k7">$utxoScript</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Error in 'input#{$thisInput}'."</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$address</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"address_{$thisOutput}"</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$amount</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"amount_{$thisOutput}"</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$recipient</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$addrCreator</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">fromString</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$address</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">!</span><span class="enlighter-m0">strlen</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$address</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-k3">or</span><span class="enlighter-text"> !</span><span class="enlighter-m0">strlen</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$amount</span><span class="enlighter-g1">))</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Error in 'output#{$thisOutput}'."</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">!</span><span class="enlighter-k7">$recipient</span><span class="enlighter-text"> </span><span class="enlighter-k0">instanceof</span><span class="enlighter-text"> Base58AddressInterface</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Invalid P2SH address in 'output#{$thisOutput}' (Check base58Address)."</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$decodeScript</span><span class="enlighter-text"> = </span><span class="enlighter-g1">(</span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">OutputClassifier</span><span class="enlighter-g1">())</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">decode</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$recipient</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScriptPubKey</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">!</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$decodeScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getType</span><span class="enlighter-g1">()</span><span class="enlighter-text"> == ScriptType::</span><span class="enlighter-m2">P2SH</span><span class="enlighter-text"> OR </span><span class="enlighter-k7">$decodeScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getType</span><span class="enlighter-g1">()</span><span class="enlighter-text"> == ScriptType::</span><span class="enlighter-m2">P2PKH</span><span class="enlighter-g1">))</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Invalid P2SH address in 'output#{$thisOutput}' (Check scriptPubKey)."</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">payToAddress</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$amount</span><span class="enlighter-text">, </span><span class="enlighter-k7">$recipient</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Tx = </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">get</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$signer</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Signer</span><span class="enlighter-g1">(</span><span class="enlighter-k9">$this</span><span class="enlighter-text">Tx, </span><span class="enlighter-k7">$ecAdapter</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$signItems</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k7">$nIn</span><span class="enlighter-text">=</span><span class="enlighter-g1">&gt;</span><span class="enlighter-k7">$signItem</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$privateKey</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$privKeyFactory</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">fromHexCompressed</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$signItem</span><span class="enlighter-g1">[</span><span class="enlighter-text">0</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$scriptPubKey</span><span class="enlighter-text"> = ScriptFactory::</span><span class="enlighter-m0">fromHex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$signItem</span><span class="enlighter-g1">[</span><span class="enlighter-text">1</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$txOutput</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">TransactionOutput</span><span class="enlighter-g1">(</span><span class="enlighter-text">0, </span><span class="enlighter-k7">$scriptPubKey</span><span class="enlighter-text"> </span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$signer</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$signer</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">sign</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$nIn</span><span class="enlighter-text">, </span><span class="enlighter-k7">$privateKey</span><span class="enlighter-text">, </span><span class="enlighter-k7">$txOutput</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">    ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"alert alert-success"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">h6 </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"mt-3"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Final TX Hex</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/h6</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">textarea </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> rows=</span><span class="enlighter-s0">"5"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"comment"</span><span class="enlighter-text"> readonly</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$signer</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">get</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text">;?</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/textarea</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">catch</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">Exception </span><span class="enlighter-k7">$e</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$errmsg</span><span class="enlighter-text"> .= </span><span class="enlighter-s0">"Problem found. "</span><span class="enlighter-text"> . </span><span class="enlighter-k7">$e</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getMessage</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$errmsg</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"alert alert-danger"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">strong</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Error!</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/strong</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$errmsg</span><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">form action=</span><span class="enlighter-s0">''</span><span class="enlighter-text"> method=</span><span class="enlighter-s0">'post'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"network"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Network: </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">select name=</span><span class="enlighter-s0">"network"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"network"</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$networks</span><span class="enlighter-text"> = </span><span class="enlighter-m0">get_class_methods</span><span class="enlighter-g1">(</span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">NetworkFactory</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$networks</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k7">$network</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;option value='{$network}'"</span><span class="enlighter-text">.</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$network</span><span class="enlighter-text"> == </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'network'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">" selected"</span><span class="enlighter-text">: </span><span class="enlighter-s0">""</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span><span class="enlighter-s0">"&gt;{$network}&lt;/option&gt;"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/select</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"row"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"col-sm-6"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-row"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"no_of_inputs"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Inputs: </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">select </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"no_of_inputs"</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-text"> style=</span><span class="enlighter-s0">'width:auto;'</span><span class="enlighter-text"> onchange=</span><span class="enlighter-s0">"</span></div></div><div class=""><div><span class="enlighter-s0">                    var self = $(this);</span></div></div><div class=""><div><span class="enlighter-s0">                    var thisvalue = self.val();</span></div></div><div class=""><div><span class="enlighter-s0">                    var form = self.closest('form');</span></div></div><div class=""><div><span class="enlighter-s0">                    $('div[id^=row_input_]',form).hide();</span></div></div><div class=""><div><span class="enlighter-s0">                    for(var i=1; i&lt;= thisvalue; i++) { </span></div></div><div class=""><div><span class="enlighter-s0">                        $('div[id=row_input_'+  i + ']',form).show();</span></div></div><div class=""><div><span class="enlighter-s0">                    }</span></div></div><div class=""><div><span class="enlighter-s0">                    "</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$noOfInputs</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Input</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;option value='{$thisInput}'"</span><span class="enlighter-text">.</span><span class="enlighter-g1">(</span><span class="enlighter-k9">$this</span><span class="enlighter-text">Input == </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">" selected"</span><span class="enlighter-text">: </span><span class="enlighter-s0">""</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span><span class="enlighter-s0">"&gt;{$thisInput}&lt;/option&gt;"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/select</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$selectedNInputs</span><span class="enlighter-text"> = </span><span class="enlighter-m0">is_numeric</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> ? </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> : 1;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$noOfInputs</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Input</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-row"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">'row_input_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> style=</span><span class="enlighter-s0">"&lt;?php echo ($thisInput &gt; $selectedNInputs) ? "</span><span class="enlighter-text">display:none</span><span class="enlighter-s0">" : "</span><span class="enlighter-text">display:;</span><span class="enlighter-s0">"?&gt;"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-1"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        #</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Input?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-3"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">"UTXO Tx Hash"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'UTXO Tx Hash'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'utxo_hash_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["utxo_hash_{$thisInput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-1"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">"UTXO N Output"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'N'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'utxo_n_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["utxo_n_{$thisInput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-3"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">"UTXO ScriptPubKey"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'UTXO ScriptPubKey'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'utxo_script_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["utxo_script_{$thisInput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-4"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">"Private Key Hex, for signing purpose."</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'Private Key Hex'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'privkey_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["privkey_{$thisInput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"col-sm-6"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-row"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"no_of_outputs"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Outputs:</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">select </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"no_of_outputs"</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-text"> style=</span><span class="enlighter-s0">'width:auto;'</span><span class="enlighter-text"> onchange=</span><span class="enlighter-s0">"</span></div></div><div class=""><div><span class="enlighter-s0">                    var self = $(this);</span></div></div><div class=""><div><span class="enlighter-s0">                    var thisvalue = self.val();</span></div></div><div class=""><div><span class="enlighter-s0">                    var form = self.closest('form');</span></div></div><div class=""><div><span class="enlighter-s0">                    $('div[id^=row_output_]',form).hide();</span></div></div><div class=""><div><span class="enlighter-s0">                    for(var i=1; i&lt;= thisvalue; i++) { </span></div></div><div class=""><div><span class="enlighter-s0">                        $('div[id=row_output_'+  i + ']',form).show();</span></div></div><div class=""><div><span class="enlighter-s0">                    }</span></div></div><div class=""><div><span class="enlighter-s0">                    "</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$noOfOutputs</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;option value='{$thisOutput}'"</span><span class="enlighter-text">.</span><span class="enlighter-g1">(</span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output == </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">" selected"</span><span class="enlighter-text">: </span><span class="enlighter-s0">""</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span><span class="enlighter-s0">"&gt;{$thisOutput}&lt;/option&gt;"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/select</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$selectedNOutputs</span><span class="enlighter-text"> = </span><span class="enlighter-m0">is_numeric</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> ? </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> : 1;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$noOfOutputs</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-row"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">'row_output_&lt;?php echo $thisOutput?&gt;'</span><span class="enlighter-text"> style=</span><span class="enlighter-s0">"&lt;?php echo ($thisOutput &gt; $selectedNOutputs) ? "</span><span class="enlighter-text">display:none</span><span class="enlighter-s0">" : "</span><span class="enlighter-text">display:;</span><span class="enlighter-s0">"?&gt;"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col-sm-1"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        #</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col-sm-6"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'P2SH Address'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'address_&lt;?php echo $thisOutput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["address_{$thisOutput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col-sm-5"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'Amount'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'amount_&lt;?php echo $thisOutput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["amount_{$thisOutput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input type=</span><span class="enlighter-s0">'submit'</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"btn btn-success btn-block"</span><span class="enlighter-text">/</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/form</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"html_iframe_footer.php"</span><span class="enlighter-g1">)</span><span class="enlighter-text">;        </span></div></div></div><pre class="enlighter-raw">&lt;?php 
use BitWasp\Bitcoin\Network\NetworkFactory;
use BitWasp\Bitcoin\Bitcoin;
use BitWasp\Buffertools\Buffer;
use BitWasp\Bitcoin\Key\Factory\PrivateKeyFactory;
use BitWasp\Bitcoin\Address\AddressCreator;
use BitWasp\Bitcoin\Address\Base58AddressInterface;
use BitWasp\Bitcoin\Transaction\Factory\TxBuilder;
use BitWasp\Bitcoin\Transaction\TransactionFactory;
use BitWasp\Bitcoin\Transaction\TransactionOutput;
use BitWasp\Bitcoin\Transaction\Factory\Signer;
use BitWasp\Bitcoin\Script\ScriptFactory;
use BitWasp\Bitcoin\Script\Classifier\OutputClassifier;
use BitWasp\Bitcoin\Script\ScriptType;

include_once "../libraries/vendor/autoload.php";
include_once("html_iframe_header.php");

$noOfInputs = 10;
$noOfOutputs = 10;
$errmsg = '';
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    try {
        $networkClass   = $_POST['network'];
        Bitcoin::setNetwork(NetworkFactory::$networkClass());
        
        $network        = Bitcoin::getNetwork();
        $ecAdapter      = Bitcoin::getEcAdapter();
        $privKeyFactory = new PrivateKeyFactory();
        
        $addrCreator = new AddressCreator();
        
        $spendTx = TransactionFactory::build();
        
        $signItems = [];
        
        
        if (!is_numeric($_POST['no_of_inputs']) OR !is_numeric($_POST['no_of_outputs'])) {
            throw new Exception("Error in 'no_of_inputs' or 'no_of_outputs'.");
        }
            
        foreach(range(1,$_POST['no_of_inputs']) as $thisInput) {
            $utxoHash = trim($_POST["utxo_hash_{$thisInput}"]);
            $utxoNOutput = trim($_POST["utxo_n_{$thisInput}"]);
            $privkeyhex = trim($_POST["privkey_{$thisInput}"]);
            $utxoScript = trim($_POST["utxo_script_{$thisInput}"]);
            
            if (strlen($utxoHash)&gt;0 AND strlen($utxoNOutput) &gt; 0 AND strlen($privkeyhex) &gt; 0) {
                $spendTx = $spendTx-&gt;input($utxoHash, $utxoNOutput);
                $signItems[] = [$privkeyhex, $utxoScript];
            } else {
                throw new Exception("Error in 'input#{$thisInput}'.");
            }
        }
        
        foreach(range(1,$_POST['no_of_outputs']) as $thisOutput) {
            
            $address = trim($_POST["address_{$thisOutput}"]);
            
            $amount = trim($_POST["amount_{$thisOutput}"]);
            $recipient = $addrCreator-&gt;fromString($address);
            
            if (!strlen($address) or !strlen($amount)) {
                throw new Exception("Error in 'output#{$thisOutput}'.");
            }
            
            if (!$recipient instanceof Base58AddressInterface) {
                throw new Exception("Invalid P2SH address in 'output#{$thisOutput}' (Check base58Address).");
            } 
            
            $decodeScript = (new OutputClassifier())-&gt;decode($recipient-&gt;getScriptPubKey());
            
            if (!($decodeScript-&gt;getType() == ScriptType::P2SH OR $decodeScript-&gt;getType() == ScriptType::P2PKH)) {
                throw new Exception("Invalid P2SH address in 'output#{$thisOutput}' (Check scriptPubKey).");
            }
            
            $spendTx = $spendTx-&gt;payToAddress($amount, $recipient);
            
        }
        
        
        $thisTx = $spendTx-&gt;get();
        
        $signer = new Signer($thisTx, $ecAdapter);
        
        foreach($signItems as $nIn=&gt;$signItem) {
            $privateKey = $privKeyFactory-&gt;fromHexCompressed($signItem[0]);
            
            $scriptPubKey = ScriptFactory::fromHex($signItem[1]);
            
            $txOutput = new TransactionOutput(0, $scriptPubKey );
            $signer = $signer-&gt;sign($nIn, $privateKey, $txOutput);
        }
        
    ?&gt;
        &lt;div class="alert alert-success"&gt;
            &lt;h6 class="mt-3"&gt;Final TX Hex&lt;/h6&gt;
            
            &lt;textarea class="form-control" rows="5" id="comment" readonly&gt;&lt;?php echo $signer-&gt;get()-&gt;getHex();?&gt;&lt;/textarea&gt;
        &lt;/div&gt;
    &lt;?php
    
    } catch (Exception $e) {
        $errmsg .= "Problem found. " . $e-&gt;getMessage();

    }
}

if ($errmsg) {
?&gt;
    &lt;div class="alert alert-danger"&gt;
        &lt;strong&gt;Error!&lt;/strong&gt; &lt;?php echo $errmsg?&gt;
    &lt;/div&gt;
&lt;?php
}
?&gt;
&lt;form action='' method='post'&gt;
    &lt;div class="form-group"&gt;
        &lt;label for="network"&gt;Network: &lt;/label&gt;
        &lt;select name="network" id="network" class="form-control"&gt;
            &lt;?php
            $networks = get_class_methods(new NetworkFactory());
            foreach($networks as $network) {
                echo "&lt;option value='{$network}'".($network == $_POST['network'] ? " selected": "")."&gt;{$network}&lt;/option&gt;";
            }
            ?&gt;
        &lt;/select&gt;
    &lt;/div&gt;
    
    &lt;div class="row"&gt;
        &lt;div class="col-sm-6"&gt;
            
            &lt;div class="form-row"&gt;
                &lt;div class="form-group col"&gt;
                    &lt;label for="no_of_inputs"&gt;Inputs: &lt;/label&gt; 
                    &lt;select class="form-control" id="no_of_inputs" name='no_of_inputs' style='width:auto;' onchange="
                    var self = $(this);
                    var thisvalue = self.val();
                    var form = self.closest('form');
                    $('div[id^=row_input_]',form).hide();
                    for(var i=1; i&lt;= thisvalue; i++) { 
                        $('div[id=row_input_'+  i + ']',form).show();
                    }
                    "&gt;
                        &lt;?php
                        foreach(range(1,$noOfInputs) as $thisInput) {
                            echo "&lt;option value='{$thisInput}'".($thisInput == $_POST['no_of_inputs'] ? " selected": "")."&gt;{$thisInput}&lt;/option&gt;";
                        }
                        ?&gt;
                    &lt;/select&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            
            &lt;?php
            $selectedNInputs = is_numeric($_POST['no_of_inputs']) ? $_POST['no_of_inputs'] : 1;
            
            foreach(range(1,$noOfInputs) as $thisInput) {
            ?&gt;
            
                &lt;div class="form-row" id='row_input_&lt;?php echo $thisInput?&gt;' style="&lt;?php echo ($thisInput &gt; $selectedNInputs) ? "display:none" : "display:;"?&gt;"&gt;
                
                    &lt;div class="form-group  col-sm-1"&gt;
                        #&lt;?php echo $thisInput?&gt; 
                    &lt;/div&gt;
                    &lt;div class="form-group  col-sm-3"&gt;
                        
                        &lt;input class="form-control" title="UTXO Tx Hash" placeholder='UTXO Tx Hash' type='text' name='utxo_hash_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_hash_{$thisInput}"]?&gt;'&gt;
                    &lt;/div&gt;
                    &lt;div class="form-group  col-sm-1"&gt;
                        &lt;input class="form-control" title="UTXO N Output" placeholder='N' type='text' name='utxo_n_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_n_{$thisInput}"]?&gt;'&gt;
                    &lt;/div&gt;
                    
                    &lt;div class="form-group  col-sm-3"&gt;
                        &lt;input class="form-control" title="UTXO ScriptPubKey" placeholder='UTXO ScriptPubKey' type='text' name='utxo_script_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_script_{$thisInput}"]?&gt;'&gt;
                    &lt;/div&gt;
                    &lt;div class="form-group  col-sm-4"&gt;
                        &lt;input class="form-control" title="Private Key Hex, for signing purpose." placeholder='Private Key Hex' type='text' name='privkey_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["privkey_{$thisInput}"]?&gt;'&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;?php
            }
            ?&gt;
        &lt;/div&gt;
        &lt;div class="col-sm-6"&gt;
            &lt;div class="form-row"&gt;
                &lt;div class="form-group col"&gt;
                    &lt;label for="no_of_outputs"&gt;Outputs:&lt;/label&gt; &lt;select class="form-control" id="no_of_outputs" name='no_of_outputs' style='width:auto;' onchange="
                    var self = $(this);
                    var thisvalue = self.val();
                    var form = self.closest('form');
                    $('div[id^=row_output_]',form).hide();
                    for(var i=1; i&lt;= thisvalue; i++) { 
                        $('div[id=row_output_'+  i + ']',form).show();
                    }
                    "&gt;
                        &lt;?php
                        foreach(range(1,$noOfOutputs) as $thisOutput) {
                            echo "&lt;option value='{$thisOutput}'".($thisOutput == $_POST['no_of_outputs'] ? " selected": "")."&gt;{$thisOutput}&lt;/option&gt;";
                        }
                        ?&gt;
                    &lt;/select&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;?php
            $selectedNOutputs = is_numeric($_POST['no_of_outputs']) ? $_POST['no_of_outputs'] : 1;

            foreach(range(1,$noOfOutputs) as $thisOutput) {
            ?&gt;
                &lt;div class="form-row" id='row_output_&lt;?php echo $thisOutput?&gt;' style="&lt;?php echo ($thisOutput &gt; $selectedNOutputs) ? "display:none" : "display:;"?&gt;"&gt;
                    &lt;div class="form-group col-sm-1"&gt;
                        #&lt;?php echo $thisOutput?&gt; 
                    &lt;/div&gt;
                    
                    &lt;div class="form-group col-sm-6"&gt;
                        &lt;input class="form-control" placeholder='P2SH Address' type='text' name='address_&lt;?php echo $thisOutput?&gt;' value='&lt;?php echo $_POST["address_{$thisOutput}"]?&gt;'&gt;
                    &lt;/div&gt;
                    &lt;div class="form-group col-sm-5"&gt;
                        &lt;input class="form-control" placeholder='Amount' type='text' name='amount_&lt;?php echo $thisOutput?&gt;' value='&lt;?php echo $_POST["amount_{$thisOutput}"]?&gt;'&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
    &lt;?php
            }
    ?&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    
    &lt;input type='submit' class="btn btn-success btn-block"/&gt;
&lt;/form&gt;
&lt;?php
include_once("html_iframe_footer.php");        </pre></div><pre style="border-radius:none;" class="enlighter-origin">&lt;?php 
use BitWasp\Bitcoin\Network\NetworkFactory;
use BitWasp\Bitcoin\Bitcoin;
use BitWasp\Buffertools\Buffer;
use BitWasp\Bitcoin\Key\Factory\PrivateKeyFactory;
use BitWasp\Bitcoin\Address\AddressCreator;
use BitWasp\Bitcoin\Address\Base58AddressInterface;
use BitWasp\Bitcoin\Transaction\Factory\TxBuilder;
use BitWasp\Bitcoin\Transaction\TransactionFactory;
use BitWasp\Bitcoin\Transaction\TransactionOutput;
use BitWasp\Bitcoin\Transaction\Factory\Signer;
use BitWasp\Bitcoin\Script\ScriptFactory;
use BitWasp\Bitcoin\Script\Classifier\OutputClassifier;
use BitWasp\Bitcoin\Script\ScriptType;

include_once "../libraries/vendor/autoload.php";
include_once("html_iframe_header.php");

$noOfInputs = 10;
$noOfOutputs = 10;
$errmsg = '';
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
	try {
		$networkClass   = $_POST['network'];
		Bitcoin::setNetwork(NetworkFactory::$networkClass());
		
		$network        = Bitcoin::getNetwork();
		$ecAdapter      = Bitcoin::getEcAdapter();
		$privKeyFactory = new PrivateKeyFactory();
		
		$addrCreator = new AddressCreator();
		
		$spendTx = TransactionFactory::build();
		
		$signItems = [];
		
		
		if (!is_numeric($_POST['no_of_inputs']) OR !is_numeric($_POST['no_of_outputs'])) {
			throw new Exception("Error in 'no_of_inputs' or 'no_of_outputs'.");
		}
			
		foreach(range(1,$_POST['no_of_inputs']) as $thisInput) {
			$utxoHash = trim($_POST["utxo_hash_{$thisInput}"]);
			$utxoNOutput = trim($_POST["utxo_n_{$thisInput}"]);
			$privkeyhex = trim($_POST["privkey_{$thisInput}"]);
			$utxoScript = trim($_POST["utxo_script_{$thisInput}"]);
			
			if (strlen($utxoHash)&gt;0 AND strlen($utxoNOutput) &gt; 0 AND strlen($privkeyhex) &gt; 0) {
				$spendTx = $spendTx-&gt;input($utxoHash, $utxoNOutput);
				$signItems[] = [$privkeyhex, $utxoScript];
			} else {
				throw new Exception("Error in 'input#{$thisInput}'.");
			}
		}
		
		foreach(range(1,$_POST['no_of_outputs']) as $thisOutput) {
			
			$address = trim($_POST["address_{$thisOutput}"]);
			
			$amount = trim($_POST["amount_{$thisOutput}"]);
			$recipient = $addrCreator-&gt;fromString($address);
			
			if (!strlen($address) or !strlen($amount)) {
				throw new Exception("Error in 'output#{$thisOutput}'.");
			}
			
			if (!$recipient instanceof Base58AddressInterface) {
				throw new Exception("Invalid P2SH address in 'output#{$thisOutput}' (Check base58Address).");
			} 
			
			$decodeScript = (new OutputClassifier())-&gt;decode($recipient-&gt;getScriptPubKey());
			
			if (!($decodeScript-&gt;getType() == ScriptType::P2SH OR $decodeScript-&gt;getType() == ScriptType::P2PKH)) {
				throw new Exception("Invalid P2SH address in 'output#{$thisOutput}' (Check scriptPubKey).");
			}
			
			$spendTx = $spendTx-&gt;payToAddress($amount, $recipient);
			
		}
		
		
		$thisTx = $spendTx-&gt;get();
		
		$signer = new Signer($thisTx, $ecAdapter);
		
		foreach($signItems as $nIn=&gt;$signItem) {
			$privateKey = $privKeyFactory-&gt;fromHexCompressed($signItem[0]);
			
			$scriptPubKey = ScriptFactory::fromHex($signItem[1]);
			
			$txOutput = new TransactionOutput(0, $scriptPubKey );
			$signer = $signer-&gt;sign($nIn, $privateKey, $txOutput);
		}
		
	?&gt;
		&lt;div class="alert alert-success"&gt;
			&lt;h6 class="mt-3"&gt;Final TX Hex&lt;/h6&gt;
			
			&lt;textarea class="form-control" rows="5" id="comment" readonly&gt;&lt;?php echo $signer-&gt;get()-&gt;getHex();?&gt;&lt;/textarea&gt;
		&lt;/div&gt;
	&lt;?php
	
	} catch (Exception $e) {
		$errmsg .= "Problem found. " . $e-&gt;getMessage();

	}
}

if ($errmsg) {
?&gt;
	&lt;div class="alert alert-danger"&gt;
		&lt;strong&gt;Error!&lt;/strong&gt; &lt;?php echo $errmsg?&gt;
	&lt;/div&gt;
&lt;?php
}
?&gt;
&lt;form action='' method='post'&gt;
	&lt;div class="form-group"&gt;
		&lt;label for="network"&gt;Network: &lt;/label&gt;
		&lt;select name="network" id="network" class="form-control"&gt;
			&lt;?php
			$networks = get_class_methods(new NetworkFactory());
			foreach($networks as $network) {
				echo "&lt;option value='{$network}'".($network == $_POST['network'] ? " selected": "")."&gt;{$network}&lt;/option&gt;";
			}
			?&gt;
		&lt;/select&gt;
	&lt;/div&gt;
	
	&lt;div class="row"&gt;
		&lt;div class="col-sm-6"&gt;
			
			&lt;div class="form-row"&gt;
				&lt;div class="form-group col"&gt;
					&lt;label for="no_of_inputs"&gt;Inputs: &lt;/label&gt; 
					&lt;select class="form-control" id="no_of_inputs" name='no_of_inputs' style='width:auto;' onchange="
					var self = $(this);
					var thisvalue = self.val();
					var form = self.closest('form');
					$('div[id^=row_input_]',form).hide();
					for(var i=1; i&lt;= thisvalue; i++) { 
						$('div[id=row_input_'+  i + ']',form).show();
					}
					"&gt;
						&lt;?php
						foreach(range(1,$noOfInputs) as $thisInput) {
							echo "&lt;option value='{$thisInput}'".($thisInput == $_POST['no_of_inputs'] ? " selected": "")."&gt;{$thisInput}&lt;/option&gt;";
						}
						?&gt;
					&lt;/select&gt;
				&lt;/div&gt;
			&lt;/div&gt;
			
			&lt;?php
			$selectedNInputs = is_numeric($_POST['no_of_inputs']) ? $_POST['no_of_inputs'] : 1;
			
			foreach(range(1,$noOfInputs) as $thisInput) {
			?&gt;
			
				&lt;div class="form-row" id='row_input_&lt;?php echo $thisInput?&gt;' style="&lt;?php echo ($thisInput &gt; $selectedNInputs) ? "display:none" : "display:;"?&gt;"&gt;
				
					&lt;div class="form-group  col-sm-1"&gt;
						#&lt;?php echo $thisInput?&gt; 
					&lt;/div&gt;
					&lt;div class="form-group  col-sm-3"&gt;
						
						&lt;input class="form-control" title="UTXO Tx Hash" placeholder='UTXO Tx Hash' type='text' name='utxo_hash_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_hash_{$thisInput}"]?&gt;'&gt;
					&lt;/div&gt;
					&lt;div class="form-group  col-sm-1"&gt;
						&lt;input class="form-control" title="UTXO N Output" placeholder='N' type='text' name='utxo_n_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_n_{$thisInput}"]?&gt;'&gt;
					&lt;/div&gt;
					
					&lt;div class="form-group  col-sm-3"&gt;
						&lt;input class="form-control" title="UTXO ScriptPubKey" placeholder='UTXO ScriptPubKey' type='text' name='utxo_script_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_script_{$thisInput}"]?&gt;'&gt;
					&lt;/div&gt;
					&lt;div class="form-group  col-sm-4"&gt;
						&lt;input class="form-control" title="Private Key Hex, for signing purpose." placeholder='Private Key Hex' type='text' name='privkey_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["privkey_{$thisInput}"]?&gt;'&gt;
					&lt;/div&gt;
				&lt;/div&gt;
			&lt;?php
			}
			?&gt;
		&lt;/div&gt;
		&lt;div class="col-sm-6"&gt;
			&lt;div class="form-row"&gt;
				&lt;div class="form-group col"&gt;
					&lt;label for="no_of_outputs"&gt;Outputs:&lt;/label&gt; &lt;select class="form-control" id="no_of_outputs" name='no_of_outputs' style='width:auto;' onchange="
					var self = $(this);
					var thisvalue = self.val();
					var form = self.closest('form');
					$('div[id^=row_output_]',form).hide();
					for(var i=1; i&lt;= thisvalue; i++) { 
						$('div[id=row_output_'+  i + ']',form).show();
					}
					"&gt;
						&lt;?php
						foreach(range(1,$noOfOutputs) as $thisOutput) {
							echo "&lt;option value='{$thisOutput}'".($thisOutput == $_POST['no_of_outputs'] ? " selected": "")."&gt;{$thisOutput}&lt;/option&gt;";
						}
						?&gt;
					&lt;/select&gt;
				&lt;/div&gt;
			&lt;/div&gt;
			&lt;?php
			$selectedNOutputs = is_numeric($_POST['no_of_outputs']) ? $_POST['no_of_outputs'] : 1;

			foreach(range(1,$noOfOutputs) as $thisOutput) {
			?&gt;
				&lt;div class="form-row" id='row_output_&lt;?php echo $thisOutput?&gt;' style="&lt;?php echo ($thisOutput &gt; $selectedNOutputs) ? "display:none" : "display:;"?&gt;"&gt;
					&lt;div class="form-group col-sm-1"&gt;
						#&lt;?php echo $thisOutput?&gt; 
					&lt;/div&gt;
					
					&lt;div class="form-group col-sm-6"&gt;
						&lt;input class="form-control" placeholder='P2SH Address' type='text' name='address_&lt;?php echo $thisOutput?&gt;' value='&lt;?php echo $_POST["address_{$thisOutput}"]?&gt;'&gt;
					&lt;/div&gt;
					&lt;div class="form-group col-sm-5"&gt;
						&lt;input class="form-control" placeholder='Amount' type='text' name='amount_&lt;?php echo $thisOutput?&gt;' value='&lt;?php echo $_POST["amount_{$thisOutput}"]?&gt;'&gt;
					&lt;/div&gt;
				&lt;/div&gt;
	&lt;?php
			}
	?&gt;
		&lt;/div&gt;
	&lt;/div&gt;
	
	&lt;input type='submit' class="btn btn-success btn-block"/&gt;
&lt;/form&gt;
&lt;?php
include_once("html_iframe_footer.php");		</pre> 
	</div>
	
	<div id="form2_tabitem3" class="tab-pane fade">
		<iframe src="./Bitcoin P2SH.LOCKTIME_files/bitcoin_script_p2sh_cltv_spend.html" width="100%" scrolling="no" frameborder="no" id="iFrameResizer3" style="overflow: hidden; height: 0px;"></iframe>
	</div>
	<div id="form2_tabitem4" class="tab-pane fade">
		<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"></div><div class="enlighter-btn enlighter-btn-copy"></div><div class="enlighter-btn enlighter-btn-window"></div><div class="enlighter-btn enlighter-btn-website"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Buffertools\Buffer;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Network\NetworkFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Address\AddressCreator;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Address\PayToPubKeyHashAddress;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Bitcoin;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Key\Factory\PrivateKeyFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Transaction\Factory\Signer;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Transaction\Factory\SignData;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Transaction\TransactionFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Transaction\TransactionOutput;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\Classifier\OutputClassifier;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\ScriptType;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\ScriptFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\P2shScript;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Signature\TransactionSignature;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-text"> </span><span class="enlighter-s0">"../libraries/vendor/autoload.php"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$noOfInputs</span><span class="enlighter-text"> = 10;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$noOfOutputs</span><span class="enlighter-text"> = 10;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$placeholder</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'locktypevalue'</span><span class="enlighter-g1">][</span><span class="enlighter-s0">'default'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> = </span><span class="enlighter-s0">'Please choose either Datetime or block height.'</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$placeholder</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'locktypevalue'</span><span class="enlighter-g1">][</span><span class="enlighter-s0">'timestamp'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> = </span><span class="enlighter-s0">'Accept only format YYYY-MM-DD HH:MM:SS.'</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$placeholder</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'locktypevalue'</span><span class="enlighter-g1">][</span><span class="enlighter-s0">'blockheight'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> = </span><span class="enlighter-s0">'Block height must be integer.'</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"html_iframe_header.php"</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">'vertical-line-yellow'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">h6 </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"mt-3"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">To success spend of OP_CLTV, following requirements must meet:</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/h6</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">ul</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">li</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">nLocktime is required</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/li</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">li</span><span class="enlighter-g1">&gt;</span><span class="enlighter-k1">if</span><span class="enlighter-text"> nLockTime typed datetime detected, then value must satisfy </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text"> chain</span><span class="enlighter-s0">'s MTP.&lt;/li&gt;</span></div></div><div class=""><div><span class="enlighter-s0">        &lt;li&gt;if nLockTime typed block height detected, then value must satisfy &lt; chain'</span><span class="enlighter-text">s block height + </span><span class="enlighter-n0">1.</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/li</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">li</span><span class="enlighter-g1">&gt;</span><span class="enlighter-k1">if</span><span class="enlighter-text"> OP_CLTV detected, then its time parameter must satisfy </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">= nLockTime.</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/li</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">li</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">At least one input</span><span class="enlighter-s0">'s nSequence must set lower than max value #FFFFFFFF to enable nLockTime.&lt;/li&gt;</span></div></div><div class=""><div><span class="enlighter-s0">    &lt;/ul&gt;</span></div></div><div class=""><div><span class="enlighter-s0">&lt;/div&gt;</span></div></div><div class=""><div><span class="enlighter-s0">&lt;?php</span></div></div><div class=""><div><span class="enlighter-s0">if ($_SERVER['</span><span class="enlighter-text">REQUEST_METHOD</span><span class="enlighter-s0">'] == '</span><span class="enlighter-text">POST</span><span class="enlighter-s0">') {</span></div></div><div class=""><div><span class="enlighter-s0">    </span></div></div><div class=""><div><span class="enlighter-s0">    try {</span></div></div><div class=""><div><span class="enlighter-s0">        $networkClass   = $_POST['</span><span class="enlighter-text">network</span><span class="enlighter-s0">'];</span></div></div><div class=""><div><span class="enlighter-s0">        Bitcoin::setNetwork(NetworkFactory::$networkClass());</span></div></div><div class=""><div><span class="enlighter-s0">        </span></div></div><div class=""><div><span class="enlighter-s0">        $network        = Bitcoin::getNetwork();</span></div></div><div class=""><div><span class="enlighter-s0">        $ecAdapter      = Bitcoin::getEcAdapter();</span></div></div><div class=""><div><span class="enlighter-s0">        $privKeyFactory = new PrivateKeyFactory();</span></div></div><div class=""><div><span class="enlighter-s0">        </span></div></div><div class=""><div><span class="enlighter-s0">        $addrCreator = new AddressCreator();</span></div></div><div class=""><div><span class="enlighter-s0">        </span></div></div><div class=""><div><span class="enlighter-s0">        $spendTx = TransactionFactory::build();</span></div></div><div class=""><div><span class="enlighter-s0">        </span></div></div><div class=""><div><span class="enlighter-s0">        $signItems = [];</span></div></div><div class=""><div><span class="enlighter-s0">        </span></div></div><div class=""><div><span class="enlighter-s0">        if (!strlen($_POST['</span><span class="enlighter-text">utx</span><span class="enlighter-s0">']) or !ctype_xdigit($_POST['</span><span class="enlighter-text">utx</span><span class="enlighter-s0">'])) {                    </span></div></div><div class=""><div><span class="enlighter-s0">            throw new Exception("UTX must be hex.");</span></div></div><div class=""><div><span class="enlighter-s0">        } </span></div></div><div class=""><div><span class="enlighter-s0">        </span></div></div><div class=""><div><span class="enlighter-s0">        if (!is_numeric($_POST['</span><span class="enlighter-text">no_of_inputs</span><span class="enlighter-s0">']) OR !is_numeric($_POST['</span><span class="enlighter-text">no_of_outputs</span><span class="enlighter-s0">'])) {</span></div></div><div class=""><div><span class="enlighter-s0">            throw new Exception("Error in '</span><span class="enlighter-text">no_of_inputs</span><span class="enlighter-s0">' or '</span><span class="enlighter-text">no_of_outputs</span><span class="enlighter-s0">'.");</span></div></div><div class=""><div><span class="enlighter-s0">        }</span></div></div><div class=""><div><span class="enlighter-s0">        </span></div></div><div class=""><div><span class="enlighter-s0">        $utxHex = $_POST['</span><span class="enlighter-text">utx</span><span class="enlighter-s0">'];</span></div></div><div class=""><div><span class="enlighter-s0">        $utx = TransactionFactory::fromHex($utxHex);    </span></div></div><div class=""><div><span class="enlighter-s0">        $utxos = $utx-&gt;getOutputs();</span></div></div><div class=""><div><span class="enlighter-s0">        </span></div></div><div class=""><div><span class="enlighter-s0">        //any input'</span><span class="enlighter-text">s nSequence set lesser than max value #</span><span class="enlighter-m0">ffffffff</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">32-bits</span><span class="enlighter-g1">)</span><span class="enlighter-text"> will enable nLockTime field.</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$sequence</span><span class="enlighter-text"> = 0;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$utxos</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k7">$k</span><span class="enlighter-text">=</span><span class="enlighter-g1">&gt;</span><span class="enlighter-k7">$utxo</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$privateKey</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$privKeyFactory</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">fromHexCompressed</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"privkey_"</span><span class="enlighter-text"> . </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$k</span><span class="enlighter-text">+1</span><span class="enlighter-g1">)])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$utxoScript</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$utxo</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScript</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"redeemscript_"</span><span class="enlighter-text"> . </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$k</span><span class="enlighter-text">+1</span><span class="enlighter-g1">)])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">P2shScript</span><span class="enlighter-g1">(</span><span class="enlighter-text">ScriptFactory::</span><span class="enlighter-m0">fromHex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-g1">))</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$p2shScriptPubKey</span><span class="enlighter-text"> = ScriptFactory::</span><span class="enlighter-m0">scriptPubKey</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">p2sh</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScriptHash</span><span class="enlighter-g1">()</span><span class="enlighter-c1">/*sha256*/</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$utxoScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text"> != </span><span class="enlighter-k7">$p2shScriptPubKey</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">())</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Error in 'input#{$k}'. Redeem script is not matched to UTXO's ScriptPubKey."</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$signData</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">SignData</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$signData</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">p2sh</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$signItems</span><span class="enlighter-g1">[]</span><span class="enlighter-text"> = </span><span class="enlighter-g1">[</span><span class="enlighter-text"> </span><span class="enlighter-k7">$privateKey</span><span class="enlighter-text">, </span><span class="enlighter-k7">$signData</span><span class="enlighter-text"> </span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">spendOutputFrom</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$utx</span><span class="enlighter-text">, </span><span class="enlighter-k7">$k</span><span class="enlighter-text">, </span><span class="enlighter-e1">null</span><span class="enlighter-text">, </span><span class="enlighter-k7">$sequence</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'lock_type'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> == </span><span class="enlighter-s0">'timestamp'</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$nlocktime</span><span class="enlighter-text"> = </span><span class="enlighter-m0">strtotime</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'nlocktime'</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-k1">if</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'lock_type'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> == </span><span class="enlighter-s0">'blockheight'</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$nlocktime</span><span class="enlighter-text"> = </span><span class="enlighter-g1">(</span><span class="enlighter-k5">int</span><span class="enlighter-g1">)</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'nlocktime'</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">'Please choose either Datetime or block height.'</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">locktime</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$nlocktime</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span><span class="enlighter-c0"> //set nlocktime at transaction level</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$address</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"address_{$thisOutput}"</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$amount</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"amount_{$thisOutput}"</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-m0">strlen</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$address</span><span class="enlighter-g1">)&gt;</span><span class="enlighter-text">0 AND </span><span class="enlighter-m0">strlen</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$amount</span><span class="enlighter-g1">)&gt;</span><span class="enlighter-text">0</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k7">$recipient</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$addrCreator</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">fromString</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$address</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">payToAddress</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$amount</span><span class="enlighter-text">, </span><span class="enlighter-k7">$recipient</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Error in 'output#{$thisOutput}'."</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Tx = </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">get</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$finalTx</span><span class="enlighter-text"> = TransactionFactory::</span><span class="enlighter-m0">mutate</span><span class="enlighter-g1">(</span><span class="enlighter-k9">$this</span><span class="enlighter-text">Tx</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$mutable</span><span class="enlighter-text"> = TransactionFactory::</span><span class="enlighter-m0">mutate</span><span class="enlighter-g1">(</span><span class="enlighter-k9">$this</span><span class="enlighter-text">Tx</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$sigHashType</span><span class="enlighter-text"> = 1;</span><span class="enlighter-c0"> //ALL</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$signItems</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k7">$nIn</span><span class="enlighter-text">=</span><span class="enlighter-g1">&gt;</span><span class="enlighter-k7">$signItem</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$privateKey</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$signItem</span><span class="enlighter-g1">[</span><span class="enlighter-text">0</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$signData</span><span class="enlighter-text">   = </span><span class="enlighter-k7">$signItem</span><span class="enlighter-g1">[</span><span class="enlighter-text">1</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$input</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$mutable</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">inputsMutator</span><span class="enlighter-g1">()[</span><span class="enlighter-k7">$nIn</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$input</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">script</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$signData</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getRedeemScript</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$finalSignData</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$mutable</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">done</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text"> .  </span><span class="enlighter-m0">bin2hex</span><span class="enlighter-g1">(</span><span class="enlighter-m0">pack</span><span class="enlighter-g1">(</span><span class="enlighter-s0">'V'</span><span class="enlighter-text">, </span><span class="enlighter-k7">$sigHashType</span><span class="enlighter-g1">))</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$finalSignData</span><span class="enlighter-text"> = </span><span class="enlighter-m0">hash</span><span class="enlighter-g1">(</span><span class="enlighter-s0">'sha256'</span><span class="enlighter-text">, </span><span class="enlighter-m0">hex2bin</span><span class="enlighter-g1">(</span><span class="enlighter-m0">hash</span><span class="enlighter-g1">(</span><span class="enlighter-s0">'sha256'</span><span class="enlighter-text">, </span><span class="enlighter-m0">hex2bin</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$finalSignData</span><span class="enlighter-g1">))))</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$txSig</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">TransactionSignature</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$ecAdapter</span><span class="enlighter-text">, </span><span class="enlighter-k7">$privateKey</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">sign</span><span class="enlighter-g1">(</span><span class="enlighter-text">Buffer::</span><span class="enlighter-m0">hex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$finalSignData</span><span class="enlighter-g1">))</span><span class="enlighter-text">, </span><span class="enlighter-k7">$sigHashType</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$derSigHex</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$txSig</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getSignature</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getBuffer</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text"> . Buffer::</span><span class="enlighter-k5">int</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$sigHashType</span><span class="enlighter-text">, 1</span><span class="enlighter-g1">)</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$input</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$finalTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">inputsMutator</span><span class="enlighter-g1">()[</span><span class="enlighter-k7">$nIn</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$inputSig</span><span class="enlighter-text"> = ScriptFactory::</span><span class="enlighter-m0">sequence</span><span class="enlighter-g1">(</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">[</span><span class="enlighter-text">Buffer::</span><span class="enlighter-m0">hex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$derSigHex</span><span class="enlighter-g1">)</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">                 Buffer::</span><span class="enlighter-m0">hex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$privateKey</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getPublicKey</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">())</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">                 Buffer::</span><span class="enlighter-m0">hex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$signData</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getRedeemScript</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">())</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$inputSig</span><span class="enlighter-text"> = ScriptFactory::</span><span class="enlighter-m0">create</span><span class="enlighter-g1">()</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">push</span><span class="enlighter-g1">(</span><span class="enlighter-text">Buffer::</span><span class="enlighter-m0">hex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$derSigHex</span><span class="enlighter-g1">))</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">push</span><span class="enlighter-g1">(</span><span class="enlighter-text">Buffer::</span><span class="enlighter-m0">hex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$privateKey</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getPublicKey</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()))</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">push</span><span class="enlighter-g1">(</span><span class="enlighter-text">Buffer::</span><span class="enlighter-m0">hex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$signData</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getRedeemScript</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()))</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$input</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">script</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$inputSig</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">    ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"alert alert-success"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">h6 </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"mt-3"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Final TX Hex</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/h6</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">textarea </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> rows=</span><span class="enlighter-s0">"5"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"comment"</span><span class="enlighter-text"> readonly</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$finalTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">done</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text">;?</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/textarea</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">catch</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">Exception </span><span class="enlighter-k7">$e</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$errmsg</span><span class="enlighter-text"> .= </span><span class="enlighter-s0">"Problem found. "</span><span class="enlighter-text"> . </span><span class="enlighter-k7">$e</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getMessage</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$errmsg</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"alert alert-danger"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">strong</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Error!</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/strong</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$errmsg</span><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">form action=</span><span class="enlighter-s0">'?tab=form2_tabitem3#hashtag2'</span><span class="enlighter-text"> method=</span><span class="enlighter-s0">'post'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"network"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Network: </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">select name=</span><span class="enlighter-s0">"network"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"network"</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$networks</span><span class="enlighter-text"> = </span><span class="enlighter-m0">get_class_methods</span><span class="enlighter-g1">(</span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">NetworkFactory</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$networks</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k7">$network</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;option value='{$network}'"</span><span class="enlighter-text">.</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$network</span><span class="enlighter-text"> == </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'network'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">" selected"</span><span class="enlighter-text">: </span><span class="enlighter-s0">""</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span><span class="enlighter-s0">"&gt;{$network}&lt;/option&gt;"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/select</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"utx"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Unspent </span><span class="enlighter-m0">Transaction</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">Hex</span><span class="enlighter-g1">)</span><span class="enlighter-text">:</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"input-group mb-3"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'utx'</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">'utx'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST['</span><span class="enlighter-text">utx</span><span class="enlighter-s0">']?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"input-group-append"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"btn btn-success"</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">"button"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"form2_tabitem3_load"</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">"Load"</span><span class="enlighter-text"> onclick=</span><span class="enlighter-s0">"</span></div></div><div class=""><div><span class="enlighter-s0">                var self = $(this);</span></div></div><div class=""><div><span class="enlighter-s0">                self.val('......'); </span></div></div><div class=""><div><span class="enlighter-s0">                </span></div></div><div class=""><div><span class="enlighter-s0">                var form = self.closest('form');</span></div></div><div class=""><div><span class="enlighter-s0">                var allInputDivs = form.find('div[id^=row_input_]');</span></div></div><div class=""><div><span class="enlighter-s0">                var allInputs = $( ':input', allInputDivs );</span></div></div><div class=""><div><span class="enlighter-s0">                allInputs.val('');</span></div></div><div class=""><div><span class="enlighter-s0">                allInputDivs.hide();</span></div></div><div class=""><div><span class="enlighter-s0">                $('select#no_of_inputs',form).empty();</span></div></div><div class=""><div><span class="enlighter-s0">                $('span#total_inputs',form).html('0');</span></div></div><div class=""><div><span class="enlighter-s0">                $.ajax({</span></div></div><div class=""><div><span class="enlighter-s0">                    url: '?ajax=1&amp;utx=' + $('input#utx',form).val(), </span></div></div><div class=""><div><span class="enlighter-s0">                    </span></div></div><div class=""><div><span class="enlighter-s0">                    error:function() {</span></div></div><div class=""><div><span class="enlighter-s0">                        </span></div></div><div class=""><div><span class="enlighter-s0">                    },</span></div></div><div class=""><div><span class="enlighter-s0">                    </span></div></div><div class=""><div><span class="enlighter-s0">                    success:function(result){</span></div></div><div class=""><div><span class="enlighter-s0">                        try {</span></div></div><div class=""><div><span class="enlighter-s0">                            j = eval('(' + result + ')');</span></div></div><div class=""><div><span class="enlighter-s0">                            </span></div></div><div class=""><div><span class="enlighter-s0">                            if ('error' in j &amp;&amp; j.error.length&gt;0) {</span></div></div><div class=""><div><span class="enlighter-s0">                                var error = true;</span></div></div><div class=""><div><span class="enlighter-s0">                            } else {</span></div></div><div class=""><div><span class="enlighter-s0">                                var error = false;</span></div></div><div class=""><div><span class="enlighter-s0">                            }</span></div></div><div class=""><div><span class="enlighter-s0">                            </span></div></div><div class=""><div><span class="enlighter-s0">                            if (!error) {</span></div></div><div class=""><div><span class="enlighter-s0">                                var txHash = j.txHash;</span></div></div><div class=""><div><span class="enlighter-s0">                                var outputs = j.outputs;</span></div></div><div class=""><div><span class="enlighter-s0">                                var totalInputs = 0;</span></div></div><div class=""><div><span class="enlighter-s0">                                </span></div></div><div class=""><div><span class="enlighter-s0">                                if (outputs.length &gt; 0) {</span></div></div><div class=""><div><span class="enlighter-s0">                                    </span></div></div><div class=""><div><span class="enlighter-s0">                                    </span></div></div><div class=""><div><span class="enlighter-s0">                                    $('select#no_of_inputs',form).prepend('&lt;option value=\''+outputs.length+'\' selected=\'selected\'&gt;'+outputs.length+'&lt;/option&gt;');</span></div></div><div class=""><div><span class="enlighter-s0">                                    </span></div></div><div class=""><div><span class="enlighter-s0">                                    var x;    </span></div></div><div class=""><div><span class="enlighter-s0">                                    for (x in outputs) {</span></div></div><div class=""><div><span class="enlighter-s0">                                        var divid = parseInt(x) + 1;</span></div></div><div class=""><div><span class="enlighter-s0">                                        var amount = parseInt(outputs[x].amount);</span></div></div><div class=""><div><span class="enlighter-s0">                                        totalInputs += amount;</span></div></div><div class=""><div><span class="enlighter-s0">                                        </span></div></div><div class=""><div><span class="enlighter-s0">                                        $('div#row_input_' + divid             ,form).show();</span></div></div><div class=""><div><span class="enlighter-s0">                                        $('input[name=utxo_hash_' + divid+']'  ,form).val(txHash);</span></div></div><div class=""><div><span class="enlighter-s0">                                        $('input[name=utxo_n_' + divid+']'     ,form).val(outputs[x].n);</span></div></div><div class=""><div><span class="enlighter-s0">                                        $('input[name=utxo_script_' + divid+']',form).val(outputs[x].scriptPubKey);</span></div></div><div class=""><div><span class="enlighter-s0">                                        $('input[name=utxo_amount_' + divid+']',form).val(amount);</span></div></div><div class=""><div><span class="enlighter-s0">                                        $('input[name=privkey_'+divid+']'      ,form).removeAttr('readonly');</span></div></div><div class=""><div><span class="enlighter-s0">                                    }</span></div></div><div class=""><div><span class="enlighter-s0">                                }</span></div></div><div class=""><div><span class="enlighter-s0">                                </span></div></div><div class=""><div><span class="enlighter-s0">                                $('span#total_inputs',form).html(totalInputs);</span></div></div><div class=""><div><span class="enlighter-s0">                            } else {</span></div></div><div class=""><div><span class="enlighter-s0">                                alert(j.error);</span></div></div><div class=""><div><span class="enlighter-s0">                            }</span></div></div><div class=""><div><span class="enlighter-s0">                        } catch(e) {</span></div></div><div class=""><div><span class="enlighter-s0">                            alert('Invalid Json Format.');</span></div></div><div class=""><div><span class="enlighter-s0">                        }</span></div></div><div class=""><div><span class="enlighter-s0">                    },</span></div></div><div class=""><div><span class="enlighter-s0">                    complete:function() {</span></div></div><div class=""><div><span class="enlighter-s0">                        self.val('Load');</span></div></div><div class=""><div><span class="enlighter-s0">                    }</span></div></div><div class=""><div><span class="enlighter-s0">                });</span></div></div><div class=""><div><span class="enlighter-s0">                "</span><span class="enlighter-text">/</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"row"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"col-sm-6"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-row"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"no_of_inputs"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Inputs: </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">i</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Max 10 inputs only. Please load them from UTX above.</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/i</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                    </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"row"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"col-sm-2"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">select </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"no_of_inputs"</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-text"> style=</span><span class="enlighter-s0">'width:auto;'</span><span class="enlighter-text"> onchange=</span><span class="enlighter-s0">"</span></div></div><div class=""><div><span class="enlighter-s0">                            var self = $(this);</span></div></div><div class=""><div><span class="enlighter-s0">                            var thisvalue = self.val();</span></div></div><div class=""><div><span class="enlighter-s0">                            var form = self.closest('form');</span></div></div><div class=""><div><span class="enlighter-s0">                            $('div[id^=row_input_]',form).hide();</span></div></div><div class=""><div><span class="enlighter-s0">                            for(var i=1; i&lt;= thisvalue; i++) { </span></div></div><div class=""><div><span class="enlighter-s0">                                $('div[id=row_input_'+  i + ']',form).show();</span></div></div><div class=""><div><span class="enlighter-s0">                            }</span></div></div><div class=""><div><span class="enlighter-s0">                            "</span><span class="enlighter-text"> readonly</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$optionval</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text">?</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> : 0;</span></div></div><div class=""><div><span class="enlighter-text">                                </span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$optionval</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> 0</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">option value=</span><span class="enlighter-s0">'&lt;?php echo $optionval?&gt;'</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$optionval</span><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/option</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/select</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"col-sm-10"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            Total Sathoshi: </span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">span id=</span><span class="enlighter-s0">'total_inputs'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-m0">array_reduce</span><span class="enlighter-g1">(</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-m0">array_keys</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">)</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k0">function</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$carry</span><span class="enlighter-text">, </span><span class="enlighter-k7">$key</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                                    </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-m0">preg_match</span><span class="enlighter-g1">(</span><span class="enlighter-s0">'/^utxo_amount_/'</span><span class="enlighter-text">, </span><span class="enlighter-k7">$key</span><span class="enlighter-g1">))</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                        </span><span class="enlighter-k0">return</span><span class="enlighter-text"> </span><span class="enlighter-k7">$carry</span><span class="enlighter-text"> + </span><span class="enlighter-g1">(</span><span class="enlighter-k5">int</span><span class="enlighter-g1">)</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-k7">$key</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                                    </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text">                    </span></div></div><div class=""><div><span class="enlighter-text">                                        </span><span class="enlighter-k0">return</span><span class="enlighter-text"> </span><span class="enlighter-k7">$carry</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                                    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-g1">}</span><span class="enlighter-text">, 0</span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">)</span><span class="enlighter-text">;?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/span</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$selectedNInputs</span><span class="enlighter-text"> = </span><span class="enlighter-m0">is_numeric</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> ? </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> : 0;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$noOfInputs</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Input</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-row"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">'row_input_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> style=</span><span class="enlighter-s0">"&lt;?php echo ($thisInput &gt; $selectedNInputs) ? "</span><span class="enlighter-text">display:none</span><span class="enlighter-s0">" : "</span><span class="enlighter-text">display:;</span><span class="enlighter-s0">"?&gt;"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input type=</span><span class="enlighter-s0">'hidden'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'utxo_amount_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["utxo_amount_{$thisInput}"]?&gt;'</span><span class="enlighter-text">/</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-1"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        #</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Input?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-3"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">"UTXO Tx Hash"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'UTXO Tx Hash'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'utxo_hash_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["utxo_hash_{$thisInput}"]?&gt;'</span><span class="enlighter-text"> readonly</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-1"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">"UTXO N Output"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'N'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'utxo_n_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["utxo_n_{$thisInput}"]?&gt;'</span><span class="enlighter-text"> readonly</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-3"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">"UTXO ScriptPubKey"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'UTXO ScriptPubKey'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'utxo_script_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["utxo_script_{$thisInput}"]?&gt;'</span><span class="enlighter-text"> readonly</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-4"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">"Private Key Hex, for signing purpose."</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'Private Key Hex'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'privkey_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["privkey_{$thisInput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-1"</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-11"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'Redeem Script'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'redeemscript_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["redeemscript_{$thisInput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"col-sm-6"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-row"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"no_of_outputs"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Outputs:</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">select </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"no_of_outputs"</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-text"> style=</span><span class="enlighter-s0">'width:auto;'</span><span class="enlighter-text"> onchange=</span><span class="enlighter-s0">"</span></div></div><div class=""><div><span class="enlighter-s0">                    var self = $(this);</span></div></div><div class=""><div><span class="enlighter-s0">                    var thisvalue = self.val();</span></div></div><div class=""><div><span class="enlighter-s0">                    var form = self.closest('form');</span></div></div><div class=""><div><span class="enlighter-s0">                    $('div[id^=row_output_]',form).hide();</span></div></div><div class=""><div><span class="enlighter-s0">                    for(var i=1; i&lt;= thisvalue; i++) { </span></div></div><div class=""><div><span class="enlighter-s0">                        $('div[id=row_output_'+  i + ']',form).show();</span></div></div><div class=""><div><span class="enlighter-s0">                    }</span></div></div><div class=""><div><span class="enlighter-s0">                    "</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$noOfOutputs</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;option value='{$thisOutput}'"</span><span class="enlighter-text">.</span><span class="enlighter-g1">(</span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output == </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">" selected"</span><span class="enlighter-text">: </span><span class="enlighter-s0">""</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span><span class="enlighter-s0">"&gt;{$thisOutput}&lt;/option&gt;"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/select</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$selectedNOutputs</span><span class="enlighter-text"> = </span><span class="enlighter-m0">is_numeric</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> ? </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> : 1;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$noOfOutputs</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-row"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">'row_output_&lt;?php echo $thisOutput?&gt;'</span><span class="enlighter-text"> style=</span><span class="enlighter-s0">"&lt;?php echo ($thisOutput &gt; $selectedNOutputs) ? "</span><span class="enlighter-text">display:none</span><span class="enlighter-s0">" : "</span><span class="enlighter-text">display:;</span><span class="enlighter-s0">"?&gt;"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col-sm-1"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        #</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col-sm-6"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'Any Address'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'address_&lt;?php echo $thisOutput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["address_{$thisOutput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col-sm-5"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'Amount'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'amount_&lt;?php echo $thisOutput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["amount_{$thisOutput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">nLockTime:</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check form-check-inline"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check-label"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input type=</span><span class="enlighter-s0">"radio"</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check-input"</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">"lock_type"</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">"timestamp"</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'lock_type'</span><span class="enlighter-g1">]</span><span class="enlighter-text">==</span><span class="enlighter-s0">'timestamp'</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">' checked'</span><span class="enlighter-text">: </span><span class="enlighter-s0">''</span><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> onclick=</span><span class="enlighter-s0">"</span></div></div><div class=""><div><span class="enlighter-s0">                var self = $(this);</span></div></div><div class=""><div><span class="enlighter-s0">                var lockTypeValueE = $('#nlocktime');</span></div></div><div class=""><div><span class="enlighter-s0">                lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['timestamp']?&gt;');                </span></div></div><div class=""><div><span class="enlighter-s0">                "</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">span </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">'explaination'</span><span class="enlighter-text"> data-toggle=</span><span class="enlighter-s0">'tooltip'</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">'Tx is spendable when datetime reach Median Time Past (MTP). MTP is just the median of the last 11 blocks.'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Datetime</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/span</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check form-check-inline"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check-label"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input type=</span><span class="enlighter-s0">"radio"</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-check-input"</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">"lock_type"</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">"blockheight"</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'lock_type'</span><span class="enlighter-g1">]</span><span class="enlighter-text">==</span><span class="enlighter-s0">'blockheight'</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">' checked'</span><span class="enlighter-text">: </span><span class="enlighter-s0">''</span><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> onclick=</span><span class="enlighter-s0">"</span></div></div><div class=""><div><span class="enlighter-s0">                var self = $(this);</span></div></div><div class=""><div><span class="enlighter-s0">                var lockTypeValueE = $('#nlocktime');</span></div></div><div class=""><div><span class="enlighter-s0">                lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['blockheight']?&gt;');                </span></div></div><div class=""><div><span class="enlighter-s0">                "</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Block Height</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'nlocktime'</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">'nlocktime'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST['</span><span class="enlighter-text">nlocktime</span><span class="enlighter-s0">']?&gt;'</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">"&lt;?php echo $placeholder['locktypevalue'][ $_POST['lock_type']?$_POST['lock_type']:'default' ]?&gt;"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">a href=</span><span class="enlighter-s0">"../bitcoin/bitcoin_tool_mtp.php"</span><span class="enlighter-text"> target=</span><span class="enlighter-s0">"_blank"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">To spend immediately, you just got to fill in current chain</span><span class="enlighter-s0">'s HEIGHT or MTP.&lt;/a&gt;</span></div></div><div class=""><div><span class="enlighter-s0">    &lt;/div&gt;</span></div></div><div class=""><div><span class="enlighter-s0">    </span></div></div><div class=""><div><span class="enlighter-s0">    &lt;input type='</span><span class="enlighter-text">submit' </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"btn btn-success btn-block"</span><span class="enlighter-text">/</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/form</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"html_iframe_footer.php"</span><span class="enlighter-g1">)</span><span class="enlighter-text">;        </span></div></div></div><pre class="enlighter-raw">&lt;?php 
use BitWasp\Buffertools\Buffer;
use BitWasp\Bitcoin\Network\NetworkFactory;
use BitWasp\Bitcoin\Address\AddressCreator;
use BitWasp\Bitcoin\Address\PayToPubKeyHashAddress;
use BitWasp\Bitcoin\Bitcoin;
use BitWasp\Bitcoin\Key\Factory\PrivateKeyFactory;
use BitWasp\Bitcoin\Transaction\Factory\Signer;
use BitWasp\Bitcoin\Transaction\Factory\SignData;
use BitWasp\Bitcoin\Transaction\TransactionFactory;
use BitWasp\Bitcoin\Transaction\TransactionOutput;
use BitWasp\Bitcoin\Script\Classifier\OutputClassifier;
use BitWasp\Bitcoin\Script\ScriptType;
use BitWasp\Bitcoin\Script\ScriptFactory;
use BitWasp\Bitcoin\Script\P2shScript;
use BitWasp\Bitcoin\Signature\TransactionSignature;

include_once "../libraries/vendor/autoload.php";

$noOfInputs = 10;
$noOfOutputs = 10;

$placeholder['locktypevalue']['default'] = 'Please choose either Datetime or block height.';
$placeholder['locktypevalue']['timestamp'] = 'Accept only format YYYY-MM-DD HH:MM:SS.';
$placeholder['locktypevalue']['blockheight'] = 'Block height must be integer.';

include_once("html_iframe_header.php");
?&gt;
&lt;div class='vertical-line-yellow'&gt;
    &lt;h6 class="mt-3"&gt;To success spend of OP_CLTV, following requirements must meet:&lt;/h6&gt;
    
    &lt;ul&gt;
        &lt;li&gt;nLocktime is required&lt;/li&gt;
        &lt;li&gt;if nLockTime typed datetime detected, then value must satisfy &lt; chain's MTP.&lt;/li&gt;
        &lt;li&gt;if nLockTime typed block height detected, then value must satisfy &lt; chain's block height + 1.&lt;/li&gt;    
        &lt;li&gt;if OP_CLTV detected, then its time parameter must satisfy &gt;= nLockTime.&lt;/li&gt;
        &lt;li&gt;At least one input's nSequence must set lower than max value #FFFFFFFF to enable nLockTime.&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;
&lt;?php
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    
    try {
        $networkClass   = $_POST['network'];
        Bitcoin::setNetwork(NetworkFactory::$networkClass());
        
        $network        = Bitcoin::getNetwork();
        $ecAdapter      = Bitcoin::getEcAdapter();
        $privKeyFactory = new PrivateKeyFactory();
        
        $addrCreator = new AddressCreator();
        
        $spendTx = TransactionFactory::build();
        
        $signItems = [];
        
        if (!strlen($_POST['utx']) or !ctype_xdigit($_POST['utx'])) {                    
            throw new Exception("UTX must be hex.");
        } 
        
        if (!is_numeric($_POST['no_of_inputs']) OR !is_numeric($_POST['no_of_outputs'])) {
            throw new Exception("Error in 'no_of_inputs' or 'no_of_outputs'.");
        }
        
        $utxHex = $_POST['utx'];
        $utx = TransactionFactory::fromHex($utxHex);    
        $utxos = $utx-&gt;getOutputs();
        
        //any input's nSequence set lesser than max value #ffffffff (32-bits) will enable nLockTime field.
        $sequence = 0;
        
        foreach($utxos as $k=&gt;$utxo) {
            $privateKey = $privKeyFactory-&gt;fromHexCompressed($_POST["privkey_" . ($k+1)]);
            $utxoScript = $utxo-&gt;getScript();
            $redeemScript = trim($_POST["redeemscript_" . ($k+1)]);
            $redeemScript = new P2shScript(ScriptFactory::fromHex($redeemScript));
            
            $p2shScriptPubKey = ScriptFactory::scriptPubKey()-&gt;p2sh($redeemScript-&gt;getScriptHash()/*sha256*/);
            
            if ($utxoScript-&gt;getHex() != $p2shScriptPubKey-&gt;getHex()) {
                throw new Exception("Error in 'input#{$k}'. Redeem script is not matched to UTXO's ScriptPubKey.");
            }
            
            $signData = new SignData();
            $signData-&gt;p2sh($redeemScript);
            
            $signItems[] = [ $privateKey, $signData ];
            
            $spendTx = $spendTx-&gt;spendOutputFrom($utx, $k, null, $sequence);
        }
        
        if ($_POST['lock_type'] == 'timestamp') {
            $nlocktime = strtotime($_POST['nlocktime']);
        } else if($_POST['lock_type'] == 'blockheight') {
            $nlocktime = (int)$_POST['nlocktime'];
        } else {
            throw new Exception('Please choose either Datetime or block height.');
        }
        $spendTx-&gt;locktime($nlocktime); //set nlocktime at transaction level

        foreach(range(1,$_POST['no_of_outputs']) as $thisOutput) {
            
            $address = trim($_POST["address_{$thisOutput}"]);
            $amount = trim($_POST["amount_{$thisOutput}"]);
            
            if (strlen($address)&gt;0 AND strlen($amount)&gt;0) {
                $recipient = $addrCreator-&gt;fromString($address);
                $spendTx = $spendTx-&gt;payToAddress($amount, $recipient);
            } else {
                throw new Exception("Error in 'output#{$thisOutput}'.");
            }
        }
        
        $thisTx = $spendTx-&gt;get();
        $finalTx = TransactionFactory::mutate($thisTx);
        $mutable = TransactionFactory::mutate($thisTx);
        $sigHashType = 1; //ALL
        foreach($signItems as $nIn=&gt;$signItem) {
            $privateKey = $signItem[0];
            $signData   = $signItem[1];
            $input = $mutable-&gt;inputsMutator()[$nIn];
            $input-&gt;script($signData-&gt;getRedeemScript());
            $finalSignData = $mutable-&gt;done()-&gt;getHex() .  bin2hex(pack('V', $sigHashType));
            $finalSignData = hash('sha256', hex2bin(hash('sha256', hex2bin($finalSignData))));
            $txSig = new TransactionSignature($ecAdapter, $privateKey-&gt;sign(Buffer::hex($finalSignData)), $sigHashType);
            $derSigHex = $txSig-&gt;getSignature()-&gt;getBuffer()-&gt;getHex() . Buffer::int($sigHashType, 1)-&gt;getHex();
            
            $input = $finalTx-&gt;inputsMutator()[$nIn];
            
            
            $inputSig = ScriptFactory::sequence(
                [Buffer::hex($derSigHex),
                 Buffer::hex($privateKey-&gt;getPublicKey()-&gt;getHex()),
                 Buffer::hex($signData-&gt;getRedeemScript()-&gt;getHex())
                ]);
                
            $inputSig = ScriptFactory::create()
                            -&gt;push(Buffer::hex($derSigHex))
                            -&gt;push(Buffer::hex($privateKey-&gt;getPublicKey()-&gt;getHex()))
                            -&gt;push(Buffer::hex($signData-&gt;getRedeemScript()-&gt;getHex()));
            
            $input-&gt;script($inputSig);
        }
        
    ?&gt;
        &lt;div class="alert alert-success"&gt;
            &lt;h6 class="mt-3"&gt;Final TX Hex&lt;/h6&gt;
            
            &lt;textarea class="form-control" rows="5" id="comment" readonly&gt;&lt;?php echo $finalTx-&gt;done()-&gt;getHex();?&gt;&lt;/textarea&gt;
        &lt;/div&gt;
    &lt;?php
    
    } catch (Exception $e) {
        $errmsg .= "Problem found. " . $e-&gt;getMessage();

    }
}

if ($errmsg) {
?&gt;
    &lt;div class="alert alert-danger"&gt;
        &lt;strong&gt;Error!&lt;/strong&gt; &lt;?php echo $errmsg?&gt;
    &lt;/div&gt;
&lt;?php
}
?&gt;
&lt;form action='?tab=form2_tabitem3#hashtag2' method='post'&gt;
    &lt;div class="form-group"&gt;
        &lt;label for="network"&gt;Network: &lt;/label&gt;
        &lt;select name="network" id="network" class="form-control"&gt;
            &lt;?php
            $networks = get_class_methods(new NetworkFactory());
            foreach($networks as $network) {
                echo "&lt;option value='{$network}'".($network == $_POST['network'] ? " selected": "")."&gt;{$network}&lt;/option&gt;";
            }
            ?&gt;
        &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class="form-group"&gt;
        &lt;label for="utx"&gt;Unspent Transaction (Hex):&lt;/label&gt;
        
        &lt;div class="input-group mb-3"&gt;
            &lt;input class="form-control" type='text' name='utx' id='utx' value='&lt;?php echo $_POST['utx']?&gt;'&gt;
            &lt;div class="input-group-append"&gt;
                &lt;input class="btn btn-success" type="button" id="form2_tabitem3_load" value="Load" onclick="
                var self = $(this);
                self.val('......'); 
                
                var form = self.closest('form');
                var allInputDivs = form.find('div[id^=row_input_]');
                var allInputs = $( ':input', allInputDivs );
                allInputs.val('');
                allInputDivs.hide();
                $('select#no_of_inputs',form).empty();
                $('span#total_inputs',form).html('0');
                $.ajax({
                    url: '?ajax=1&amp;utx=' + $('input#utx',form).val(), 
                    
                    error:function() {
                        
                    },
                    
                    success:function(result){
                        try {
                            j = eval('(' + result + ')');
                            
                            if ('error' in j &amp;&amp; j.error.length&gt;0) {
                                var error = true;
                            } else {
                                var error = false;
                            }
                            
                            if (!error) {
                                var txHash = j.txHash;
                                var outputs = j.outputs;
                                var totalInputs = 0;
                                
                                if (outputs.length &gt; 0) {
                                    
                                    
                                    $('select#no_of_inputs',form).prepend('&lt;option value=\''+outputs.length+'\' selected=\'selected\'&gt;'+outputs.length+'&lt;/option&gt;');
                                    
                                    var x;    
                                    for (x in outputs) {
                                        var divid = parseInt(x) + 1;
                                        var amount = parseInt(outputs[x].amount);
                                        totalInputs += amount;
                                        
                                        $('div#row_input_' + divid             ,form).show();
                                        $('input[name=utxo_hash_' + divid+']'  ,form).val(txHash);
                                        $('input[name=utxo_n_' + divid+']'     ,form).val(outputs[x].n);
                                        $('input[name=utxo_script_' + divid+']',form).val(outputs[x].scriptPubKey);
                                        $('input[name=utxo_amount_' + divid+']',form).val(amount);
                                        $('input[name=privkey_'+divid+']'      ,form).removeAttr('readonly');
                                    }
                                }
                                
                                $('span#total_inputs',form).html(totalInputs);
                            } else {
                                alert(j.error);
                            }
                        } catch(e) {
                            alert('Invalid Json Format.');
                        }
                    },
                    complete:function() {
                        self.val('Load');
                    }
                });
                "/&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="row"&gt;
        &lt;div class="col-sm-6"&gt;
            
            &lt;div class="form-row"&gt;
                &lt;div class="form-group col"&gt;
                    &lt;label for="no_of_inputs"&gt;Inputs: &lt;i&gt;Max 10 inputs only. Please load them from UTX above.&lt;/i&gt;&lt;/label&gt; 
                    
                    &lt;div class="row"&gt;
                        &lt;div class="col-sm-2"&gt;
                            &lt;select class="form-control" id="no_of_inputs" name='no_of_inputs' style='width:auto;' onchange="
                            var self = $(this);
                            var thisvalue = self.val();
                            var form = self.closest('form');
                            $('div[id^=row_input_]',form).hide();
                            for(var i=1; i&lt;= thisvalue; i++) { 
                                $('div[id=row_input_'+  i + ']',form).show();
                            }
                            " readonly&gt;
                                &lt;?php
                                $optionval = $_POST['no_of_inputs']?$_POST['no_of_inputs'] : 0;
                                
                                if ($optionval &gt; 0) {
                                ?&gt;
                                &lt;option value='&lt;?php echo $optionval?&gt;'&gt;&lt;?php echo $optionval?&gt;&lt;/option&gt;
                                &lt;?php
                                }
                                ?&gt;
                            &lt;/select&gt;
                        &lt;/div&gt;
                        
                        &lt;div class="col-sm-10"&gt;
                            Total Sathoshi: 
                            &lt;span id='total_inputs'&gt;
                            &lt;?php echo 
                            array_reduce(
                                array_keys($_POST),
                                function($carry, $key) { 
                                    if (preg_match('/^utxo_amount_/', $key)) {
                                        return $carry + (int)$_POST[$key];
                                    } else {                    
                                        return $carry;
                                    }
                                }, 0
                            );?&gt;
                            &lt;/span&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            
            &lt;?php
            $selectedNInputs = is_numeric($_POST['no_of_inputs']) ? $_POST['no_of_inputs'] : 0;
            
            foreach(range(1,$noOfInputs) as $thisInput) {
            ?&gt;
            
                &lt;div class="form-row" id='row_input_&lt;?php echo $thisInput?&gt;' style="&lt;?php echo ($thisInput &gt; $selectedNInputs) ? "display:none" : "display:;"?&gt;"&gt;
                    &lt;input type='hidden' name='utxo_amount_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_amount_{$thisInput}"]?&gt;'/&gt;
                    
                    &lt;div class="form-group  col-sm-1"&gt;
                        #&lt;?php echo $thisInput?&gt; 
                    &lt;/div&gt;
                    &lt;div class="form-group  col-sm-3"&gt;    
                        &lt;input class="form-control" title="UTXO Tx Hash" placeholder='UTXO Tx Hash' type='text' name='utxo_hash_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_hash_{$thisInput}"]?&gt;' readonly&gt;
                    &lt;/div&gt;
                    &lt;div class="form-group  col-sm-1"&gt;
                        &lt;input class="form-control" title="UTXO N Output" placeholder='N' type='text' name='utxo_n_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_n_{$thisInput}"]?&gt;' readonly&gt;
                    &lt;/div&gt;
                    &lt;div class="form-group  col-sm-3"&gt;
                        &lt;input class="form-control" title="UTXO ScriptPubKey" placeholder='UTXO ScriptPubKey' type='text' name='utxo_script_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_script_{$thisInput}"]?&gt;' readonly&gt;
                    &lt;/div&gt;
                    &lt;div class="form-group  col-sm-4"&gt;
                        &lt;input class="form-control" title="Private Key Hex, for signing purpose." placeholder='Private Key Hex' type='text' name='privkey_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["privkey_{$thisInput}"]?&gt;'&gt;
                    &lt;/div&gt;
                    
                    &lt;div class="form-group  col-sm-1" &gt;
                    
                    &lt;/div&gt;
                    &lt;div class="form-group  col-sm-11"&gt;
                        &lt;input class="form-control" placeholder='Redeem Script' type='text' name='redeemscript_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["redeemscript_{$thisInput}"]?&gt;'&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;?php
            }
            ?&gt;
        &lt;/div&gt;
        &lt;div class="col-sm-6"&gt;
            &lt;div class="form-row"&gt;
                &lt;div class="form-group col"&gt;
                    &lt;label for="no_of_outputs"&gt;Outputs:&lt;/label&gt; &lt;select class="form-control" id="no_of_outputs" name='no_of_outputs' style='width:auto;' onchange="
                    var self = $(this);
                    var thisvalue = self.val();
                    var form = self.closest('form');
                    $('div[id^=row_output_]',form).hide();
                    for(var i=1; i&lt;= thisvalue; i++) { 
                        $('div[id=row_output_'+  i + ']',form).show();
                    }
                    "&gt;
                        &lt;?php
                        foreach(range(1,$noOfOutputs) as $thisOutput) {
                            echo "&lt;option value='{$thisOutput}'".($thisOutput == $_POST['no_of_outputs'] ? " selected": "")."&gt;{$thisOutput}&lt;/option&gt;";
                        }
                        ?&gt;
                    &lt;/select&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;?php
            $selectedNOutputs = is_numeric($_POST['no_of_outputs']) ? $_POST['no_of_outputs'] : 1;
            
            
            foreach(range(1,$noOfOutputs) as $thisOutput) {
            ?&gt;
                &lt;div class="form-row" id='row_output_&lt;?php echo $thisOutput?&gt;' style="&lt;?php echo ($thisOutput &gt; $selectedNOutputs) ? "display:none" : "display:;"?&gt;"&gt;
                    &lt;div class="form-group col-sm-1"&gt;
                        #&lt;?php echo $thisOutput?&gt; 
                    &lt;/div&gt;
                    
                    &lt;div class="form-group col-sm-6"&gt;
                        &lt;input class="form-control" placeholder='Any Address' type='text' name='address_&lt;?php echo $thisOutput?&gt;' value='&lt;?php echo $_POST["address_{$thisOutput}"]?&gt;'&gt;
                    &lt;/div&gt;
                    &lt;div class="form-group col-sm-5"&gt;
                        &lt;input class="form-control" placeholder='Amount' type='text' name='amount_&lt;?php echo $thisOutput?&gt;' value='&lt;?php echo $_POST["amount_{$thisOutput}"]?&gt;'&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
    &lt;?php
            }
    ?&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    
    &lt;div class="form-group"&gt;
        &lt;label&gt;nLockTime:&lt;/label&gt;
        
        &lt;div class="form-check form-check-inline"&gt;
            &lt;label class="form-check-label"&gt;
                &lt;input type="radio" class="form-check-input" name="lock_type" value="timestamp"&lt;?php echo $_POST['lock_type']=='timestamp' ? ' checked': ''?&gt; onclick="
                var self = $(this);
                var lockTypeValueE = $('#nlocktime');
                lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['timestamp']?&gt;');                
                "&gt;&lt;span class='explaination' data-toggle='tooltip' title='Tx is spendable when datetime reach Median Time Past (MTP). MTP is just the median of the last 11 blocks.'&gt;Datetime&lt;/span&gt;
            &lt;/label&gt;
        &lt;/div&gt;
        &lt;div class="form-check form-check-inline"&gt;
            &lt;label class="form-check-label"&gt;
                &lt;input type="radio" class="form-check-input" name="lock_type" value="blockheight"&lt;?php echo $_POST['lock_type']=='blockheight' ? ' checked': ''?&gt; onclick="
                var self = $(this);
                var lockTypeValueE = $('#nlocktime');
                lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['blockheight']?&gt;');                
                "&gt;Block Height
            &lt;/label&gt;
        &lt;/div&gt;
        
        &lt;input class="form-control" type='text' name='nlocktime' id='nlocktime' value='&lt;?php echo $_POST['nlocktime']?&gt;' placeholder="&lt;?php echo $placeholder['locktypevalue'][ $_POST['lock_type']?$_POST['lock_type']:'default' ]?&gt;"&gt;
        
        &lt;a href="../bitcoin/bitcoin_tool_mtp.php" target="_blank"&gt;To spend immediately, you just got to fill in current chain's HEIGHT or MTP.&lt;/a&gt;
    &lt;/div&gt;
    
    &lt;input type='submit' class="btn btn-success btn-block"/&gt;
&lt;/form&gt;
&lt;?php
include_once("html_iframe_footer.php");        </pre></div><pre style="border-radius:none;" class="enlighter-origin">&lt;?php 
use BitWasp\Buffertools\Buffer;
use BitWasp\Bitcoin\Network\NetworkFactory;
use BitWasp\Bitcoin\Address\AddressCreator;
use BitWasp\Bitcoin\Address\PayToPubKeyHashAddress;
use BitWasp\Bitcoin\Bitcoin;
use BitWasp\Bitcoin\Key\Factory\PrivateKeyFactory;
use BitWasp\Bitcoin\Transaction\Factory\Signer;
use BitWasp\Bitcoin\Transaction\Factory\SignData;
use BitWasp\Bitcoin\Transaction\TransactionFactory;
use BitWasp\Bitcoin\Transaction\TransactionOutput;
use BitWasp\Bitcoin\Script\Classifier\OutputClassifier;
use BitWasp\Bitcoin\Script\ScriptType;
use BitWasp\Bitcoin\Script\ScriptFactory;
use BitWasp\Bitcoin\Script\P2shScript;
use BitWasp\Bitcoin\Signature\TransactionSignature;

include_once "../libraries/vendor/autoload.php";

$noOfInputs = 10;
$noOfOutputs = 10;

$placeholder['locktypevalue']['default'] = 'Please choose either Datetime or block height.';
$placeholder['locktypevalue']['timestamp'] = 'Accept only format YYYY-MM-DD HH:MM:SS.';
$placeholder['locktypevalue']['blockheight'] = 'Block height must be integer.';

include_once("html_iframe_header.php");
?&gt;
&lt;div class='vertical-line-yellow'&gt;
	&lt;h6 class="mt-3"&gt;To success spend of OP_CLTV, following requirements must meet:&lt;/h6&gt;
	
	&lt;ul&gt;
		&lt;li&gt;nLocktime is required&lt;/li&gt;
		&lt;li&gt;if nLockTime typed datetime detected, then value must satisfy &amp;lt; chain's MTP.&lt;/li&gt;
		&lt;li&gt;if nLockTime typed block height detected, then value must satisfy &amp;lt; chain's block height + 1.&lt;/li&gt;	
		&lt;li&gt;if OP_CLTV detected, then its time parameter must satisfy &amp;gt;= nLockTime.&lt;/li&gt;
		&lt;li&gt;At least one input's nSequence must set lower than max value #FFFFFFFF to enable nLockTime.&lt;/li&gt;
	&lt;/ul&gt;
&lt;/div&gt;
&lt;?php
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
	
	try {
		$networkClass   = $_POST['network'];
		Bitcoin::setNetwork(NetworkFactory::$networkClass());
		
		$network        = Bitcoin::getNetwork();
		$ecAdapter      = Bitcoin::getEcAdapter();
		$privKeyFactory = new PrivateKeyFactory();
		
		$addrCreator = new AddressCreator();
		
		$spendTx = TransactionFactory::build();
		
		$signItems = [];
		
		if (!strlen($_POST['utx']) or !ctype_xdigit($_POST['utx'])) {                    
			throw new Exception("UTX must be hex.");
		} 
		
		if (!is_numeric($_POST['no_of_inputs']) OR !is_numeric($_POST['no_of_outputs'])) {
			throw new Exception("Error in 'no_of_inputs' or 'no_of_outputs'.");
		}
		
		$utxHex = $_POST['utx'];
		$utx = TransactionFactory::fromHex($utxHex);    
		$utxos = $utx-&gt;getOutputs();
		
		//any input's nSequence set lesser than max value #ffffffff (32-bits) will enable nLockTime field.
		$sequence = 0;
		
		foreach($utxos as $k=&gt;$utxo) {
			$privateKey = $privKeyFactory-&gt;fromHexCompressed($_POST["privkey_" . ($k+1)]);
			$utxoScript = $utxo-&gt;getScript();
			$redeemScript = trim($_POST["redeemscript_" . ($k+1)]);
			$redeemScript = new P2shScript(ScriptFactory::fromHex($redeemScript));
			
			$p2shScriptPubKey = ScriptFactory::scriptPubKey()-&gt;p2sh($redeemScript-&gt;getScriptHash()/*sha256*/);
			
			if ($utxoScript-&gt;getHex() != $p2shScriptPubKey-&gt;getHex()) {
				throw new Exception("Error in 'input#{$k}'. Redeem script is not matched to UTXO's ScriptPubKey.");
			}
			
			$signData = new SignData();
			$signData-&gt;p2sh($redeemScript);
			
			$signItems[] = [ $privateKey, $signData ];
			
			$spendTx = $spendTx-&gt;spendOutputFrom($utx, $k, null, $sequence);
		}
		
		if ($_POST['lock_type'] == 'timestamp') {
			$nlocktime = strtotime($_POST['nlocktime']);
		} else if($_POST['lock_type'] == 'blockheight') {
			$nlocktime = (int)$_POST['nlocktime'];
		} else {
			throw new Exception('Please choose either Datetime or block height.');
		}
		$spendTx-&gt;locktime($nlocktime); //set nlocktime at transaction level

		foreach(range(1,$_POST['no_of_outputs']) as $thisOutput) {
			
			$address = trim($_POST["address_{$thisOutput}"]);
			$amount = trim($_POST["amount_{$thisOutput}"]);
			
			if (strlen($address)&gt;0 AND strlen($amount)&gt;0) {
				$recipient = $addrCreator-&gt;fromString($address);
				$spendTx = $spendTx-&gt;payToAddress($amount, $recipient);
			} else {
				throw new Exception("Error in 'output#{$thisOutput}'.");
			}
		}
		
		$thisTx = $spendTx-&gt;get();
		$finalTx = TransactionFactory::mutate($thisTx);
		$mutable = TransactionFactory::mutate($thisTx);
		$sigHashType = 1; //ALL
		foreach($signItems as $nIn=&gt;$signItem) {
			$privateKey = $signItem[0];
			$signData   = $signItem[1];
			$input = $mutable-&gt;inputsMutator()[$nIn];
			$input-&gt;script($signData-&gt;getRedeemScript());
			$finalSignData = $mutable-&gt;done()-&gt;getHex() .  bin2hex(pack('V', $sigHashType));
			$finalSignData = hash('sha256', hex2bin(hash('sha256', hex2bin($finalSignData))));
			$txSig = new TransactionSignature($ecAdapter, $privateKey-&gt;sign(Buffer::hex($finalSignData)), $sigHashType);
			$derSigHex = $txSig-&gt;getSignature()-&gt;getBuffer()-&gt;getHex() . Buffer::int($sigHashType, 1)-&gt;getHex();
			
			$input = $finalTx-&gt;inputsMutator()[$nIn];
			
			
			$inputSig = ScriptFactory::sequence(
				[Buffer::hex($derSigHex),
				 Buffer::hex($privateKey-&gt;getPublicKey()-&gt;getHex()),
				 Buffer::hex($signData-&gt;getRedeemScript()-&gt;getHex())
				]);
				
			$inputSig = ScriptFactory::create()
							-&gt;push(Buffer::hex($derSigHex))
							-&gt;push(Buffer::hex($privateKey-&gt;getPublicKey()-&gt;getHex()))
							-&gt;push(Buffer::hex($signData-&gt;getRedeemScript()-&gt;getHex()));
			
			$input-&gt;script($inputSig);
		}
		
	?&gt;
		&lt;div class="alert alert-success"&gt;
			&lt;h6 class="mt-3"&gt;Final TX Hex&lt;/h6&gt;
			
			&lt;textarea class="form-control" rows="5" id="comment" readonly&gt;&lt;?php echo $finalTx-&gt;done()-&gt;getHex();?&gt;&lt;/textarea&gt;
		&lt;/div&gt;
	&lt;?php
	
	} catch (Exception $e) {
		$errmsg .= "Problem found. " . $e-&gt;getMessage();

	}
}

if ($errmsg) {
?&gt;
	&lt;div class="alert alert-danger"&gt;
		&lt;strong&gt;Error!&lt;/strong&gt; &lt;?php echo $errmsg?&gt;
	&lt;/div&gt;
&lt;?php
}
?&gt;
&lt;form action='?tab=form2_tabitem3#hashtag2' method='post'&gt;
	&lt;div class="form-group"&gt;
		&lt;label for="network"&gt;Network: &lt;/label&gt;
		&lt;select name="network" id="network" class="form-control"&gt;
			&lt;?php
			$networks = get_class_methods(new NetworkFactory());
			foreach($networks as $network) {
				echo "&lt;option value='{$network}'".($network == $_POST['network'] ? " selected": "")."&gt;{$network}&lt;/option&gt;";
			}
			?&gt;
		&lt;/select&gt;
	&lt;/div&gt;
	&lt;div class="form-group"&gt;
		&lt;label for="utx"&gt;Unspent Transaction (Hex):&lt;/label&gt;
		
		&lt;div class="input-group mb-3"&gt;
			&lt;input class="form-control" type='text' name='utx' id='utx' value='&lt;?php echo $_POST['utx']?&gt;'&gt;
			&lt;div class="input-group-append"&gt;
				&lt;input class="btn btn-success" type="button" id="form2_tabitem3_load" value="Load" onclick="
				var self = $(this);
				self.val('......'); 
				
				var form = self.closest('form');
				var allInputDivs = form.find('div[id^=row_input_]');
				var allInputs = $( ':input', allInputDivs );
				allInputs.val('');
				allInputDivs.hide();
				$('select#no_of_inputs',form).empty();
				$('span#total_inputs',form).html('0');
				$.ajax({
					url: '?ajax=1&amp;utx=' + $('input#utx',form).val(), 
					
					error:function() {
						
					},
					
					success:function(result){
						try {
							j = eval('(' + result + ')');
							
							if ('error' in j &amp;&amp; j.error.length&gt;0) {
								var error = true;
							} else {
								var error = false;
							}
							
							if (!error) {
								var txHash = j.txHash;
								var outputs = j.outputs;
								var totalInputs = 0;
								
								if (outputs.length &gt; 0) {
									
									
									$('select#no_of_inputs',form).prepend('&lt;option value=\''+outputs.length+'\' selected=\'selected\'&gt;'+outputs.length+'&lt;/option&gt;');
									
									var x;    
									for (x in outputs) {
										var divid = parseInt(x) + 1;
										var amount = parseInt(outputs[x].amount);
										totalInputs += amount;
										
										$('div#row_input_' + divid             ,form).show();
										$('input[name=utxo_hash_' + divid+']'  ,form).val(txHash);
										$('input[name=utxo_n_' + divid+']'     ,form).val(outputs[x].n);
										$('input[name=utxo_script_' + divid+']',form).val(outputs[x].scriptPubKey);
										$('input[name=utxo_amount_' + divid+']',form).val(amount);
										$('input[name=privkey_'+divid+']'      ,form).removeAttr('readonly');
									}
								}
								
								$('span#total_inputs',form).html(totalInputs);
							} else {
								alert(j.error);
							}
						} catch(e) {
							alert('Invalid Json Format.');
						}
					},
					complete:function() {
						self.val('Load');
					}
				});
				"/&gt;
			&lt;/div&gt;
		&lt;/div&gt;
	&lt;/div&gt;
	&lt;div class="row"&gt;
		&lt;div class="col-sm-6"&gt;
			
			&lt;div class="form-row"&gt;
				&lt;div class="form-group col"&gt;
					&lt;label for="no_of_inputs"&gt;Inputs: &lt;i&gt;Max 10 inputs only. Please load them from UTX above.&lt;/i&gt;&lt;/label&gt; 
					
					&lt;div class="row"&gt;
						&lt;div class="col-sm-2"&gt;
							&lt;select class="form-control" id="no_of_inputs" name='no_of_inputs' style='width:auto;' onchange="
							var self = $(this);
							var thisvalue = self.val();
							var form = self.closest('form');
							$('div[id^=row_input_]',form).hide();
							for(var i=1; i&lt;= thisvalue; i++) { 
								$('div[id=row_input_'+  i + ']',form).show();
							}
							" readonly&gt;
								&lt;?php
								$optionval = $_POST['no_of_inputs']?$_POST['no_of_inputs'] : 0;
								
								if ($optionval &gt; 0) {
								?&gt;
								&lt;option value='&lt;?php echo $optionval?&gt;'&gt;&lt;?php echo $optionval?&gt;&lt;/option&gt;
								&lt;?php
								}
								?&gt;
							&lt;/select&gt;
						&lt;/div&gt;
						
						&lt;div class="col-sm-10"&gt;
							Total Sathoshi: 
							&lt;span id='total_inputs'&gt;
							&lt;?php echo 
							array_reduce(
								array_keys($_POST),
								function($carry, $key) { 
									if (preg_match('/^utxo_amount_/', $key)) {
										return $carry + (int)$_POST[$key];
									} else {                    
										return $carry;
									}
								}, 0
							);?&gt;
							&lt;/span&gt;
						&lt;/div&gt;
					&lt;/div&gt;
				&lt;/div&gt;
			&lt;/div&gt;
			
			&lt;?php
			$selectedNInputs = is_numeric($_POST['no_of_inputs']) ? $_POST['no_of_inputs'] : 0;
			
			foreach(range(1,$noOfInputs) as $thisInput) {
			?&gt;
			
				&lt;div class="form-row" id='row_input_&lt;?php echo $thisInput?&gt;' style="&lt;?php echo ($thisInput &gt; $selectedNInputs) ? "display:none" : "display:;"?&gt;"&gt;
					&lt;input type='hidden' name='utxo_amount_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_amount_{$thisInput}"]?&gt;'/&gt;
					
					&lt;div class="form-group  col-sm-1"&gt;
						#&lt;?php echo $thisInput?&gt; 
					&lt;/div&gt;
					&lt;div class="form-group  col-sm-3"&gt;    
						&lt;input class="form-control" title="UTXO Tx Hash" placeholder='UTXO Tx Hash' type='text' name='utxo_hash_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_hash_{$thisInput}"]?&gt;' readonly&gt;
					&lt;/div&gt;
					&lt;div class="form-group  col-sm-1"&gt;
						&lt;input class="form-control" title="UTXO N Output" placeholder='N' type='text' name='utxo_n_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_n_{$thisInput}"]?&gt;' readonly&gt;
					&lt;/div&gt;
					&lt;div class="form-group  col-sm-3"&gt;
						&lt;input class="form-control" title="UTXO ScriptPubKey" placeholder='UTXO ScriptPubKey' type='text' name='utxo_script_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_script_{$thisInput}"]?&gt;' readonly&gt;
					&lt;/div&gt;
					&lt;div class="form-group  col-sm-4"&gt;
						&lt;input class="form-control" title="Private Key Hex, for signing purpose." placeholder='Private Key Hex' type='text' name='privkey_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["privkey_{$thisInput}"]?&gt;'&gt;
					&lt;/div&gt;
					
					&lt;div class="form-group  col-sm-1" &gt;
					
					&lt;/div&gt;
					&lt;div class="form-group  col-sm-11"&gt;
						&lt;input class="form-control" placeholder='Redeem Script' type='text' name='redeemscript_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["redeemscript_{$thisInput}"]?&gt;'&gt;
					&lt;/div&gt;
				&lt;/div&gt;
			&lt;?php
			}
			?&gt;
		&lt;/div&gt;
		&lt;div class="col-sm-6"&gt;
			&lt;div class="form-row"&gt;
				&lt;div class="form-group col"&gt;
					&lt;label for="no_of_outputs"&gt;Outputs:&lt;/label&gt; &lt;select class="form-control" id="no_of_outputs" name='no_of_outputs' style='width:auto;' onchange="
					var self = $(this);
					var thisvalue = self.val();
					var form = self.closest('form');
					$('div[id^=row_output_]',form).hide();
					for(var i=1; i&lt;= thisvalue; i++) { 
						$('div[id=row_output_'+  i + ']',form).show();
					}
					"&gt;
						&lt;?php
						foreach(range(1,$noOfOutputs) as $thisOutput) {
							echo "&lt;option value='{$thisOutput}'".($thisOutput == $_POST['no_of_outputs'] ? " selected": "")."&gt;{$thisOutput}&lt;/option&gt;";
						}
						?&gt;
					&lt;/select&gt;
				&lt;/div&gt;
			&lt;/div&gt;
			&lt;?php
			$selectedNOutputs = is_numeric($_POST['no_of_outputs']) ? $_POST['no_of_outputs'] : 1;
			
			
			foreach(range(1,$noOfOutputs) as $thisOutput) {
			?&gt;
				&lt;div class="form-row" id='row_output_&lt;?php echo $thisOutput?&gt;' style="&lt;?php echo ($thisOutput &gt; $selectedNOutputs) ? "display:none" : "display:;"?&gt;"&gt;
					&lt;div class="form-group col-sm-1"&gt;
						#&lt;?php echo $thisOutput?&gt; 
					&lt;/div&gt;
					
					&lt;div class="form-group col-sm-6"&gt;
						&lt;input class="form-control" placeholder='Any Address' type='text' name='address_&lt;?php echo $thisOutput?&gt;' value='&lt;?php echo $_POST["address_{$thisOutput}"]?&gt;'&gt;
					&lt;/div&gt;
					&lt;div class="form-group col-sm-5"&gt;
						&lt;input class="form-control" placeholder='Amount' type='text' name='amount_&lt;?php echo $thisOutput?&gt;' value='&lt;?php echo $_POST["amount_{$thisOutput}"]?&gt;'&gt;
					&lt;/div&gt;
				&lt;/div&gt;
	&lt;?php
			}
	?&gt;
		&lt;/div&gt;
	&lt;/div&gt;
	
	&lt;div class="form-group"&gt;
		&lt;label&gt;nLockTime:&lt;/label&gt;
		
		&lt;div class="form-check form-check-inline"&gt;
			&lt;label class="form-check-label"&gt;
				&lt;input type="radio" class="form-check-input" name="lock_type" value="timestamp"&lt;?php echo $_POST['lock_type']=='timestamp' ? ' checked': ''?&gt; onclick="
				var self = $(this);
				var lockTypeValueE = $('#nlocktime');
				lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['timestamp']?&gt;');				
				"&gt;&lt;span class='explaination' data-toggle='tooltip' title='Tx is spendable when datetime reach Median Time Past (MTP). MTP is just the median of the last 11 blocks.'&gt;Datetime&lt;/span&gt;
			&lt;/label&gt;
		&lt;/div&gt;
		&lt;div class="form-check form-check-inline"&gt;
			&lt;label class="form-check-label"&gt;
				&lt;input type="radio" class="form-check-input" name="lock_type" value="blockheight"&lt;?php echo $_POST['lock_type']=='blockheight' ? ' checked': ''?&gt; onclick="
				var self = $(this);
				var lockTypeValueE = $('#nlocktime');
				lockTypeValueE.attr('placeholder', '&lt;?php echo $placeholder['locktypevalue']['blockheight']?&gt;');				
				"&gt;Block Height
			&lt;/label&gt;
		&lt;/div&gt;
		
		&lt;input class="form-control" type='text' name='nlocktime' id='nlocktime' value='&lt;?php echo $_POST['nlocktime']?&gt;' placeholder="&lt;?php echo $placeholder['locktypevalue'][ $_POST['lock_type']?$_POST['lock_type']:'default' ]?&gt;"&gt;
		
		&lt;a href="../bitcoin/bitcoin_tool_mtp.php" target="_blank"&gt;To spend immediately, you just got to fill in current chain's HEIGHT or MTP.&lt;/a&gt;
	&lt;/div&gt;
	
	&lt;input type='submit' class="btn btn-success btn-block"/&gt;
&lt;/form&gt;
&lt;?php
include_once("html_iframe_footer.php");		</pre> 
	</div>
	
	<div id="form2_tabitem5" class="tab-pane fade">
		<iframe src="./Bitcoin P2SH.LOCKTIME_files/bitcoin_script_p2sh_csv_fund.html" width="100%" scrolling="no" frameborder="no" id="iFrameResizer4" style="overflow: hidden; height: 0px;"></iframe>
	</div>
	<div id="form2_tabitem6" class="tab-pane fade">
		<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"></div><div class="enlighter-btn enlighter-btn-copy"></div><div class="enlighter-btn enlighter-btn-window"></div><div class="enlighter-btn enlighter-btn-website"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Network\NetworkFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Bitcoin;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Buffertools\Buffer;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Key\Factory\PrivateKeyFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Address\AddressCreator;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Address\Base58AddressInterface;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Transaction\Factory\TxBuilder;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Transaction\TransactionFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Transaction\TransactionOutput;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Transaction\Factory\Signer;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\ScriptFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\Classifier\OutputClassifier;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\ScriptType;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-text"> </span><span class="enlighter-s0">"../libraries/vendor/autoload.php"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"html_iframe_header.php"</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$noOfInputs</span><span class="enlighter-text"> = 10;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$noOfOutputs</span><span class="enlighter-text"> = 10;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_SERVER</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'REQUEST_METHOD'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> == </span><span class="enlighter-s0">'POST'</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k1">try</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$networkClass</span><span class="enlighter-text">   = </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'network'</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        Bitcoin::</span><span class="enlighter-m0">setNetwork</span><span class="enlighter-g1">(</span><span class="enlighter-text">NetworkFactory::</span><span class="enlighter-k7">$networkClass</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$network</span><span class="enlighter-text">        = Bitcoin::</span><span class="enlighter-m0">getNetwork</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$ecAdapter</span><span class="enlighter-text">      = Bitcoin::</span><span class="enlighter-m0">getEcAdapter</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$privKeyFactory</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">PrivateKeyFactory</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$addrCreator</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">AddressCreator</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text"> = TransactionFactory::</span><span class="enlighter-m0">build</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$signItems</span><span class="enlighter-text"> = </span><span class="enlighter-g1">[]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">!</span><span class="enlighter-m0">is_numeric</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> OR !</span><span class="enlighter-m0">is_numeric</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">]))</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Error in 'no_of_inputs' or 'no_of_outputs'."</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Input</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$utxoHash</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"utxo_hash_{$thisInput}"</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$utxoNOutput</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"utxo_n_{$thisInput}"</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$privkeyhex</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"privkey_{$thisInput}"</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$utxoScript</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"utxo_script_{$thisInput}"</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-m0">strlen</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$utxoHash</span><span class="enlighter-g1">)&gt;</span><span class="enlighter-text">0 AND </span><span class="enlighter-m0">strlen</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$utxoNOutput</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> 0 AND </span><span class="enlighter-m0">strlen</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$privkeyhex</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> 0</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">input</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$utxoHash</span><span class="enlighter-text">, </span><span class="enlighter-k7">$utxoNOutput</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k7">$signItems</span><span class="enlighter-g1">[]</span><span class="enlighter-text"> = </span><span class="enlighter-g1">[</span><span class="enlighter-k7">$privkeyhex</span><span class="enlighter-text">, </span><span class="enlighter-k7">$utxoScript</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Error in 'input#{$thisInput}'."</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$address</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"address_{$thisOutput}"</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$amount</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"amount_{$thisOutput}"</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$recipient</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$addrCreator</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">fromString</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$address</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">!</span><span class="enlighter-m0">strlen</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$address</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-k3">or</span><span class="enlighter-text"> !</span><span class="enlighter-m0">strlen</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$amount</span><span class="enlighter-g1">))</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Error in 'output#{$thisOutput}'."</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">!</span><span class="enlighter-k7">$recipient</span><span class="enlighter-text"> </span><span class="enlighter-k0">instanceof</span><span class="enlighter-text"> Base58AddressInterface</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Invalid P2SH address in 'output#{$thisOutput}' (Check base58Address)."</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$decodeScript</span><span class="enlighter-text"> = </span><span class="enlighter-g1">(</span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">OutputClassifier</span><span class="enlighter-g1">())</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">decode</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$recipient</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScriptPubKey</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">!</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$decodeScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getType</span><span class="enlighter-g1">()</span><span class="enlighter-text"> == ScriptType::</span><span class="enlighter-m2">P2SH</span><span class="enlighter-text"> OR </span><span class="enlighter-k7">$decodeScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getType</span><span class="enlighter-g1">()</span><span class="enlighter-text"> == ScriptType::</span><span class="enlighter-m2">P2PKH</span><span class="enlighter-g1">))</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Invalid P2SH address in 'output#{$thisOutput}' (Check scriptPubKey)."</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">payToAddress</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$amount</span><span class="enlighter-text">, </span><span class="enlighter-k7">$recipient</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Tx = </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">get</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$signer</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Signer</span><span class="enlighter-g1">(</span><span class="enlighter-k9">$this</span><span class="enlighter-text">Tx, </span><span class="enlighter-k7">$ecAdapter</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$signItems</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k7">$nIn</span><span class="enlighter-text">=</span><span class="enlighter-g1">&gt;</span><span class="enlighter-k7">$signItem</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$privateKey</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$privKeyFactory</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">fromHexCompressed</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$signItem</span><span class="enlighter-g1">[</span><span class="enlighter-text">0</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$scriptPubKey</span><span class="enlighter-text"> = ScriptFactory::</span><span class="enlighter-m0">fromHex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$signItem</span><span class="enlighter-g1">[</span><span class="enlighter-text">1</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$txOutput</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">TransactionOutput</span><span class="enlighter-g1">(</span><span class="enlighter-text">0, </span><span class="enlighter-k7">$scriptPubKey</span><span class="enlighter-text"> </span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$signer</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$signer</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">sign</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$nIn</span><span class="enlighter-text">, </span><span class="enlighter-k7">$privateKey</span><span class="enlighter-text">, </span><span class="enlighter-k7">$txOutput</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">    ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"alert alert-success"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">h6 </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"mt-3"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Final TX Hex</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/h6</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">textarea </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> rows=</span><span class="enlighter-s0">"5"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"comment"</span><span class="enlighter-text"> readonly</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$signer</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">get</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text">;?</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/textarea</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">catch</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">Exception </span><span class="enlighter-k7">$e</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$errmsg</span><span class="enlighter-text"> .= </span><span class="enlighter-s0">"Problem found. "</span><span class="enlighter-text"> . </span><span class="enlighter-k7">$e</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getMessage</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$errmsg</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"alert alert-danger"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">strong</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Error!</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/strong</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$errmsg</span><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">form action=</span><span class="enlighter-s0">''</span><span class="enlighter-text"> method=</span><span class="enlighter-s0">'post'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"network"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Network: </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">select name=</span><span class="enlighter-s0">"network"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"network"</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$networks</span><span class="enlighter-text"> = </span><span class="enlighter-m0">get_class_methods</span><span class="enlighter-g1">(</span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">NetworkFactory</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$networks</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k7">$network</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;option value='{$network}'"</span><span class="enlighter-text">.</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$network</span><span class="enlighter-text"> == </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'network'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">" selected"</span><span class="enlighter-text">: </span><span class="enlighter-s0">""</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span><span class="enlighter-s0">"&gt;{$network}&lt;/option&gt;"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/select</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"row"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"col-sm-6"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-row"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"no_of_inputs"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Inputs: </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">select </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"no_of_inputs"</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-text"> style=</span><span class="enlighter-s0">'width:auto;'</span><span class="enlighter-text"> onchange=</span><span class="enlighter-s0">"</span></div></div><div class=""><div><span class="enlighter-s0">                    var self = $(this);</span></div></div><div class=""><div><span class="enlighter-s0">                    var thisvalue = self.val();</span></div></div><div class=""><div><span class="enlighter-s0">                    var form = self.closest('form');</span></div></div><div class=""><div><span class="enlighter-s0">                    $('div[id^=row_input_]',form).hide();</span></div></div><div class=""><div><span class="enlighter-s0">                    for(var i=1; i&lt;= thisvalue; i++) { </span></div></div><div class=""><div><span class="enlighter-s0">                        $('div[id=row_input_'+  i + ']',form).show();</span></div></div><div class=""><div><span class="enlighter-s0">                    }</span></div></div><div class=""><div><span class="enlighter-s0">                    "</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$noOfInputs</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Input</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;option value='{$thisInput}'"</span><span class="enlighter-text">.</span><span class="enlighter-g1">(</span><span class="enlighter-k9">$this</span><span class="enlighter-text">Input == </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">" selected"</span><span class="enlighter-text">: </span><span class="enlighter-s0">""</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span><span class="enlighter-s0">"&gt;{$thisInput}&lt;/option&gt;"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/select</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$selectedNInputs</span><span class="enlighter-text"> = </span><span class="enlighter-m0">is_numeric</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> ? </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> : 1;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$noOfInputs</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Input</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-row"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">'row_input_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> style=</span><span class="enlighter-s0">"&lt;?php echo ($thisInput &gt; $selectedNInputs) ? "</span><span class="enlighter-text">display:none</span><span class="enlighter-s0">" : "</span><span class="enlighter-text">display:;</span><span class="enlighter-s0">"?&gt;"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-1"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        #</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Input?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-3"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">"UTXO Tx Hash"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'UTXO Tx Hash'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'utxo_hash_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["utxo_hash_{$thisInput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-1"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">"UTXO N Output"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'N'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'utxo_n_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["utxo_n_{$thisInput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-3"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">"UTXO ScriptPubKey"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'UTXO ScriptPubKey'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'utxo_script_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["utxo_script_{$thisInput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-4"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">"Private Key Hex, for signing purpose."</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'Private Key Hex'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'privkey_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["privkey_{$thisInput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"col-sm-6"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-row"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"no_of_outputs"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Outputs:</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">select </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"no_of_outputs"</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-text"> style=</span><span class="enlighter-s0">'width:auto;'</span><span class="enlighter-text"> onchange=</span><span class="enlighter-s0">"</span></div></div><div class=""><div><span class="enlighter-s0">                    var self = $(this);</span></div></div><div class=""><div><span class="enlighter-s0">                    var thisvalue = self.val();</span></div></div><div class=""><div><span class="enlighter-s0">                    var form = self.closest('form');</span></div></div><div class=""><div><span class="enlighter-s0">                    $('div[id^=row_output_]',form).hide();</span></div></div><div class=""><div><span class="enlighter-s0">                    for(var i=1; i&lt;= thisvalue; i++) { </span></div></div><div class=""><div><span class="enlighter-s0">                        $('div[id=row_output_'+  i + ']',form).show();</span></div></div><div class=""><div><span class="enlighter-s0">                    }</span></div></div><div class=""><div><span class="enlighter-s0">                    "</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$noOfOutputs</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;option value='{$thisOutput}'"</span><span class="enlighter-text">.</span><span class="enlighter-g1">(</span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output == </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">" selected"</span><span class="enlighter-text">: </span><span class="enlighter-s0">""</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span><span class="enlighter-s0">"&gt;{$thisOutput}&lt;/option&gt;"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/select</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$selectedNOutputs</span><span class="enlighter-text"> = </span><span class="enlighter-m0">is_numeric</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> ? </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> : 1;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$noOfOutputs</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-row"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">'row_output_&lt;?php echo $thisOutput?&gt;'</span><span class="enlighter-text"> style=</span><span class="enlighter-s0">"&lt;?php echo ($thisOutput &gt; $selectedNOutputs) ? "</span><span class="enlighter-text">display:none</span><span class="enlighter-s0">" : "</span><span class="enlighter-text">display:;</span><span class="enlighter-s0">"?&gt;"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col-sm-1"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        #</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col-sm-6"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'P2SH Address'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'address_&lt;?php echo $thisOutput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["address_{$thisOutput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col-sm-5"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'Amount'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'amount_&lt;?php echo $thisOutput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["amount_{$thisOutput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input type=</span><span class="enlighter-s0">'submit'</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"btn btn-success btn-block"</span><span class="enlighter-text">/</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/form</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"html_iframe_footer.php"</span><span class="enlighter-g1">)</span><span class="enlighter-text">;        </span></div></div></div><pre class="enlighter-raw">&lt;?php 
use BitWasp\Bitcoin\Network\NetworkFactory;
use BitWasp\Bitcoin\Bitcoin;
use BitWasp\Buffertools\Buffer;
use BitWasp\Bitcoin\Key\Factory\PrivateKeyFactory;
use BitWasp\Bitcoin\Address\AddressCreator;
use BitWasp\Bitcoin\Address\Base58AddressInterface;
use BitWasp\Bitcoin\Transaction\Factory\TxBuilder;
use BitWasp\Bitcoin\Transaction\TransactionFactory;
use BitWasp\Bitcoin\Transaction\TransactionOutput;
use BitWasp\Bitcoin\Transaction\Factory\Signer;
use BitWasp\Bitcoin\Script\ScriptFactory;
use BitWasp\Bitcoin\Script\Classifier\OutputClassifier;
use BitWasp\Bitcoin\Script\ScriptType;

include_once "../libraries/vendor/autoload.php";
include_once("html_iframe_header.php");

$noOfInputs = 10;
$noOfOutputs = 10;

if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    try {
        $networkClass   = $_POST['network'];
        Bitcoin::setNetwork(NetworkFactory::$networkClass());
        
        $network        = Bitcoin::getNetwork();
        $ecAdapter      = Bitcoin::getEcAdapter();
        $privKeyFactory = new PrivateKeyFactory();
        
        $addrCreator = new AddressCreator();
        
        $spendTx = TransactionFactory::build();
        
        $signItems = [];
        
        
        if (!is_numeric($_POST['no_of_inputs']) OR !is_numeric($_POST['no_of_outputs'])) {
            throw new Exception("Error in 'no_of_inputs' or 'no_of_outputs'.");
        }
            
        foreach(range(1,$_POST['no_of_inputs']) as $thisInput) {
            $utxoHash = trim($_POST["utxo_hash_{$thisInput}"]);
            $utxoNOutput = trim($_POST["utxo_n_{$thisInput}"]);
            $privkeyhex = trim($_POST["privkey_{$thisInput}"]);
            $utxoScript = trim($_POST["utxo_script_{$thisInput}"]);
            
            if (strlen($utxoHash)&gt;0 AND strlen($utxoNOutput) &gt; 0 AND strlen($privkeyhex) &gt; 0) {
                $spendTx = $spendTx-&gt;input($utxoHash, $utxoNOutput);
                $signItems[] = [$privkeyhex, $utxoScript];
            } else {
                throw new Exception("Error in 'input#{$thisInput}'.");
            }
        }
        
        foreach(range(1,$_POST['no_of_outputs']) as $thisOutput) {
            
            $address = trim($_POST["address_{$thisOutput}"]);
            
            $amount = trim($_POST["amount_{$thisOutput}"]);
            $recipient = $addrCreator-&gt;fromString($address);
            
            if (!strlen($address) or !strlen($amount)) {
                throw new Exception("Error in 'output#{$thisOutput}'.");
            }
            
            if (!$recipient instanceof Base58AddressInterface) {
                throw new Exception("Invalid P2SH address in 'output#{$thisOutput}' (Check base58Address).");
            } 
            
            $decodeScript = (new OutputClassifier())-&gt;decode($recipient-&gt;getScriptPubKey());
            
            if (!($decodeScript-&gt;getType() == ScriptType::P2SH OR $decodeScript-&gt;getType() == ScriptType::P2PKH)) {
                throw new Exception("Invalid P2SH address in 'output#{$thisOutput}' (Check scriptPubKey).");
            }
            
            $spendTx = $spendTx-&gt;payToAddress($amount, $recipient);
            
        }
        
        
        $thisTx = $spendTx-&gt;get();
        
        $signer = new Signer($thisTx, $ecAdapter);
        
        foreach($signItems as $nIn=&gt;$signItem) {
            $privateKey = $privKeyFactory-&gt;fromHexCompressed($signItem[0]);
            
            $scriptPubKey = ScriptFactory::fromHex($signItem[1]);
            
            $txOutput = new TransactionOutput(0, $scriptPubKey );
            $signer = $signer-&gt;sign($nIn, $privateKey, $txOutput);
        }
        
    ?&gt;
        &lt;div class="alert alert-success"&gt;
            &lt;h6 class="mt-3"&gt;Final TX Hex&lt;/h6&gt;
            
            &lt;textarea class="form-control" rows="5" id="comment" readonly&gt;&lt;?php echo $signer-&gt;get()-&gt;getHex();?&gt;&lt;/textarea&gt;
        &lt;/div&gt;
    &lt;?php
    
    } catch (Exception $e) {
        $errmsg .= "Problem found. " . $e-&gt;getMessage();

    }
}

if ($errmsg) {
?&gt;
    &lt;div class="alert alert-danger"&gt;
        &lt;strong&gt;Error!&lt;/strong&gt; &lt;?php echo $errmsg?&gt;
    &lt;/div&gt;
&lt;?php
}
?&gt;
&lt;form action='' method='post'&gt;
    &lt;div class="form-group"&gt;
        &lt;label for="network"&gt;Network: &lt;/label&gt;
        &lt;select name="network" id="network" class="form-control"&gt;
            &lt;?php
            $networks = get_class_methods(new NetworkFactory());
            foreach($networks as $network) {
                echo "&lt;option value='{$network}'".($network == $_POST['network'] ? " selected": "")."&gt;{$network}&lt;/option&gt;";
            }
            ?&gt;
        &lt;/select&gt;
    &lt;/div&gt;
    
    &lt;div class="row"&gt;
        &lt;div class="col-sm-6"&gt;
            
            &lt;div class="form-row"&gt;
                &lt;div class="form-group col"&gt;
                    &lt;label for="no_of_inputs"&gt;Inputs: &lt;/label&gt; 
                    &lt;select class="form-control" id="no_of_inputs" name='no_of_inputs' style='width:auto;' onchange="
                    var self = $(this);
                    var thisvalue = self.val();
                    var form = self.closest('form');
                    $('div[id^=row_input_]',form).hide();
                    for(var i=1; i&lt;= thisvalue; i++) { 
                        $('div[id=row_input_'+  i + ']',form).show();
                    }
                    "&gt;
                        &lt;?php
                        foreach(range(1,$noOfInputs) as $thisInput) {
                            echo "&lt;option value='{$thisInput}'".($thisInput == $_POST['no_of_inputs'] ? " selected": "")."&gt;{$thisInput}&lt;/option&gt;";
                        }
                        ?&gt;
                    &lt;/select&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            
            &lt;?php
            $selectedNInputs = is_numeric($_POST['no_of_inputs']) ? $_POST['no_of_inputs'] : 1;
            
            foreach(range(1,$noOfInputs) as $thisInput) {
            ?&gt;
            
                &lt;div class="form-row" id='row_input_&lt;?php echo $thisInput?&gt;' style="&lt;?php echo ($thisInput &gt; $selectedNInputs) ? "display:none" : "display:;"?&gt;"&gt;
                
                    &lt;div class="form-group  col-sm-1"&gt;
                        #&lt;?php echo $thisInput?&gt; 
                    &lt;/div&gt;
                    &lt;div class="form-group  col-sm-3"&gt;
                        
                        &lt;input class="form-control" title="UTXO Tx Hash" placeholder='UTXO Tx Hash' type='text' name='utxo_hash_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_hash_{$thisInput}"]?&gt;'&gt;
                    &lt;/div&gt;
                    &lt;div class="form-group  col-sm-1"&gt;
                        &lt;input class="form-control" title="UTXO N Output" placeholder='N' type='text' name='utxo_n_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_n_{$thisInput}"]?&gt;'&gt;
                    &lt;/div&gt;
                    
                    &lt;div class="form-group  col-sm-3"&gt;
                        &lt;input class="form-control" title="UTXO ScriptPubKey" placeholder='UTXO ScriptPubKey' type='text' name='utxo_script_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_script_{$thisInput}"]?&gt;'&gt;
                    &lt;/div&gt;
                    &lt;div class="form-group  col-sm-4"&gt;
                        &lt;input class="form-control" title="Private Key Hex, for signing purpose." placeholder='Private Key Hex' type='text' name='privkey_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["privkey_{$thisInput}"]?&gt;'&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;?php
            }
            ?&gt;
        &lt;/div&gt;
        &lt;div class="col-sm-6"&gt;
            &lt;div class="form-row"&gt;
                &lt;div class="form-group col"&gt;
                    &lt;label for="no_of_outputs"&gt;Outputs:&lt;/label&gt; &lt;select class="form-control" id="no_of_outputs" name='no_of_outputs' style='width:auto;' onchange="
                    var self = $(this);
                    var thisvalue = self.val();
                    var form = self.closest('form');
                    $('div[id^=row_output_]',form).hide();
                    for(var i=1; i&lt;= thisvalue; i++) { 
                        $('div[id=row_output_'+  i + ']',form).show();
                    }
                    "&gt;
                        &lt;?php
                        foreach(range(1,$noOfOutputs) as $thisOutput) {
                            echo "&lt;option value='{$thisOutput}'".($thisOutput == $_POST['no_of_outputs'] ? " selected": "")."&gt;{$thisOutput}&lt;/option&gt;";
                        }
                        ?&gt;
                    &lt;/select&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;?php
            $selectedNOutputs = is_numeric($_POST['no_of_outputs']) ? $_POST['no_of_outputs'] : 1;
            
            
            foreach(range(1,$noOfOutputs) as $thisOutput) {
            ?&gt;
                &lt;div class="form-row" id='row_output_&lt;?php echo $thisOutput?&gt;' style="&lt;?php echo ($thisOutput &gt; $selectedNOutputs) ? "display:none" : "display:;"?&gt;"&gt;
                    &lt;div class="form-group col-sm-1"&gt;
                        #&lt;?php echo $thisOutput?&gt; 
                    &lt;/div&gt;
                    
                    &lt;div class="form-group col-sm-6"&gt;
                        &lt;input class="form-control" placeholder='P2SH Address' type='text' name='address_&lt;?php echo $thisOutput?&gt;' value='&lt;?php echo $_POST["address_{$thisOutput}"]?&gt;'&gt;
                    &lt;/div&gt;
                    &lt;div class="form-group col-sm-5"&gt;
                        &lt;input class="form-control" placeholder='Amount' type='text' name='amount_&lt;?php echo $thisOutput?&gt;' value='&lt;?php echo $_POST["amount_{$thisOutput}"]?&gt;'&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
    &lt;?php
            }
    ?&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    
    &lt;input type='submit' class="btn btn-success btn-block"/&gt;
&lt;/form&gt;
&lt;?php
include_once("html_iframe_footer.php");        </pre></div><pre style="border-radius:none;" class="enlighter-origin">&lt;?php 
use BitWasp\Bitcoin\Network\NetworkFactory;
use BitWasp\Bitcoin\Bitcoin;
use BitWasp\Buffertools\Buffer;
use BitWasp\Bitcoin\Key\Factory\PrivateKeyFactory;
use BitWasp\Bitcoin\Address\AddressCreator;
use BitWasp\Bitcoin\Address\Base58AddressInterface;
use BitWasp\Bitcoin\Transaction\Factory\TxBuilder;
use BitWasp\Bitcoin\Transaction\TransactionFactory;
use BitWasp\Bitcoin\Transaction\TransactionOutput;
use BitWasp\Bitcoin\Transaction\Factory\Signer;
use BitWasp\Bitcoin\Script\ScriptFactory;
use BitWasp\Bitcoin\Script\Classifier\OutputClassifier;
use BitWasp\Bitcoin\Script\ScriptType;

include_once "../libraries/vendor/autoload.php";
include_once("html_iframe_header.php");

$noOfInputs = 10;
$noOfOutputs = 10;

if ($_SERVER['REQUEST_METHOD'] == 'POST') {
	try {
		$networkClass   = $_POST['network'];
		Bitcoin::setNetwork(NetworkFactory::$networkClass());
		
		$network        = Bitcoin::getNetwork();
		$ecAdapter      = Bitcoin::getEcAdapter();
		$privKeyFactory = new PrivateKeyFactory();
		
		$addrCreator = new AddressCreator();
		
		$spendTx = TransactionFactory::build();
		
		$signItems = [];
		
		
		if (!is_numeric($_POST['no_of_inputs']) OR !is_numeric($_POST['no_of_outputs'])) {
			throw new Exception("Error in 'no_of_inputs' or 'no_of_outputs'.");
		}
			
		foreach(range(1,$_POST['no_of_inputs']) as $thisInput) {
			$utxoHash = trim($_POST["utxo_hash_{$thisInput}"]);
			$utxoNOutput = trim($_POST["utxo_n_{$thisInput}"]);
			$privkeyhex = trim($_POST["privkey_{$thisInput}"]);
			$utxoScript = trim($_POST["utxo_script_{$thisInput}"]);
			
			if (strlen($utxoHash)&gt;0 AND strlen($utxoNOutput) &gt; 0 AND strlen($privkeyhex) &gt; 0) {
				$spendTx = $spendTx-&gt;input($utxoHash, $utxoNOutput);
				$signItems[] = [$privkeyhex, $utxoScript];
			} else {
				throw new Exception("Error in 'input#{$thisInput}'.");
			}
		}
		
		foreach(range(1,$_POST['no_of_outputs']) as $thisOutput) {
			
			$address = trim($_POST["address_{$thisOutput}"]);
			
			$amount = trim($_POST["amount_{$thisOutput}"]);
			$recipient = $addrCreator-&gt;fromString($address);
			
			if (!strlen($address) or !strlen($amount)) {
				throw new Exception("Error in 'output#{$thisOutput}'.");
			}
			
			if (!$recipient instanceof Base58AddressInterface) {
				throw new Exception("Invalid P2SH address in 'output#{$thisOutput}' (Check base58Address).");
			} 
			
			$decodeScript = (new OutputClassifier())-&gt;decode($recipient-&gt;getScriptPubKey());
			
			if (!($decodeScript-&gt;getType() == ScriptType::P2SH OR $decodeScript-&gt;getType() == ScriptType::P2PKH)) {
				throw new Exception("Invalid P2SH address in 'output#{$thisOutput}' (Check scriptPubKey).");
			}
			
			$spendTx = $spendTx-&gt;payToAddress($amount, $recipient);
			
		}
		
		
		$thisTx = $spendTx-&gt;get();
		
		$signer = new Signer($thisTx, $ecAdapter);
		
		foreach($signItems as $nIn=&gt;$signItem) {
			$privateKey = $privKeyFactory-&gt;fromHexCompressed($signItem[0]);
			
			$scriptPubKey = ScriptFactory::fromHex($signItem[1]);
			
			$txOutput = new TransactionOutput(0, $scriptPubKey );
			$signer = $signer-&gt;sign($nIn, $privateKey, $txOutput);
		}
		
	?&gt;
		&lt;div class="alert alert-success"&gt;
			&lt;h6 class="mt-3"&gt;Final TX Hex&lt;/h6&gt;
			
			&lt;textarea class="form-control" rows="5" id="comment" readonly&gt;&lt;?php echo $signer-&gt;get()-&gt;getHex();?&gt;&lt;/textarea&gt;
		&lt;/div&gt;
	&lt;?php
	
	} catch (Exception $e) {
		$errmsg .= "Problem found. " . $e-&gt;getMessage();

	}
}

if ($errmsg) {
?&gt;
	&lt;div class="alert alert-danger"&gt;
		&lt;strong&gt;Error!&lt;/strong&gt; &lt;?php echo $errmsg?&gt;
	&lt;/div&gt;
&lt;?php
}
?&gt;
&lt;form action='' method='post'&gt;
	&lt;div class="form-group"&gt;
		&lt;label for="network"&gt;Network: &lt;/label&gt;
		&lt;select name="network" id="network" class="form-control"&gt;
			&lt;?php
			$networks = get_class_methods(new NetworkFactory());
			foreach($networks as $network) {
				echo "&lt;option value='{$network}'".($network == $_POST['network'] ? " selected": "")."&gt;{$network}&lt;/option&gt;";
			}
			?&gt;
		&lt;/select&gt;
	&lt;/div&gt;
	
	&lt;div class="row"&gt;
		&lt;div class="col-sm-6"&gt;
			
			&lt;div class="form-row"&gt;
				&lt;div class="form-group col"&gt;
					&lt;label for="no_of_inputs"&gt;Inputs: &lt;/label&gt; 
					&lt;select class="form-control" id="no_of_inputs" name='no_of_inputs' style='width:auto;' onchange="
					var self = $(this);
					var thisvalue = self.val();
					var form = self.closest('form');
					$('div[id^=row_input_]',form).hide();
					for(var i=1; i&lt;= thisvalue; i++) { 
						$('div[id=row_input_'+  i + ']',form).show();
					}
					"&gt;
						&lt;?php
						foreach(range(1,$noOfInputs) as $thisInput) {
							echo "&lt;option value='{$thisInput}'".($thisInput == $_POST['no_of_inputs'] ? " selected": "")."&gt;{$thisInput}&lt;/option&gt;";
						}
						?&gt;
					&lt;/select&gt;
				&lt;/div&gt;
			&lt;/div&gt;
			
			&lt;?php
			$selectedNInputs = is_numeric($_POST['no_of_inputs']) ? $_POST['no_of_inputs'] : 1;
			
			foreach(range(1,$noOfInputs) as $thisInput) {
			?&gt;
			
				&lt;div class="form-row" id='row_input_&lt;?php echo $thisInput?&gt;' style="&lt;?php echo ($thisInput &gt; $selectedNInputs) ? "display:none" : "display:;"?&gt;"&gt;
				
					&lt;div class="form-group  col-sm-1"&gt;
						#&lt;?php echo $thisInput?&gt; 
					&lt;/div&gt;
					&lt;div class="form-group  col-sm-3"&gt;
						
						&lt;input class="form-control" title="UTXO Tx Hash" placeholder='UTXO Tx Hash' type='text' name='utxo_hash_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_hash_{$thisInput}"]?&gt;'&gt;
					&lt;/div&gt;
					&lt;div class="form-group  col-sm-1"&gt;
						&lt;input class="form-control" title="UTXO N Output" placeholder='N' type='text' name='utxo_n_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_n_{$thisInput}"]?&gt;'&gt;
					&lt;/div&gt;
					
					&lt;div class="form-group  col-sm-3"&gt;
						&lt;input class="form-control" title="UTXO ScriptPubKey" placeholder='UTXO ScriptPubKey' type='text' name='utxo_script_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_script_{$thisInput}"]?&gt;'&gt;
					&lt;/div&gt;
					&lt;div class="form-group  col-sm-4"&gt;
						&lt;input class="form-control" title="Private Key Hex, for signing purpose." placeholder='Private Key Hex' type='text' name='privkey_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["privkey_{$thisInput}"]?&gt;'&gt;
					&lt;/div&gt;
				&lt;/div&gt;
			&lt;?php
			}
			?&gt;
		&lt;/div&gt;
		&lt;div class="col-sm-6"&gt;
			&lt;div class="form-row"&gt;
				&lt;div class="form-group col"&gt;
					&lt;label for="no_of_outputs"&gt;Outputs:&lt;/label&gt; &lt;select class="form-control" id="no_of_outputs" name='no_of_outputs' style='width:auto;' onchange="
					var self = $(this);
					var thisvalue = self.val();
					var form = self.closest('form');
					$('div[id^=row_output_]',form).hide();
					for(var i=1; i&lt;= thisvalue; i++) { 
						$('div[id=row_output_'+  i + ']',form).show();
					}
					"&gt;
						&lt;?php
						foreach(range(1,$noOfOutputs) as $thisOutput) {
							echo "&lt;option value='{$thisOutput}'".($thisOutput == $_POST['no_of_outputs'] ? " selected": "")."&gt;{$thisOutput}&lt;/option&gt;";
						}
						?&gt;
					&lt;/select&gt;
				&lt;/div&gt;
			&lt;/div&gt;
			&lt;?php
			$selectedNOutputs = is_numeric($_POST['no_of_outputs']) ? $_POST['no_of_outputs'] : 1;
			
			
			foreach(range(1,$noOfOutputs) as $thisOutput) {
			?&gt;
				&lt;div class="form-row" id='row_output_&lt;?php echo $thisOutput?&gt;' style="&lt;?php echo ($thisOutput &gt; $selectedNOutputs) ? "display:none" : "display:;"?&gt;"&gt;
					&lt;div class="form-group col-sm-1"&gt;
						#&lt;?php echo $thisOutput?&gt; 
					&lt;/div&gt;
					
					&lt;div class="form-group col-sm-6"&gt;
						&lt;input class="form-control" placeholder='P2SH Address' type='text' name='address_&lt;?php echo $thisOutput?&gt;' value='&lt;?php echo $_POST["address_{$thisOutput}"]?&gt;'&gt;
					&lt;/div&gt;
					&lt;div class="form-group col-sm-5"&gt;
						&lt;input class="form-control" placeholder='Amount' type='text' name='amount_&lt;?php echo $thisOutput?&gt;' value='&lt;?php echo $_POST["amount_{$thisOutput}"]?&gt;'&gt;
					&lt;/div&gt;
				&lt;/div&gt;
	&lt;?php
			}
	?&gt;
		&lt;/div&gt;
	&lt;/div&gt;
	
	&lt;input type='submit' class="btn btn-success btn-block"/&gt;
&lt;/form&gt;
&lt;?php
include_once("html_iframe_footer.php");		</pre> 
	</div>
	
	<div id="form2_tabitem7" class="tab-pane fade">
		<iframe src="./Bitcoin P2SH.LOCKTIME_files/bitcoin_script_p2sh_csv_spend.html" width="100%" scrolling="no" frameborder="no" id="iFrameResizer5" style="overflow: hidden; height: 0px;"></iframe>
	</div>
	<div id="form2_tabitem8" class="tab-pane fade">
		<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"></div><div class="enlighter-btn enlighter-btn-copy"></div><div class="enlighter-btn enlighter-btn-window"></div><div class="enlighter-btn enlighter-btn-website"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Buffertools\Buffer;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Network\NetworkFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Address\AddressCreator;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Address\PayToPubKeyHashAddress;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Bitcoin;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Key\Factory\PrivateKeyFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Transaction\Factory\Signer;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Transaction\Factory\SignData;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Transaction\TransactionFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Transaction\TransactionOutput;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\Classifier\OutputClassifier;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\ScriptType;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\ScriptFactory;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Script\P2shScript;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">use</span><span class="enlighter-text"> BitWasp\Bitcoin\Signature\TransactionSignature;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-text"> </span><span class="enlighter-s0">"../libraries/vendor/autoload.php"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$noOfInputs</span><span class="enlighter-text"> = 10;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k7">$noOfOutputs</span><span class="enlighter-text"> = 10;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_SERVER</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'REQUEST_METHOD'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> == </span><span class="enlighter-s0">'GET'</span><span class="enlighter-text"> AND </span><span class="enlighter-k7">$_GET</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'ajax'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> == </span><span class="enlighter-s0">'1'</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k7">$data</span><span class="enlighter-text"> = </span><span class="enlighter-g1">[]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">!</span><span class="enlighter-m0">ctype_xdigit</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_GET</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'utx'</span><span class="enlighter-g1">]))</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$data</span><span class="enlighter-text"> = </span><span class="enlighter-g1">[</span><span class="enlighter-s0">"error"</span><span class="enlighter-text">=</span><span class="enlighter-g1">&gt;</span><span class="enlighter-s0">"UTX must be hex."</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$utxHex</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$_GET</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'utx'</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$utx</span><span class="enlighter-text"> = TransactionFactory::</span><span class="enlighter-m0">fromHex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$utxHex</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$outputs</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$utx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getOutputs</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$data</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'txHash'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$utx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getTxHash</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">flip</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-c0">;//swap endianess</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$data</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'outputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> = </span><span class="enlighter-g1">[]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">@</span><span class="enlighter-m0">count</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$outputs</span><span class="enlighter-g1">))</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$outputs</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k7">$k</span><span class="enlighter-text">=</span><span class="enlighter-g1">&gt;</span><span class="enlighter-k7">$output</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$k</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text"> 10</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-c0"> //limit to retrieve max 10 inputs only</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-k7">$decodeScript</span><span class="enlighter-text"> = </span><span class="enlighter-g1">(</span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">OutputClassifier</span><span class="enlighter-g1">())</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">decode</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$output</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScript</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                        </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$decodeScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getType</span><span class="enlighter-g1">()</span><span class="enlighter-text"> != ScriptType::</span><span class="enlighter-m2">P2SH</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-k7">$data</span><span class="enlighter-text"> = </span><span class="enlighter-g1">[</span><span class="enlighter-s0">"error"</span><span class="enlighter-text">=</span><span class="enlighter-g1">&gt;</span><span class="enlighter-s0">"Load fail! Your unspent transaction output (utxo) can only contain P2SH ScriptPubKey."</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-k1">break</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-k7">$data</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'outputs'</span><span class="enlighter-g1">][]</span><span class="enlighter-text"> = </span><span class="enlighter-g1">[</span><span class="enlighter-s0">"amount"</span><span class="enlighter-text">=</span><span class="enlighter-g1">&gt;</span><span class="enlighter-k7">$output</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getValue</span><span class="enlighter-g1">()</span><span class="enlighter-text">, </span><span class="enlighter-s0">"n"</span><span class="enlighter-text">=</span><span class="enlighter-g1">&gt;</span><span class="enlighter-k7">$k</span><span class="enlighter-text">, </span><span class="enlighter-s0">"scriptPubKey"</span><span class="enlighter-text">=</span><span class="enlighter-g1">&gt;</span><span class="enlighter-k7">$output</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScript</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k0">die</span><span class="enlighter-g1">(</span><span class="enlighter-m0">json_encode</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$data</span><span class="enlighter-g1">))</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"html_iframe_header.php"</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">'vertical-line-yellow'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">h6 </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"mt-3"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">To success spend of OP_CSV, following requirements must meet:</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/h6</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">ul</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">li</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Transaction must be version </span><span class="enlighter-n0">2.</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/li</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">li</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">If relative lock-time flag detected in input</span><span class="enlighter-s0">'s nSequence, then UTXO'</span><span class="enlighter-text">s block MTP must satisfy </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">  chain</span><span class="enlighter-s0">'s MTP.&lt;/li&gt;    </span></div></div><div class=""><div><span class="enlighter-s0">        &lt;li&gt;if block height detected in input'</span><span class="enlighter-text">s nSequence, then UTXO</span><span class="enlighter-s0">'s block height must satisfy &lt; chain'</span><span class="enlighter-text">s block height + </span><span class="enlighter-n0">1.</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/li</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">li</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">expiry time</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> in redeem script must </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">= nSequence.</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/li</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/ul</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_SERVER</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'REQUEST_METHOD'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> == </span><span class="enlighter-s0">'POST'</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k1">try</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$networkClass</span><span class="enlighter-text">   = </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'network'</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        Bitcoin::</span><span class="enlighter-m0">setNetwork</span><span class="enlighter-g1">(</span><span class="enlighter-text">NetworkFactory::</span><span class="enlighter-k7">$networkClass</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$network</span><span class="enlighter-text">        = Bitcoin::</span><span class="enlighter-m0">getNetwork</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$ecAdapter</span><span class="enlighter-text">      = Bitcoin::</span><span class="enlighter-m0">getEcAdapter</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$privKeyFactory</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">PrivateKeyFactory</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$addrCreator</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">AddressCreator</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text"> = TransactionFactory::</span><span class="enlighter-m0">build</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">version</span><span class="enlighter-g1">(</span><span class="enlighter-text">2</span><span class="enlighter-g1">)</span><span class="enlighter-c0">;//important</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$signItems</span><span class="enlighter-text"> = </span><span class="enlighter-g1">[]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">!</span><span class="enlighter-m0">strlen</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'utx'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> </span><span class="enlighter-k3">or</span><span class="enlighter-text"> !</span><span class="enlighter-m0">ctype_xdigit</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'utx'</span><span class="enlighter-g1">]))</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text">                    </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"UTX must be hex."</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">!</span><span class="enlighter-m0">is_numeric</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> OR !</span><span class="enlighter-m0">is_numeric</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">]))</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Error in 'no_of_inputs' or 'no_of_outputs'."</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$utxHex</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'utx'</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$utx</span><span class="enlighter-text"> = TransactionFactory::</span><span class="enlighter-m0">fromHex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$utxHex</span><span class="enlighter-g1">)</span><span class="enlighter-text">;    </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$utxos</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$utx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getOutputs</span><span class="enlighter-g1">()</span><span class="enlighter-text">;    </span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$utxos</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k7">$k</span><span class="enlighter-text">=</span><span class="enlighter-g1">&gt;</span><span class="enlighter-k7">$utxo</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$privateKey</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$privKeyFactory</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">fromHexCompressed</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"privkey_"</span><span class="enlighter-text"> . </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$k</span><span class="enlighter-text">+1</span><span class="enlighter-g1">)])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$utxoScript</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$utxo</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScript</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"redeemscript_"</span><span class="enlighter-text"> . </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$k</span><span class="enlighter-text">+1</span><span class="enlighter-g1">)])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">P2shScript</span><span class="enlighter-g1">(</span><span class="enlighter-text">ScriptFactory::</span><span class="enlighter-m0">fromHex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-g1">))</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$timeParam</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScriptParser</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHumanReadable</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$timeParam</span><span class="enlighter-text"> = </span><span class="enlighter-m0">strstr</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$timeParam</span><span class="enlighter-text">, </span><span class="enlighter-s0">' '</span><span class="enlighter-text">, </span><span class="enlighter-e0">true</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-m0">preg_match</span><span class="enlighter-g1">(</span><span class="enlighter-s0">'/^OP_/'</span><span class="enlighter-text">, </span><span class="enlighter-k7">$timeParam</span><span class="enlighter-g1">))</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k7">$timeParam</span><span class="enlighter-text"> = </span><span class="enlighter-m0">ltrim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$timeParam</span><span class="enlighter-text">, </span><span class="enlighter-s0">'OP_'</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k7">$timeParam</span><span class="enlighter-text"> = </span><span class="enlighter-g1">(</span><span class="enlighter-k5">int</span><span class="enlighter-g1">)</span><span class="enlighter-k7">$timeParam</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k7">$sequence</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$timeParam</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k7">$sequence</span><span class="enlighter-text"> = Buffer::</span><span class="enlighter-m0">hex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$timeParam</span><span class="enlighter-g1">)</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">flip</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getInt</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$p2shScriptPubKey</span><span class="enlighter-text"> = ScriptFactory::</span><span class="enlighter-m0">scriptPubKey</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">p2sh</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getScriptHash</span><span class="enlighter-g1">()</span><span class="enlighter-c1">/*sha256*/</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$utxoScript</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text"> != </span><span class="enlighter-k7">$p2shScriptPubKey</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">())</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Error in 'input#{$k}'. Redeem script is not matched to UTXO's ScriptPubKey."</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$signData</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">SignData</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$signData</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">p2sh</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$redeemScript</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$signItems</span><span class="enlighter-g1">[]</span><span class="enlighter-text"> = </span><span class="enlighter-g1">[</span><span class="enlighter-text"> </span><span class="enlighter-k7">$privateKey</span><span class="enlighter-text">, </span><span class="enlighter-k7">$signData</span><span class="enlighter-text"> </span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">spendOutputFrom</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$utx</span><span class="enlighter-text">, </span><span class="enlighter-k7">$k</span><span class="enlighter-text">, </span><span class="enlighter-e1">null</span><span class="enlighter-text">, </span><span class="enlighter-k7">$sequence</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$address</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"address_{$thisOutput}"</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$amount</span><span class="enlighter-text"> = </span><span class="enlighter-m0">trim</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">"amount_{$thisOutput}"</span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-m0">strlen</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$address</span><span class="enlighter-g1">)&gt;</span><span class="enlighter-text">0 AND </span><span class="enlighter-m0">strlen</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$amount</span><span class="enlighter-g1">)&gt;</span><span class="enlighter-text">0</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k7">$recipient</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$addrCreator</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">fromString</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$address</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">payToAddress</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$amount</span><span class="enlighter-text">, </span><span class="enlighter-k7">$recipient</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k1">throw</span><span class="enlighter-text"> </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Exception</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Error in 'output#{$thisOutput}'."</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Tx = </span><span class="enlighter-k7">$spendTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">get</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$finalTx</span><span class="enlighter-text"> = TransactionFactory::</span><span class="enlighter-m0">mutate</span><span class="enlighter-g1">(</span><span class="enlighter-k9">$this</span><span class="enlighter-text">Tx</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$mutable</span><span class="enlighter-text"> = TransactionFactory::</span><span class="enlighter-m0">mutate</span><span class="enlighter-g1">(</span><span class="enlighter-k9">$this</span><span class="enlighter-text">Tx</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$sigHashType</span><span class="enlighter-text"> = 1;</span><span class="enlighter-c0"> //ALL</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$signItems</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k7">$nIn</span><span class="enlighter-text">=</span><span class="enlighter-g1">&gt;</span><span class="enlighter-k7">$signItem</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$privateKey</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$signItem</span><span class="enlighter-g1">[</span><span class="enlighter-text">0</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$signData</span><span class="enlighter-text">   = </span><span class="enlighter-k7">$signItem</span><span class="enlighter-g1">[</span><span class="enlighter-text">1</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$input</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$mutable</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">inputsMutator</span><span class="enlighter-g1">()[</span><span class="enlighter-k7">$nIn</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$input</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">script</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$signData</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getRedeemScript</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$finalSignData</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$mutable</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">done</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text"> .  </span><span class="enlighter-m0">bin2hex</span><span class="enlighter-g1">(</span><span class="enlighter-m0">pack</span><span class="enlighter-g1">(</span><span class="enlighter-s0">'V'</span><span class="enlighter-text">, </span><span class="enlighter-k7">$sigHashType</span><span class="enlighter-g1">))</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$finalSignData</span><span class="enlighter-text"> = </span><span class="enlighter-m0">hash</span><span class="enlighter-g1">(</span><span class="enlighter-s0">'sha256'</span><span class="enlighter-text">, </span><span class="enlighter-m0">hex2bin</span><span class="enlighter-g1">(</span><span class="enlighter-m0">hash</span><span class="enlighter-g1">(</span><span class="enlighter-s0">'sha256'</span><span class="enlighter-text">, </span><span class="enlighter-m0">hex2bin</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$finalSignData</span><span class="enlighter-g1">))))</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$txSig</span><span class="enlighter-text"> = </span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">TransactionSignature</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$ecAdapter</span><span class="enlighter-text">, </span><span class="enlighter-k7">$privateKey</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">sign</span><span class="enlighter-g1">(</span><span class="enlighter-text">Buffer::</span><span class="enlighter-m0">hex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$finalSignData</span><span class="enlighter-g1">))</span><span class="enlighter-text">, </span><span class="enlighter-k7">$sigHashType</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$derSigHex</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$txSig</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getSignature</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getBuffer</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text"> . Buffer::</span><span class="enlighter-k5">int</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$sigHashType</span><span class="enlighter-text">, 1</span><span class="enlighter-g1">)</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$input</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$finalTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">inputsMutator</span><span class="enlighter-g1">()[</span><span class="enlighter-k7">$nIn</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$inputSig</span><span class="enlighter-text"> = ScriptFactory::</span><span class="enlighter-m0">sequence</span><span class="enlighter-g1">(</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">[</span><span class="enlighter-text">Buffer::</span><span class="enlighter-m0">hex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$derSigHex</span><span class="enlighter-g1">)</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">                 Buffer::</span><span class="enlighter-m0">hex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$privateKey</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getPublicKey</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">())</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">                 Buffer::</span><span class="enlighter-m0">hex</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$signData</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getRedeemScript</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">())</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">])</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$input</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">script</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$inputSig</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">    ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"alert alert-success"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">h6 </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"mt-3"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Final TX Hex</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/h6</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">textarea </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> rows=</span><span class="enlighter-s0">"5"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"comment"</span><span class="enlighter-text"> readonly</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$finalTx</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">done</span><span class="enlighter-g1">()</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getHex</span><span class="enlighter-g1">()</span><span class="enlighter-text">;?</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/textarea</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">catch</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">Exception </span><span class="enlighter-k7">$e</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k7">$errmsg</span><span class="enlighter-text"> .= </span><span class="enlighter-s0">"Problem found. "</span><span class="enlighter-text"> . </span><span class="enlighter-k7">$e</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-m0">getMessage</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$errmsg</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"alert alert-danger"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">strong</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Error!</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/strong</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$errmsg</span><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">form action=</span><span class="enlighter-s0">'?tab=form2_tabitem3#hashtag2'</span><span class="enlighter-text"> method=</span><span class="enlighter-s0">'post'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"network"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Network: </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">select name=</span><span class="enlighter-s0">"network"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"network"</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$networks</span><span class="enlighter-text"> = </span><span class="enlighter-m0">get_class_methods</span><span class="enlighter-g1">(</span><span class="enlighter-k3">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">NetworkFactory</span><span class="enlighter-g1">())</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$networks</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k7">$network</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;option value='{$network}'"</span><span class="enlighter-text">.</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$network</span><span class="enlighter-text"> == </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'network'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">" selected"</span><span class="enlighter-text">: </span><span class="enlighter-s0">""</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span><span class="enlighter-s0">"&gt;{$network}&lt;/option&gt;"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/select</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"utx"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Unspent </span><span class="enlighter-m0">Transaction</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">Hex</span><span class="enlighter-g1">)</span><span class="enlighter-text">:</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"input-group mb-3"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'utx'</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">'utx'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST['</span><span class="enlighter-text">utx</span><span class="enlighter-s0">']?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"input-group-append"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"btn btn-success"</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">"button"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"form2_tabitem3_load"</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">"Load"</span><span class="enlighter-text"> onclick=</span><span class="enlighter-s0">"</span></div></div><div class=""><div><span class="enlighter-s0">                var self = $(this);</span></div></div><div class=""><div><span class="enlighter-s0">                self.val('......'); </span></div></div><div class=""><div><span class="enlighter-s0">                </span></div></div><div class=""><div><span class="enlighter-s0">                var form = self.closest('form');</span></div></div><div class=""><div><span class="enlighter-s0">                var allInputDivs = form.find('div[id^=row_input_]');</span></div></div><div class=""><div><span class="enlighter-s0">                var allInputs = $( ':input', allInputDivs );</span></div></div><div class=""><div><span class="enlighter-s0">                allInputs.val('');</span></div></div><div class=""><div><span class="enlighter-s0">                allInputDivs.hide();</span></div></div><div class=""><div><span class="enlighter-s0">                $('select#no_of_inputs',form).empty();</span></div></div><div class=""><div><span class="enlighter-s0">                $('span#total_inputs',form).html('0');</span></div></div><div class=""><div><span class="enlighter-s0">                $.ajax({</span></div></div><div class=""><div><span class="enlighter-s0">                    url: '?ajax=1&amp;utx=' + $('input#utx',form).val(), </span></div></div><div class=""><div><span class="enlighter-s0">                    </span></div></div><div class=""><div><span class="enlighter-s0">                    error:function() {</span></div></div><div class=""><div><span class="enlighter-s0">                        </span></div></div><div class=""><div><span class="enlighter-s0">                    },</span></div></div><div class=""><div><span class="enlighter-s0">                    </span></div></div><div class=""><div><span class="enlighter-s0">                    success:function(result){</span></div></div><div class=""><div><span class="enlighter-s0">                        try {</span></div></div><div class=""><div><span class="enlighter-s0">                            j = eval('(' + result + ')');</span></div></div><div class=""><div><span class="enlighter-s0">                            </span></div></div><div class=""><div><span class="enlighter-s0">                            if ('error' in j &amp;&amp; j.error.length&gt;0) {</span></div></div><div class=""><div><span class="enlighter-s0">                                var error = true;</span></div></div><div class=""><div><span class="enlighter-s0">                            } else {</span></div></div><div class=""><div><span class="enlighter-s0">                                var error = false;</span></div></div><div class=""><div><span class="enlighter-s0">                            }</span></div></div><div class=""><div><span class="enlighter-s0">                            </span></div></div><div class=""><div><span class="enlighter-s0">                            if (!error) {</span></div></div><div class=""><div><span class="enlighter-s0">                                var txHash = j.txHash;</span></div></div><div class=""><div><span class="enlighter-s0">                                var outputs = j.outputs;</span></div></div><div class=""><div><span class="enlighter-s0">                                var totalInputs = 0;</span></div></div><div class=""><div><span class="enlighter-s0">                                </span></div></div><div class=""><div><span class="enlighter-s0">                                if (outputs.length &gt; 0) {</span></div></div><div class=""><div><span class="enlighter-s0">                                    </span></div></div><div class=""><div><span class="enlighter-s0">                                    </span></div></div><div class=""><div><span class="enlighter-s0">                                    $('select#no_of_inputs',form).prepend('&lt;option value=\''+outputs.length+'\' selected=\'selected\'&gt;'+outputs.length+'&lt;/option&gt;');</span></div></div><div class=""><div><span class="enlighter-s0">                                    </span></div></div><div class=""><div><span class="enlighter-s0">                                    var x;    </span></div></div><div class=""><div><span class="enlighter-s0">                                    for (x in outputs) {</span></div></div><div class=""><div><span class="enlighter-s0">                                        var divid = parseInt(x) + 1;</span></div></div><div class=""><div><span class="enlighter-s0">                                        var amount = parseInt(outputs[x].amount);</span></div></div><div class=""><div><span class="enlighter-s0">                                        totalInputs += amount;</span></div></div><div class=""><div><span class="enlighter-s0">                                        </span></div></div><div class=""><div><span class="enlighter-s0">                                        $('div#row_input_' + divid             ,form).show();</span></div></div><div class=""><div><span class="enlighter-s0">                                        $('input[name=utxo_hash_' + divid+']'  ,form).val(txHash);</span></div></div><div class=""><div><span class="enlighter-s0">                                        $('input[name=utxo_n_' + divid+']'     ,form).val(outputs[x].n);</span></div></div><div class=""><div><span class="enlighter-s0">                                        $('input[name=utxo_script_' + divid+']',form).val(outputs[x].scriptPubKey);</span></div></div><div class=""><div><span class="enlighter-s0">                                        $('input[name=utxo_amount_' + divid+']',form).val(amount);</span></div></div><div class=""><div><span class="enlighter-s0">                                        $('input[name=privkey_'+divid+']'      ,form).removeAttr('readonly');</span></div></div><div class=""><div><span class="enlighter-s0">                                    }</span></div></div><div class=""><div><span class="enlighter-s0">                                }</span></div></div><div class=""><div><span class="enlighter-s0">                                </span></div></div><div class=""><div><span class="enlighter-s0">                                $('span#total_inputs',form).html(totalInputs);</span></div></div><div class=""><div><span class="enlighter-s0">                            } else {</span></div></div><div class=""><div><span class="enlighter-s0">                                alert(j.error);</span></div></div><div class=""><div><span class="enlighter-s0">                            }</span></div></div><div class=""><div><span class="enlighter-s0">                        } catch(e) {</span></div></div><div class=""><div><span class="enlighter-s0">                            alert('Invalid Json Format.');</span></div></div><div class=""><div><span class="enlighter-s0">                        }</span></div></div><div class=""><div><span class="enlighter-s0">                    },</span></div></div><div class=""><div><span class="enlighter-s0">                    complete:function() {</span></div></div><div class=""><div><span class="enlighter-s0">                        self.val('Load');</span></div></div><div class=""><div><span class="enlighter-s0">                    }</span></div></div><div class=""><div><span class="enlighter-s0">                });</span></div></div><div class=""><div><span class="enlighter-s0">                "</span><span class="enlighter-text">/</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"row"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"col-sm-6"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-row"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"no_of_inputs"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Inputs: </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">i</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Max 10 inputs only. Please load them from UTX above.</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/i</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                    </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"row"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"col-sm-2"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">select </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"no_of_inputs"</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-text"> style=</span><span class="enlighter-s0">'width:auto;'</span><span class="enlighter-text"> onchange=</span><span class="enlighter-s0">"</span></div></div><div class=""><div><span class="enlighter-s0">                            var self = $(this);</span></div></div><div class=""><div><span class="enlighter-s0">                            var thisvalue = self.val();</span></div></div><div class=""><div><span class="enlighter-s0">                            var form = self.closest('form');</span></div></div><div class=""><div><span class="enlighter-s0">                            $('div[id^=row_input_]',form).hide();</span></div></div><div class=""><div><span class="enlighter-s0">                            for(var i=1; i&lt;= thisvalue; i++) { </span></div></div><div class=""><div><span class="enlighter-s0">                                $('div[id=row_input_'+  i + ']',form).show();</span></div></div><div class=""><div><span class="enlighter-s0">                            }</span></div></div><div class=""><div><span class="enlighter-s0">                            "</span><span class="enlighter-text"> readonly</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k7">$optionval</span><span class="enlighter-text"> = </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text">?</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> : 0;</span></div></div><div class=""><div><span class="enlighter-text">                                </span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k7">$optionval</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> 0</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">option value=</span><span class="enlighter-s0">'&lt;?php echo $optionval?&gt;'</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k7">$optionval</span><span class="enlighter-text">?</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/option</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/select</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"col-sm-10"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            Total Sathoshi: </span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">span id=</span><span class="enlighter-s0">'total_inputs'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-m0">array_reduce</span><span class="enlighter-g1">(</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-m0">array_keys</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">)</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-k0">function</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$carry</span><span class="enlighter-text">, </span><span class="enlighter-k7">$key</span><span class="enlighter-g1">)</span><span class="enlighter-text">  </span><span class="enlighter-g1">{</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                                    </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-m0">preg_match</span><span class="enlighter-g1">(</span><span class="enlighter-s0">'/^utxo_amount_/'</span><span class="enlighter-text">, </span><span class="enlighter-k7">$key</span><span class="enlighter-g1">))</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                        </span><span class="enlighter-k0">return</span><span class="enlighter-text"> </span><span class="enlighter-k7">$carry</span><span class="enlighter-text"> + </span><span class="enlighter-g1">(</span><span class="enlighter-k5">int</span><span class="enlighter-g1">)</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-k7">$key</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                                    </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-k1">else</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text">                    </span></div></div><div class=""><div><span class="enlighter-text">                                        </span><span class="enlighter-k0">return</span><span class="enlighter-text"> </span><span class="enlighter-k7">$carry</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                                    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                                </span><span class="enlighter-g1">}</span><span class="enlighter-text">, 0</span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">)</span><span class="enlighter-text">;?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/span</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$selectedNInputs</span><span class="enlighter-text"> = </span><span class="enlighter-m0">is_numeric</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> ? </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_inputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> : 0;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$noOfInputs</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Input</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-row"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">'row_input_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> style=</span><span class="enlighter-s0">"&lt;?php echo ($thisInput &gt; $selectedNInputs) ? "</span><span class="enlighter-text">display:none</span><span class="enlighter-s0">" : "</span><span class="enlighter-text">display:;</span><span class="enlighter-s0">"?&gt;"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input type=</span><span class="enlighter-s0">'hidden'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'utxo_amount_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["utxo_amount_{$thisInput}"]?&gt;'</span><span class="enlighter-text">/</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-1"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        #</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Input?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-3"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">"UTXO Tx Hash"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'UTXO Tx Hash'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'utxo_hash_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["utxo_hash_{$thisInput}"]?&gt;'</span><span class="enlighter-text"> readonly</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-1"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">"UTXO N Output"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'N'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'utxo_n_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["utxo_n_{$thisInput}"]?&gt;'</span><span class="enlighter-text"> readonly</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-3"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">"UTXO ScriptPubKey"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'UTXO ScriptPubKey'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'utxo_script_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["utxo_script_{$thisInput}"]?&gt;'</span><span class="enlighter-text"> readonly</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-4"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> title=</span><span class="enlighter-s0">"Private Key Hex, for signing purpose."</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'Private Key Hex'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'privkey_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["privkey_{$thisInput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-1"</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group  col-sm-11"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'Redeem Script'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'redeemscript_&lt;?php echo $thisInput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["redeemscript_{$thisInput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"col-sm-6"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-row"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">label </span><span class="enlighter-k1">for</span><span class="enlighter-text">=</span><span class="enlighter-s0">"no_of_outputs"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">Outputs:</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/label</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">select </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"no_of_outputs"</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-text"> style=</span><span class="enlighter-s0">'width:auto;'</span><span class="enlighter-text"> onchange=</span><span class="enlighter-s0">"</span></div></div><div class=""><div><span class="enlighter-s0">                    var self = $(this);</span></div></div><div class=""><div><span class="enlighter-s0">                    var thisvalue = self.val();</span></div></div><div class=""><div><span class="enlighter-s0">                    var form = self.closest('form');</span></div></div><div class=""><div><span class="enlighter-s0">                    $('div[id^=row_output_]',form).hide();</span></div></div><div class=""><div><span class="enlighter-s0">                    for(var i=1; i&lt;= thisvalue; i++) { </span></div></div><div class=""><div><span class="enlighter-s0">                        $('div[id=row_output_'+  i + ']',form).show();</span></div></div><div class=""><div><span class="enlighter-s0">                    }</span></div></div><div class=""><div><span class="enlighter-s0">                    "</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$noOfOutputs</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                            </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;option value='{$thisOutput}'"</span><span class="enlighter-text">.</span><span class="enlighter-g1">(</span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output == </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> ? </span><span class="enlighter-s0">" selected"</span><span class="enlighter-text">: </span><span class="enlighter-s0">""</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span><span class="enlighter-s0">"&gt;{$thisOutput}&lt;/option&gt;"</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/select</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k7">$selectedNOutputs</span><span class="enlighter-text"> = </span><span class="enlighter-m0">is_numeric</span><span class="enlighter-g1">(</span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">])</span><span class="enlighter-text"> ? </span><span class="enlighter-k7">$_POST</span><span class="enlighter-g1">[</span><span class="enlighter-s0">'no_of_outputs'</span><span class="enlighter-g1">]</span><span class="enlighter-text"> : 1;</span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">foreach</span><span class="enlighter-g1">(</span><span class="enlighter-m0">range</span><span class="enlighter-g1">(</span><span class="enlighter-text">1,</span><span class="enlighter-k7">$noOfOutputs</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-k1">as</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-row"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">'row_output_&lt;?php echo $thisOutput?&gt;'</span><span class="enlighter-text"> style=</span><span class="enlighter-s0">"&lt;?php echo ($thisOutput &gt; $selectedNOutputs) ? "</span><span class="enlighter-text">display:none</span><span class="enlighter-s0">" : "</span><span class="enlighter-text">display:;</span><span class="enlighter-s0">"?&gt;"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col-sm-1"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        #</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php </span><span class="enlighter-k0">echo</span><span class="enlighter-text"> </span><span class="enlighter-k9">$this</span><span class="enlighter-text">Output?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col-sm-6"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'Any Address'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'address_&lt;?php echo $thisOutput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["address_{$thisOutput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-group col-sm-5"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"form-control"</span><span class="enlighter-text"> placeholder=</span><span class="enlighter-s0">'Amount'</span><span class="enlighter-text"> type=</span><span class="enlighter-s0">'text'</span><span class="enlighter-text"> name=</span><span class="enlighter-s0">'amount_&lt;?php echo $thisOutput?&gt;'</span><span class="enlighter-text"> value=</span><span class="enlighter-s0">'&lt;?php echo $_POST["amount_{$thisOutput}"]?&gt;'</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    ?</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">input type=</span><span class="enlighter-s0">'submit'</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"btn btn-success btn-block"</span><span class="enlighter-text">/</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/form</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">!-- The Modal --</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"modal"</span><span class="enlighter-text"> id=</span><span class="enlighter-s0">"myModal"</span><span class="enlighter-text"> data-backdrop=</span><span class="enlighter-s0">"false"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"modal-dialog"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"modal-content"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">!-- Modal Header --</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"modal-header"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">h4 </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"modal-title"</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">span id=</span><span class="enlighter-s0">'network_display'</span><span class="enlighter-g1">&gt;&lt;</span><span class="enlighter-text">/span</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">: Height &amp; MTP</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/h4</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">button type=</span><span class="enlighter-s0">"button"</span><span class="enlighter-text"> </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"close"</span><span class="enlighter-text"> data-dismiss=</span><span class="enlighter-s0">"modal"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">&amp;times;</span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/button</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">!-- Modal body --</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">div </span><span class="enlighter-k0">class</span><span class="enlighter-text">=</span><span class="enlighter-s0">"modal-body"</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">/div</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">?php</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">include_once</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"html_iframe_footer.php"</span><span class="enlighter-g1">)</span><span class="enlighter-text">;        </span></div></div></div><pre class="enlighter-raw">&lt;?php 
use BitWasp\Buffertools\Buffer;
use BitWasp\Bitcoin\Network\NetworkFactory;
use BitWasp\Bitcoin\Address\AddressCreator;
use BitWasp\Bitcoin\Address\PayToPubKeyHashAddress;
use BitWasp\Bitcoin\Bitcoin;
use BitWasp\Bitcoin\Key\Factory\PrivateKeyFactory;
use BitWasp\Bitcoin\Transaction\Factory\Signer;
use BitWasp\Bitcoin\Transaction\Factory\SignData;
use BitWasp\Bitcoin\Transaction\TransactionFactory;
use BitWasp\Bitcoin\Transaction\TransactionOutput;
use BitWasp\Bitcoin\Script\Classifier\OutputClassifier;
use BitWasp\Bitcoin\Script\ScriptType;
use BitWasp\Bitcoin\Script\ScriptFactory;
use BitWasp\Bitcoin\Script\P2shScript;
use BitWasp\Bitcoin\Signature\TransactionSignature;

include_once "../libraries/vendor/autoload.php";
$noOfInputs = 10;
$noOfOutputs = 10;

if ($_SERVER['REQUEST_METHOD'] == 'GET' AND $_GET['ajax'] == '1') {
    $data = [];
    if (!ctype_xdigit($_GET['utx'])) {
        $data = ["error"=&gt;"UTX must be hex."];
    } else {
        $utxHex = $_GET['utx'];
        $utx = TransactionFactory::fromHex($utxHex);
        $outputs = $utx-&gt;getOutputs();
        
        $data['txHash'] = $utx-&gt;getTxHash()-&gt;flip()-&gt;getHex();//swap endianess
        $data['outputs'] = [];
        if (@count($outputs)) {
            foreach($outputs as $k=&gt;$output) {
                if ($k &lt; 10) { //limit to retrieve max 10 inputs only
                
                    $decodeScript = (new OutputClassifier())-&gt;decode($output-&gt;getScript());
                        
                    if ($decodeScript-&gt;getType() != ScriptType::P2SH) {
                        $data = ["error"=&gt;"Load fail! Your unspent transaction output (utxo) can only contain P2SH ScriptPubKey."];
                        break;
                    }
                    $data['outputs'][] = ["amount"=&gt;$output-&gt;getValue(), "n"=&gt;$k, "scriptPubKey"=&gt;$output-&gt;getScript()-&gt;getHex()];
                }
            }
        }
    }
    
    die(json_encode($data));
}

include_once("html_iframe_header.php");
?&gt;
&lt;div class='vertical-line-yellow'&gt;
    &lt;h6 class="mt-3"&gt;To success spend of OP_CSV, following requirements must meet:&lt;/h6&gt;
    
    &lt;ul&gt;
        &lt;li&gt;Transaction must be version 2.&lt;/li&gt;
        &lt;li&gt;If relative lock-time flag detected in input's nSequence, then UTXO's block MTP must satisfy &lt;  chain's MTP.&lt;/li&gt;    
        &lt;li&gt;if block height detected in input's nSequence, then UTXO's block height must satisfy &lt; chain's block height + 1.&lt;/li&gt;
        &lt;li&gt;&lt;expiry time&gt; in redeem script must &lt;= nSequence.&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;
&lt;?php
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    
    try {
        $networkClass   = $_POST['network'];
        Bitcoin::setNetwork(NetworkFactory::$networkClass());
        
        $network        = Bitcoin::getNetwork();
        $ecAdapter      = Bitcoin::getEcAdapter();
        $privKeyFactory = new PrivateKeyFactory();
        
        $addrCreator = new AddressCreator();
        
        $spendTx = TransactionFactory::build();
        $spendTx-&gt;version(2);//important
        $signItems = [];
        
        if (!strlen($_POST['utx']) or !ctype_xdigit($_POST['utx'])) {                    
            throw new Exception("UTX must be hex.");
        } 
        
        if (!is_numeric($_POST['no_of_inputs']) OR !is_numeric($_POST['no_of_outputs'])) {
            throw new Exception("Error in 'no_of_inputs' or 'no_of_outputs'.");
        }
        
        $utxHex = $_POST['utx'];
        $utx = TransactionFactory::fromHex($utxHex);    
        $utxos = $utx-&gt;getOutputs();    
        
        foreach($utxos as $k=&gt;$utxo) {
            $privateKey = $privKeyFactory-&gt;fromHexCompressed($_POST["privkey_" . ($k+1)]);
            $utxoScript = $utxo-&gt;getScript();
            $redeemScript = trim($_POST["redeemscript_" . ($k+1)]);
            $redeemScript = new P2shScript(ScriptFactory::fromHex($redeemScript));
            
            $timeParam = $redeemScript-&gt;getScriptParser()-&gt;getHumanReadable();
            $timeParam = strstr($timeParam, ' ', true);
            
            if (preg_match('/^OP_/', $timeParam)) {
                $timeParam = ltrim($timeParam, 'OP_');
                $timeParam = (int)$timeParam;
                $sequence = $timeParam;
            } else {
                $sequence = Buffer::hex($timeParam)-&gt;flip()-&gt;getInt();
            }
            
            $p2shScriptPubKey = ScriptFactory::scriptPubKey()-&gt;p2sh($redeemScript-&gt;getScriptHash()/*sha256*/);
            
            if ($utxoScript-&gt;getHex() != $p2shScriptPubKey-&gt;getHex()) {
                throw new Exception("Error in 'input#{$k}'. Redeem script is not matched to UTXO's ScriptPubKey.");
            }
            
            $signData = new SignData();
            $signData-&gt;p2sh($redeemScript);
            
            $signItems[] = [ $privateKey, $signData ];
            $spendTx = $spendTx-&gt;spendOutputFrom($utx, $k, null, $sequence);
        }
        
        foreach(range(1,$_POST['no_of_outputs']) as $thisOutput) {
            
            $address = trim($_POST["address_{$thisOutput}"]);
            $amount = trim($_POST["amount_{$thisOutput}"]);
            
            if (strlen($address)&gt;0 AND strlen($amount)&gt;0) {
                $recipient = $addrCreator-&gt;fromString($address);
                $spendTx = $spendTx-&gt;payToAddress($amount, $recipient);
            } else {
                throw new Exception("Error in 'output#{$thisOutput}'.");
            }
        }
        
        $thisTx = $spendTx-&gt;get();
        $finalTx = TransactionFactory::mutate($thisTx);
        $mutable = TransactionFactory::mutate($thisTx);
        $sigHashType = 1; //ALL
        foreach($signItems as $nIn=&gt;$signItem) {
            $privateKey = $signItem[0];
            $signData   = $signItem[1];
            $input = $mutable-&gt;inputsMutator()[$nIn];
            $input-&gt;script($signData-&gt;getRedeemScript());
            $finalSignData = $mutable-&gt;done()-&gt;getHex() .  bin2hex(pack('V', $sigHashType));
            $finalSignData = hash('sha256', hex2bin(hash('sha256', hex2bin($finalSignData))));
            $txSig = new TransactionSignature($ecAdapter, $privateKey-&gt;sign(Buffer::hex($finalSignData)), $sigHashType);
            $derSigHex = $txSig-&gt;getSignature()-&gt;getBuffer()-&gt;getHex() . Buffer::int($sigHashType, 1)-&gt;getHex();
            
            $input = $finalTx-&gt;inputsMutator()[$nIn];
            $inputSig = ScriptFactory::sequence(
                [Buffer::hex($derSigHex),
                 Buffer::hex($privateKey-&gt;getPublicKey()-&gt;getHex()),
                 Buffer::hex($signData-&gt;getRedeemScript()-&gt;getHex())
                ]);
            $input-&gt;script($inputSig);
        }
        
    ?&gt;
        &lt;div class="alert alert-success"&gt;
            &lt;h6 class="mt-3"&gt;Final TX Hex&lt;/h6&gt;
            
            &lt;textarea class="form-control" rows="5" id="comment" readonly&gt;&lt;?php echo $finalTx-&gt;done()-&gt;getHex();?&gt;&lt;/textarea&gt;
        &lt;/div&gt;
    &lt;?php
    
    } catch (Exception $e) {
        $errmsg .= "Problem found. " . $e-&gt;getMessage();

    }
}

if ($errmsg) {
?&gt;
    &lt;div class="alert alert-danger"&gt;
        &lt;strong&gt;Error!&lt;/strong&gt; &lt;?php echo $errmsg?&gt;
    &lt;/div&gt;
&lt;?php
}
?&gt;
&lt;form action='?tab=form2_tabitem3#hashtag2' method='post'&gt;
    &lt;div class="form-group"&gt;
        &lt;label for="network"&gt;Network: &lt;/label&gt;
        &lt;select name="network" id="network" class="form-control"&gt;
            &lt;?php
            $networks = get_class_methods(new NetworkFactory());
            foreach($networks as $network) {
                echo "&lt;option value='{$network}'".($network == $_POST['network'] ? " selected": "")."&gt;{$network}&lt;/option&gt;";
            }
            ?&gt;
        &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class="form-group"&gt;
        &lt;label for="utx"&gt;Unspent Transaction (Hex):&lt;/label&gt;
        
        &lt;div class="input-group mb-3"&gt;
            &lt;input class="form-control" type='text' name='utx' id='utx' value='&lt;?php echo $_POST['utx']?&gt;'&gt;
            &lt;div class="input-group-append"&gt;
                &lt;input class="btn btn-success" type="button" id="form2_tabitem3_load" value="Load" onclick="
                var self = $(this);
                self.val('......'); 
                
                var form = self.closest('form');
                var allInputDivs = form.find('div[id^=row_input_]');
                var allInputs = $( ':input', allInputDivs );
                allInputs.val('');
                allInputDivs.hide();
                $('select#no_of_inputs',form).empty();
                $('span#total_inputs',form).html('0');
                $.ajax({
                    url: '?ajax=1&amp;utx=' + $('input#utx',form).val(), 
                    
                    error:function() {
                        
                    },
                    
                    success:function(result){
                        try {
                            j = eval('(' + result + ')');
                            
                            if ('error' in j &amp;&amp; j.error.length&gt;0) {
                                var error = true;
                            } else {
                                var error = false;
                            }
                            
                            if (!error) {
                                var txHash = j.txHash;
                                var outputs = j.outputs;
                                var totalInputs = 0;
                                
                                if (outputs.length &gt; 0) {
                                    
                                    
                                    $('select#no_of_inputs',form).prepend('&lt;option value=\''+outputs.length+'\' selected=\'selected\'&gt;'+outputs.length+'&lt;/option&gt;');
                                    
                                    var x;    
                                    for (x in outputs) {
                                        var divid = parseInt(x) + 1;
                                        var amount = parseInt(outputs[x].amount);
                                        totalInputs += amount;
                                        
                                        $('div#row_input_' + divid             ,form).show();
                                        $('input[name=utxo_hash_' + divid+']'  ,form).val(txHash);
                                        $('input[name=utxo_n_' + divid+']'     ,form).val(outputs[x].n);
                                        $('input[name=utxo_script_' + divid+']',form).val(outputs[x].scriptPubKey);
                                        $('input[name=utxo_amount_' + divid+']',form).val(amount);
                                        $('input[name=privkey_'+divid+']'      ,form).removeAttr('readonly');
                                    }
                                }
                                
                                $('span#total_inputs',form).html(totalInputs);
                            } else {
                                alert(j.error);
                            }
                        } catch(e) {
                            alert('Invalid Json Format.');
                        }
                    },
                    complete:function() {
                        self.val('Load');
                    }
                });
                "/&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="row"&gt;
        &lt;div class="col-sm-6"&gt;
            
            &lt;div class="form-row"&gt;
                &lt;div class="form-group col"&gt;
                    &lt;label for="no_of_inputs"&gt;Inputs: &lt;i&gt;Max 10 inputs only. Please load them from UTX above.&lt;/i&gt;&lt;/label&gt; 
                    
                    &lt;div class="row"&gt;
                        &lt;div class="col-sm-2"&gt;
                            &lt;select class="form-control" id="no_of_inputs" name='no_of_inputs' style='width:auto;' onchange="
                            var self = $(this);
                            var thisvalue = self.val();
                            var form = self.closest('form');
                            $('div[id^=row_input_]',form).hide();
                            for(var i=1; i&lt;= thisvalue; i++) { 
                                $('div[id=row_input_'+  i + ']',form).show();
                            }
                            " readonly&gt;
                                &lt;?php
                                $optionval = $_POST['no_of_inputs']?$_POST['no_of_inputs'] : 0;
                                
                                if ($optionval &gt; 0) {
                                ?&gt;
                                &lt;option value='&lt;?php echo $optionval?&gt;'&gt;&lt;?php echo $optionval?&gt;&lt;/option&gt;
                                &lt;?php
                                }
                                ?&gt;
                            &lt;/select&gt;
                        &lt;/div&gt;
                        
                        &lt;div class="col-sm-10"&gt;
                            Total Sathoshi: 
                            &lt;span id='total_inputs'&gt;
                            &lt;?php echo 
                            array_reduce(
                                array_keys($_POST),
                                function($carry, $key)  { 
                                    if (preg_match('/^utxo_amount_/', $key)) {
                                        return $carry + (int)$_POST[$key];
                                    } else {                    
                                        return $carry;
                                    }
                                }, 0
                            );?&gt;
                            &lt;/span&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            
            &lt;?php
            $selectedNInputs = is_numeric($_POST['no_of_inputs']) ? $_POST['no_of_inputs'] : 0;
            
            foreach(range(1,$noOfInputs) as $thisInput) {
            ?&gt;
            
                &lt;div class="form-row" id='row_input_&lt;?php echo $thisInput?&gt;' style="&lt;?php echo ($thisInput &gt; $selectedNInputs) ? "display:none" : "display:;"?&gt;"&gt;
                    &lt;input type='hidden' name='utxo_amount_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_amount_{$thisInput}"]?&gt;'/&gt;
                    
                    &lt;div class="form-group  col-sm-1"&gt;
                        #&lt;?php echo $thisInput?&gt; 
                    &lt;/div&gt;
                    &lt;div class="form-group  col-sm-3"&gt;    
                        &lt;input class="form-control" title="UTXO Tx Hash" placeholder='UTXO Tx Hash' type='text' name='utxo_hash_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_hash_{$thisInput}"]?&gt;' readonly&gt;
                    &lt;/div&gt;
                    &lt;div class="form-group  col-sm-1"&gt;
                        &lt;input class="form-control" title="UTXO N Output" placeholder='N' type='text' name='utxo_n_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_n_{$thisInput}"]?&gt;' readonly&gt;
                    &lt;/div&gt;
                    &lt;div class="form-group  col-sm-3"&gt;
                        &lt;input class="form-control" title="UTXO ScriptPubKey" placeholder='UTXO ScriptPubKey' type='text' name='utxo_script_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_script_{$thisInput}"]?&gt;' readonly&gt;
                    &lt;/div&gt;
                    &lt;div class="form-group  col-sm-4"&gt;
                        &lt;input class="form-control" title="Private Key Hex, for signing purpose." placeholder='Private Key Hex' type='text' name='privkey_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["privkey_{$thisInput}"]?&gt;'&gt;
                    &lt;/div&gt;
                    
                    &lt;div class="form-group  col-sm-1" &gt;
                    
                    &lt;/div&gt;
                    &lt;div class="form-group  col-sm-11"&gt;
                        &lt;input class="form-control" placeholder='Redeem Script' type='text' name='redeemscript_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["redeemscript_{$thisInput}"]?&gt;'&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;?php
            }
            ?&gt;
        &lt;/div&gt;
        &lt;div class="col-sm-6"&gt;
            &lt;div class="form-row"&gt;
                &lt;div class="form-group col"&gt;
                    &lt;label for="no_of_outputs"&gt;Outputs:&lt;/label&gt; &lt;select class="form-control" id="no_of_outputs" name='no_of_outputs' style='width:auto;' onchange="
                    var self = $(this);
                    var thisvalue = self.val();
                    var form = self.closest('form');
                    $('div[id^=row_output_]',form).hide();
                    for(var i=1; i&lt;= thisvalue; i++) { 
                        $('div[id=row_output_'+  i + ']',form).show();
                    }
                    "&gt;
                        &lt;?php
                        foreach(range(1,$noOfOutputs) as $thisOutput) {
                            echo "&lt;option value='{$thisOutput}'".($thisOutput == $_POST['no_of_outputs'] ? " selected": "")."&gt;{$thisOutput}&lt;/option&gt;";
                        }
                        ?&gt;
                    &lt;/select&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;?php
            $selectedNOutputs = is_numeric($_POST['no_of_outputs']) ? $_POST['no_of_outputs'] : 1;
            
            
            foreach(range(1,$noOfOutputs) as $thisOutput) {
            ?&gt;
                &lt;div class="form-row" id='row_output_&lt;?php echo $thisOutput?&gt;' style="&lt;?php echo ($thisOutput &gt; $selectedNOutputs) ? "display:none" : "display:;"?&gt;"&gt;
                    &lt;div class="form-group col-sm-1"&gt;
                        #&lt;?php echo $thisOutput?&gt; 
                    &lt;/div&gt;
                    
                    &lt;div class="form-group col-sm-6"&gt;
                        &lt;input class="form-control" placeholder='Any Address' type='text' name='address_&lt;?php echo $thisOutput?&gt;' value='&lt;?php echo $_POST["address_{$thisOutput}"]?&gt;'&gt;
                    &lt;/div&gt;
                    &lt;div class="form-group col-sm-5"&gt;
                        &lt;input class="form-control" placeholder='Amount' type='text' name='amount_&lt;?php echo $thisOutput?&gt;' value='&lt;?php echo $_POST["amount_{$thisOutput}"]?&gt;'&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
    &lt;?php
            }
    ?&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    
    &lt;input type='submit' class="btn btn-success btn-block"/&gt;
&lt;/form&gt;
&lt;!-- The Modal --&gt;
&lt;div class="modal" id="myModal" data-backdrop="false"&gt;
    &lt;div class="modal-dialog"&gt;
        &lt;div class="modal-content"&gt;

            &lt;!-- Modal Header --&gt;
            &lt;div class="modal-header"&gt;
                &lt;h4 class="modal-title"&gt;&lt;span id='network_display'&gt;&lt;/span&gt;: Height &amp; MTP&lt;/h4&gt;
                &lt;button type="button" class="close" data-dismiss="modal"&gt;&amp;times;&lt;/button&gt;
            &lt;/div&gt;

            &lt;!-- Modal body --&gt;
            &lt;div class="modal-body"&gt;
        
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;?php
include_once("html_iframe_footer.php");        </pre></div><pre style="border-radius:none;" class="enlighter-origin">&lt;?php 
use BitWasp\Buffertools\Buffer;
use BitWasp\Bitcoin\Network\NetworkFactory;
use BitWasp\Bitcoin\Address\AddressCreator;
use BitWasp\Bitcoin\Address\PayToPubKeyHashAddress;
use BitWasp\Bitcoin\Bitcoin;
use BitWasp\Bitcoin\Key\Factory\PrivateKeyFactory;
use BitWasp\Bitcoin\Transaction\Factory\Signer;
use BitWasp\Bitcoin\Transaction\Factory\SignData;
use BitWasp\Bitcoin\Transaction\TransactionFactory;
use BitWasp\Bitcoin\Transaction\TransactionOutput;
use BitWasp\Bitcoin\Script\Classifier\OutputClassifier;
use BitWasp\Bitcoin\Script\ScriptType;
use BitWasp\Bitcoin\Script\ScriptFactory;
use BitWasp\Bitcoin\Script\P2shScript;
use BitWasp\Bitcoin\Signature\TransactionSignature;

include_once "../libraries/vendor/autoload.php";
$noOfInputs = 10;
$noOfOutputs = 10;

if ($_SERVER['REQUEST_METHOD'] == 'GET' AND $_GET['ajax'] == '1') {
	$data = [];
	if (!ctype_xdigit($_GET['utx'])) {
		$data = ["error"=&gt;"UTX must be hex."];
	} else {
		$utxHex = $_GET['utx'];
		$utx = TransactionFactory::fromHex($utxHex);
		$outputs = $utx-&gt;getOutputs();
		
		$data['txHash'] = $utx-&gt;getTxHash()-&gt;flip()-&gt;getHex();//swap endianess
		$data['outputs'] = [];
		if (@count($outputs)) {
			foreach($outputs as $k=&gt;$output) {
				if ($k &lt; 10) { //limit to retrieve max 10 inputs only
				
					$decodeScript = (new OutputClassifier())-&gt;decode($output-&gt;getScript());
						
					if ($decodeScript-&gt;getType() != ScriptType::P2SH) {
						$data = ["error"=&gt;"Load fail! Your unspent transaction output (utxo) can only contain P2SH ScriptPubKey."];
						break;
					}
					$data['outputs'][] = ["amount"=&gt;$output-&gt;getValue(), "n"=&gt;$k, "scriptPubKey"=&gt;$output-&gt;getScript()-&gt;getHex()];
				}
			}
		}
	}
	
	die(json_encode($data));
}

include_once("html_iframe_header.php");
?&gt;
&lt;div class='vertical-line-yellow'&gt;
	&lt;h6 class="mt-3"&gt;To success spend of OP_CSV, following requirements must meet:&lt;/h6&gt;
	
	&lt;ul&gt;
		&lt;li&gt;Transaction must be version 2.&lt;/li&gt;
		&lt;li&gt;If relative lock-time flag detected in input's nSequence, then UTXO's block MTP must satisfy &amp;lt;  chain's MTP.&lt;/li&gt;	
		&lt;li&gt;if block height detected in input's nSequence, then UTXO's block height must satisfy &amp;lt; chain's block height + 1.&lt;/li&gt;
		&lt;li&gt;&amp;lt;expiry time&amp;gt; in redeem script must &amp;lt;= nSequence.&lt;/li&gt;
	&lt;/ul&gt;
&lt;/div&gt;
&lt;?php
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
	
	try {
		$networkClass   = $_POST['network'];
		Bitcoin::setNetwork(NetworkFactory::$networkClass());
		
		$network        = Bitcoin::getNetwork();
		$ecAdapter      = Bitcoin::getEcAdapter();
		$privKeyFactory = new PrivateKeyFactory();
		
		$addrCreator = new AddressCreator();
		
		$spendTx = TransactionFactory::build();
		$spendTx-&gt;version(2);//important
		$signItems = [];
		
		if (!strlen($_POST['utx']) or !ctype_xdigit($_POST['utx'])) {                    
			throw new Exception("UTX must be hex.");
		} 
		
		if (!is_numeric($_POST['no_of_inputs']) OR !is_numeric($_POST['no_of_outputs'])) {
			throw new Exception("Error in 'no_of_inputs' or 'no_of_outputs'.");
		}
		
		$utxHex = $_POST['utx'];
		$utx = TransactionFactory::fromHex($utxHex);    
		$utxos = $utx-&gt;getOutputs();	
		
		foreach($utxos as $k=&gt;$utxo) {
			$privateKey = $privKeyFactory-&gt;fromHexCompressed($_POST["privkey_" . ($k+1)]);
			$utxoScript = $utxo-&gt;getScript();
			$redeemScript = trim($_POST["redeemscript_" . ($k+1)]);
			$redeemScript = new P2shScript(ScriptFactory::fromHex($redeemScript));
			
			$timeParam = $redeemScript-&gt;getScriptParser()-&gt;getHumanReadable();
			$timeParam = strstr($timeParam, ' ', true);
			
			if (preg_match('/^OP_/', $timeParam)) {
				$timeParam = ltrim($timeParam, 'OP_');
				$timeParam = (int)$timeParam;
				$sequence = $timeParam;
			} else {
				$sequence = Buffer::hex($timeParam)-&gt;flip()-&gt;getInt();
			}
			
			$p2shScriptPubKey = ScriptFactory::scriptPubKey()-&gt;p2sh($redeemScript-&gt;getScriptHash()/*sha256*/);
			
			if ($utxoScript-&gt;getHex() != $p2shScriptPubKey-&gt;getHex()) {
				throw new Exception("Error in 'input#{$k}'. Redeem script is not matched to UTXO's ScriptPubKey.");
			}
			
			$signData = new SignData();
			$signData-&gt;p2sh($redeemScript);
			
			$signItems[] = [ $privateKey, $signData ];
			$spendTx = $spendTx-&gt;spendOutputFrom($utx, $k, null, $sequence);
		}
		
		foreach(range(1,$_POST['no_of_outputs']) as $thisOutput) {
			
			$address = trim($_POST["address_{$thisOutput}"]);
			$amount = trim($_POST["amount_{$thisOutput}"]);
			
			if (strlen($address)&gt;0 AND strlen($amount)&gt;0) {
				$recipient = $addrCreator-&gt;fromString($address);
				$spendTx = $spendTx-&gt;payToAddress($amount, $recipient);
			} else {
				throw new Exception("Error in 'output#{$thisOutput}'.");
			}
		}
		
		$thisTx = $spendTx-&gt;get();
		$finalTx = TransactionFactory::mutate($thisTx);
		$mutable = TransactionFactory::mutate($thisTx);
		$sigHashType = 1; //ALL
		foreach($signItems as $nIn=&gt;$signItem) {
			$privateKey = $signItem[0];
			$signData   = $signItem[1];
			$input = $mutable-&gt;inputsMutator()[$nIn];
			$input-&gt;script($signData-&gt;getRedeemScript());
			$finalSignData = $mutable-&gt;done()-&gt;getHex() .  bin2hex(pack('V', $sigHashType));
			$finalSignData = hash('sha256', hex2bin(hash('sha256', hex2bin($finalSignData))));
			$txSig = new TransactionSignature($ecAdapter, $privateKey-&gt;sign(Buffer::hex($finalSignData)), $sigHashType);
			$derSigHex = $txSig-&gt;getSignature()-&gt;getBuffer()-&gt;getHex() . Buffer::int($sigHashType, 1)-&gt;getHex();
			
			$input = $finalTx-&gt;inputsMutator()[$nIn];
			$inputSig = ScriptFactory::sequence(
				[Buffer::hex($derSigHex),
				 Buffer::hex($privateKey-&gt;getPublicKey()-&gt;getHex()),
				 Buffer::hex($signData-&gt;getRedeemScript()-&gt;getHex())
				]);
			$input-&gt;script($inputSig);
		}
		
	?&gt;
		&lt;div class="alert alert-success"&gt;
			&lt;h6 class="mt-3"&gt;Final TX Hex&lt;/h6&gt;
			
			&lt;textarea class="form-control" rows="5" id="comment" readonly&gt;&lt;?php echo $finalTx-&gt;done()-&gt;getHex();?&gt;&lt;/textarea&gt;
		&lt;/div&gt;
	&lt;?php
	
	} catch (Exception $e) {
		$errmsg .= "Problem found. " . $e-&gt;getMessage();

	}
}

if ($errmsg) {
?&gt;
	&lt;div class="alert alert-danger"&gt;
		&lt;strong&gt;Error!&lt;/strong&gt; &lt;?php echo $errmsg?&gt;
	&lt;/div&gt;
&lt;?php
}
?&gt;
&lt;form action='?tab=form2_tabitem3#hashtag2' method='post'&gt;
	&lt;div class="form-group"&gt;
		&lt;label for="network"&gt;Network: &lt;/label&gt;
		&lt;select name="network" id="network" class="form-control"&gt;
			&lt;?php
			$networks = get_class_methods(new NetworkFactory());
			foreach($networks as $network) {
				echo "&lt;option value='{$network}'".($network == $_POST['network'] ? " selected": "")."&gt;{$network}&lt;/option&gt;";
			}
			?&gt;
		&lt;/select&gt;
	&lt;/div&gt;
	&lt;div class="form-group"&gt;
		&lt;label for="utx"&gt;Unspent Transaction (Hex):&lt;/label&gt;
		
		&lt;div class="input-group mb-3"&gt;
			&lt;input class="form-control" type='text' name='utx' id='utx' value='&lt;?php echo $_POST['utx']?&gt;'&gt;
			&lt;div class="input-group-append"&gt;
				&lt;input class="btn btn-success" type="button" id="form2_tabitem3_load" value="Load" onclick="
				var self = $(this);
				self.val('......'); 
				
				var form = self.closest('form');
				var allInputDivs = form.find('div[id^=row_input_]');
				var allInputs = $( ':input', allInputDivs );
				allInputs.val('');
				allInputDivs.hide();
				$('select#no_of_inputs',form).empty();
				$('span#total_inputs',form).html('0');
				$.ajax({
					url: '?ajax=1&amp;utx=' + $('input#utx',form).val(), 
					
					error:function() {
						
					},
					
					success:function(result){
						try {
							j = eval('(' + result + ')');
							
							if ('error' in j &amp;&amp; j.error.length&gt;0) {
								var error = true;
							} else {
								var error = false;
							}
							
							if (!error) {
								var txHash = j.txHash;
								var outputs = j.outputs;
								var totalInputs = 0;
								
								if (outputs.length &gt; 0) {
									
									
									$('select#no_of_inputs',form).prepend('&lt;option value=\''+outputs.length+'\' selected=\'selected\'&gt;'+outputs.length+'&lt;/option&gt;');
									
									var x;    
									for (x in outputs) {
										var divid = parseInt(x) + 1;
										var amount = parseInt(outputs[x].amount);
										totalInputs += amount;
										
										$('div#row_input_' + divid             ,form).show();
										$('input[name=utxo_hash_' + divid+']'  ,form).val(txHash);
										$('input[name=utxo_n_' + divid+']'     ,form).val(outputs[x].n);
										$('input[name=utxo_script_' + divid+']',form).val(outputs[x].scriptPubKey);
										$('input[name=utxo_amount_' + divid+']',form).val(amount);
										$('input[name=privkey_'+divid+']'      ,form).removeAttr('readonly');
									}
								}
								
								$('span#total_inputs',form).html(totalInputs);
							} else {
								alert(j.error);
							}
						} catch(e) {
							alert('Invalid Json Format.');
						}
					},
					complete:function() {
						self.val('Load');
					}
				});
				"/&gt;
			&lt;/div&gt;
		&lt;/div&gt;
	&lt;/div&gt;
	&lt;div class="row"&gt;
		&lt;div class="col-sm-6"&gt;
			
			&lt;div class="form-row"&gt;
				&lt;div class="form-group col"&gt;
					&lt;label for="no_of_inputs"&gt;Inputs: &lt;i&gt;Max 10 inputs only. Please load them from UTX above.&lt;/i&gt;&lt;/label&gt; 
					
					&lt;div class="row"&gt;
						&lt;div class="col-sm-2"&gt;
							&lt;select class="form-control" id="no_of_inputs" name='no_of_inputs' style='width:auto;' onchange="
							var self = $(this);
							var thisvalue = self.val();
							var form = self.closest('form');
							$('div[id^=row_input_]',form).hide();
							for(var i=1; i&lt;= thisvalue; i++) { 
								$('div[id=row_input_'+  i + ']',form).show();
							}
							" readonly&gt;
								&lt;?php
								$optionval = $_POST['no_of_inputs']?$_POST['no_of_inputs'] : 0;
								
								if ($optionval &gt; 0) {
								?&gt;
								&lt;option value='&lt;?php echo $optionval?&gt;'&gt;&lt;?php echo $optionval?&gt;&lt;/option&gt;
								&lt;?php
								}
								?&gt;
							&lt;/select&gt;
						&lt;/div&gt;
						
						&lt;div class="col-sm-10"&gt;
							Total Sathoshi: 
							&lt;span id='total_inputs'&gt;
							&lt;?php echo 
							array_reduce(
								array_keys($_POST),
								function($carry, $key)  { 
									if (preg_match('/^utxo_amount_/', $key)) {
										return $carry + (int)$_POST[$key];
									} else {                    
										return $carry;
									}
								}, 0
							);?&gt;
							&lt;/span&gt;
						&lt;/div&gt;
					&lt;/div&gt;
				&lt;/div&gt;
			&lt;/div&gt;
			
			&lt;?php
			$selectedNInputs = is_numeric($_POST['no_of_inputs']) ? $_POST['no_of_inputs'] : 0;
			
			foreach(range(1,$noOfInputs) as $thisInput) {
			?&gt;
			
				&lt;div class="form-row" id='row_input_&lt;?php echo $thisInput?&gt;' style="&lt;?php echo ($thisInput &gt; $selectedNInputs) ? "display:none" : "display:;"?&gt;"&gt;
					&lt;input type='hidden' name='utxo_amount_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_amount_{$thisInput}"]?&gt;'/&gt;
					
					&lt;div class="form-group  col-sm-1"&gt;
						#&lt;?php echo $thisInput?&gt; 
					&lt;/div&gt;
					&lt;div class="form-group  col-sm-3"&gt;    
						&lt;input class="form-control" title="UTXO Tx Hash" placeholder='UTXO Tx Hash' type='text' name='utxo_hash_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_hash_{$thisInput}"]?&gt;' readonly&gt;
					&lt;/div&gt;
					&lt;div class="form-group  col-sm-1"&gt;
						&lt;input class="form-control" title="UTXO N Output" placeholder='N' type='text' name='utxo_n_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_n_{$thisInput}"]?&gt;' readonly&gt;
					&lt;/div&gt;
					&lt;div class="form-group  col-sm-3"&gt;
						&lt;input class="form-control" title="UTXO ScriptPubKey" placeholder='UTXO ScriptPubKey' type='text' name='utxo_script_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["utxo_script_{$thisInput}"]?&gt;' readonly&gt;
					&lt;/div&gt;
					&lt;div class="form-group  col-sm-4"&gt;
						&lt;input class="form-control" title="Private Key Hex, for signing purpose." placeholder='Private Key Hex' type='text' name='privkey_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["privkey_{$thisInput}"]?&gt;'&gt;
					&lt;/div&gt;
					
					&lt;div class="form-group  col-sm-1" &gt;
					
					&lt;/div&gt;
					&lt;div class="form-group  col-sm-11"&gt;
						&lt;input class="form-control" placeholder='Redeem Script' type='text' name='redeemscript_&lt;?php echo $thisInput?&gt;' value='&lt;?php echo $_POST["redeemscript_{$thisInput}"]?&gt;'&gt;
					&lt;/div&gt;
				&lt;/div&gt;
			&lt;?php
			}
			?&gt;
		&lt;/div&gt;
		&lt;div class="col-sm-6"&gt;
			&lt;div class="form-row"&gt;
				&lt;div class="form-group col"&gt;
					&lt;label for="no_of_outputs"&gt;Outputs:&lt;/label&gt; &lt;select class="form-control" id="no_of_outputs" name='no_of_outputs' style='width:auto;' onchange="
					var self = $(this);
					var thisvalue = self.val();
					var form = self.closest('form');
					$('div[id^=row_output_]',form).hide();
					for(var i=1; i&lt;= thisvalue; i++) { 
						$('div[id=row_output_'+  i + ']',form).show();
					}
					"&gt;
						&lt;?php
						foreach(range(1,$noOfOutputs) as $thisOutput) {
							echo "&lt;option value='{$thisOutput}'".($thisOutput == $_POST['no_of_outputs'] ? " selected": "")."&gt;{$thisOutput}&lt;/option&gt;";
						}
						?&gt;
					&lt;/select&gt;
				&lt;/div&gt;
			&lt;/div&gt;
			&lt;?php
			$selectedNOutputs = is_numeric($_POST['no_of_outputs']) ? $_POST['no_of_outputs'] : 1;
			
			
			foreach(range(1,$noOfOutputs) as $thisOutput) {
			?&gt;
				&lt;div class="form-row" id='row_output_&lt;?php echo $thisOutput?&gt;' style="&lt;?php echo ($thisOutput &gt; $selectedNOutputs) ? "display:none" : "display:;"?&gt;"&gt;
					&lt;div class="form-group col-sm-1"&gt;
						#&lt;?php echo $thisOutput?&gt; 
					&lt;/div&gt;
					
					&lt;div class="form-group col-sm-6"&gt;
						&lt;input class="form-control" placeholder='Any Address' type='text' name='address_&lt;?php echo $thisOutput?&gt;' value='&lt;?php echo $_POST["address_{$thisOutput}"]?&gt;'&gt;
					&lt;/div&gt;
					&lt;div class="form-group col-sm-5"&gt;
						&lt;input class="form-control" placeholder='Amount' type='text' name='amount_&lt;?php echo $thisOutput?&gt;' value='&lt;?php echo $_POST["amount_{$thisOutput}"]?&gt;'&gt;
					&lt;/div&gt;
				&lt;/div&gt;
	&lt;?php
			}
	?&gt;
		&lt;/div&gt;
	&lt;/div&gt;
	
	&lt;input type='submit' class="btn btn-success btn-block"/&gt;
&lt;/form&gt;
&lt;!-- The Modal --&gt;
&lt;div class="modal" id="myModal" data-backdrop="false"&gt;
	&lt;div class="modal-dialog"&gt;
		&lt;div class="modal-content"&gt;

			&lt;!-- Modal Header --&gt;
			&lt;div class="modal-header"&gt;
				&lt;h4 class="modal-title"&gt;&lt;span id='network_display'&gt;&lt;/span&gt;: Height &amp; MTP&lt;/h4&gt;
				&lt;button type="button" class="close" data-dismiss="modal"&gt;&amp;times;&lt;/button&gt;
			&lt;/div&gt;

			&lt;!-- Modal body --&gt;
			&lt;div class="modal-body"&gt;
		
			&lt;/div&gt;
		&lt;/div&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;?php
include_once("html_iframe_footer.php");		</pre> 
	</div>
</div>
					<hr>
					<br>
					<br>
					<br>
					<br>
					<br>
					<br>
					<br>
					
					<div class="row">
						<div class="col-sm-3"><h5>Tutorials</h5></div>
						<div class="col-sm-3"><h5>About Us</h5>
							<small>Contents have been open source in <a target="_blank" href="https://github.com/atlaschiew/btcschools">GITHUB</a>. Please give me a ⭐ if you found this helpful :)</small>
						</div>
						<div class="col-sm-3"><h5>Community</h5>
							<small>Problem? Raise me a <a href="https://github.com/atlaschiew/btcschools/issues/new">new issue</a>.</small>
						</div>
						
						<div class="col-sm-3">
							<h5>Support Us</h5>
						
							<small>Buy me a coffee. so i can spend more nights for this :)</small>
							
							<div class="row">
								<div class="col-sm-6">
									<img id="footer_btc" rel="bc1qahfakg7uk77xnan2ex8a55fd3ml30n65f7vw92" src="./Bitcoin P2SH.LOCKTIME_files/bitcoin.jpg" style="width: 150px; height: 150px;">
									
									<img id="footer_eth" rel="0x114f0669d8dB5641bAfEcD1D2340c47A88d0E3f4" src="./Bitcoin P2SH.LOCKTIME_files/ethereum.jpg" style="width:150px;height:150px;display:none;">
									
									<img id="footer_lite" rel="ltc1qj32hh6ht2n6knswnnk5ar4jc9f59xkqe2npsqu" src="./Bitcoin P2SH.LOCKTIME_files/litecoin.jpg" style="width:150px;height:150px;display:none;">
								</div>
								<div class="col-sm-6">
									<select name="footer_coin" size="6" class="form-control" onchange="
									
										$(&#39;img[id^=footer_]&#39;).hide();
										var value = this.value;
										var imgElement = $(&#39;img#&#39;+ value);
										imgElement.show();
										$(&#39;small#footer_address&#39;).html(imgElement.attr(&#39;rel&#39;));
									">
										<option value="footer_btc">Bitcoin</option>
										<option value="footer_eth">Ethereum</option>
										<option value="footer_lite">Litecoin</option>
									</select>
								</div>
							</div>
							
							<small id="footer_address">bc1qahfakg7uk77xnan2ex8a55fd3ml30n65f7vw92</small>
						</div>
					</div>
					<hr>
					<div class="row">
						<div class="col-sm-12">
							<small style="color:gray;">
								BTCSCHOOLS would like to present you with more pratical but little theory throughout our tutorials. Pages' content are constantly keep reviewed to avoid mistakes, but we cannot warrant correctness of all contents. While using this site, you agree to accept our terms of use, cookie &amp; privacy policy. Copyright 2019 by BTCSCHOOLS. All Rights Reserved.
							</small>
						</div>
					</div>
				</div>
			</div>
			<!-- /#page-content-wrapper -->

		</div>
		<!-- /#wrapper -->
	
	<script src="./Bitcoin P2SH.LOCKTIME_files/bootstrap.bundle.min.js.下载"></script>
	<script src="./Bitcoin P2SH.LOCKTIME_files/enlighterjs.min.js.下载"></script><ins class="adsbygoogle adsbygoogle-noablate" data-adsbygoogle-status="done" style="display: none !important;" data-ad-status="unfilled"><div id="aswift_0_host" style="border: none; height: 0px; width: 0px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"><iframe id="aswift_0" name="aswift_0" browsingtopics="true" style="left: 0px; position: absolute; top: 0px; border: 0px; overflow: hidden;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allow="attribution-reporting; run-ad-auction" src="./Bitcoin P2SH.LOCKTIME_files/ads(3).html" data-google-container-id="a!1" tabindex="0" title="Advertisement" aria-label="Advertisement" data-load-complete="true"></iframe></div></ins>
	<!-- Menu Toggle Script -->
	<script type="text/javascript">
	$("#menu-toggle").click(function(e) {
	  e.preventDefault();
	  $("#wrapper").toggleClass("toggled");
	});
  
	// - highlight all pre + code tags (CSS3 selectors)
	// - use javascript as default language
	// - use theme "enlighter" as default theme
	// - replace tabs with 2 spaces
	EnlighterJS.init('pre', 'code', {
			language : 'php',
			theme: 'enlighter',
			indent : 4
	});
	
	
	$(document).ready(function(){		
		$('[data-toggle="tooltip"]').tooltip();
		
		$('select[name=footer_coin]').val('footer_btc').trigger('change');
		
		
	});
	
	iFrameResize({});
	
	</script>
<iframe src="./Bitcoin P2SH.LOCKTIME_files/aframe.html" width="0" height="0" style="display: none;"></iframe></body><iframe id="google_esf" name="google_esf" src="./Bitcoin P2SH.LOCKTIME_files/zrt_lookup_fy2021.html" scrolling="no" style="display: none; overflow: hidden;"></iframe></html>